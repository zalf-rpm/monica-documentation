{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"MONICA: The Model for Nitrogen and Carbon Dynamics in Agro-Ecosystems","text":""},{"location":"#introduction","title":"Introduction","text":"<p>This site is the official documentation of the MONICA model.</p> <p>MONICA is a dynamic, process-based simulation model which describes transport and bio-chemical turn-over of carbon, nitrogen and water in agro-ecosystems. On daily time steps the most important processes in soil and plant are modelled mechanistically. They are linked in such way that feed-back relations of the single processes are reproduced as close to nature as possible. MONICA works one-dimensional and represents a space of 1 m<sup>2</sup> surface area and 2 m depth.</p> <p>The acronym MONICA is derived from \u201cMOdel of NItrogen and CArbon dynamics in agro-ecosystems\u201d.</p>"},{"location":"#what-can-monica-do","title":"What can MONICA do?","text":"<p>For daily time steps, MONICA calculates all processes that interact with the bio-chemical turn-over of carbon and nitrogen in soil and with their transport in soil, air and plant. A broad range of variables being of interest for the user can be accessed day-by-day. This could be easily measurable items, such as soil moisture, carbon and nitrogen contents, the crop\u2019s biomass, or yield. These quantities are well suited to evaluate the performance of the MONICA simulations. However, MONICA also shows items that can only be quantified with great effort, such as nitrogen mineralisation from crop residues or organic fertilisers, NH<sub>3</sub>-, N<sub>2</sub>O-, and CO<sub>2</sub> emissions from soil, denitrification, potential groundwater recharge, crop evapotranspiration, or the leaching of nitrates into deeper soil layers.</p>"},{"location":"#which-processes-are-described","title":"Which processes are described?","text":"<p>MONICA describes processes in the soil\u2013plant system and the energy and matter exchange with the hydrosphere and atmosphere. Using daily weather data, it calculates the soil temperature for single discrete layers in the soil. The movement of water in the soil is modelled using a capacity approach. This approach assumes that water that cannot be stored in a soil layer will be passed on to the adjacent layer below. The layer\u2019s storage capacity and its percolation rate are governed by its texture and soil organic matter content. Evaporation and water uptake by the root influence the water budget. If groundwater is accessible, capillary water can rise into the root zone.</p> <p>Moving soil water carries nitrates. They originate from organic matter turn-over, appearing first as ammonium (ammonification) which is later turned into nitrates (nitrification). If oxygen is deficient, nitrate can be transformed into atmospheric nitrogen (denitrification), a process during which the greenhouse gas N<sub>2</sub>O is produced. The microorganisms facilitating these processes and producing CO<sub>2</sub> from their metabolism are also simulated. When organic fertilisers are applied, gaseous NH<sub>3</sub> is set free. Furthermore, also urea fertiliser hydrolyses in the soil and releases NH<sub>3</sub>.</p> <p>The crop\u2019s biomass increases according to the daily radiation and temperature. A target and a critical nitrogen concentration are calculated for the plant tissue. The first serves the calculation of nitrogen uptake from the soil, while the second is used to determine nitrogen deficiency. In the latter case, similar to drought stress, the crop\u2019s daily growth increment will be reduced. In daily time steps the root grows into depth. The calculated root biomass is distributed to the discrete soil layers accordingly. The calculation of water and nitrogen uptake by the plant considers this distribution and consumes from the respective soil layers. </p> <p>At harvest, crop residues remain. They are decomposed and contribute to soil organic matter pools, nitrogen mineralisation, and CO<sub>2</sub> release. Every organic material has its own properties which determine its decay. That way a lettuce leaf will be mineralised much faster than wheat straw. Currently, MONICA is able to simulate eight different crops.</p>"},{"location":"#monicas-crop-growth-concept","title":"MONICA\u2019s crop growth concept","text":"<p>The crop growth concept of MONICA is based on the calculation of assimilate production from radiation. In this manner, the process of photosynthesis is simplified. The efficiency of carbohydrate production is dependent on temperature. The virtual crop\u2019s development from seed to harvest maturity is determined using the accumulating temperature. For each developmental stage, the distribution of carbohydrates within the crop is continuously adjusted. In early stages root and leaf growth is promoted, while shoot and fruit growth will be increasingly supported at later stages. The distributed carbohydrates will be converted into dry matter biomass and \u2013 in the case of leaves \u2013 also in leaf area. In turn, leaf area, as the main location for photosynthesis, finds its way into the calculation of carbohydrate production.</p> <p>The amount of dry matter assigned to the root is distributed down the soil profile according to an empirical formula. The current rooting depth is depending on soil texture, but also on the crop itself. Further on, root length density limits the root\u2019s ability to take up water and nitrogen.  </p> <p>From leaf area, the degree of soil coverage is estimated, which in turn determines the fraction of transpiration from total evapotranspiration. Actual evapotranspiration is calculated relative to a cut grass crop, using crop-specific coefficients. The resulting water loss is then \u2013 a sufficient supply assumed \u2013 taken from the respective soil layers according to the root distribution. In case water supply is insufficient and falls below a specific threshold value, crop growth will be reduced. This also applies in the case of nitrogen supply from soil being insufficient for maintaining the N concentration in the crop tissue above a critical level.</p> <p>At harvest, marketable parts of the crop are removed and the remaining residues are allocated to conceptual organic matter pools in the soil. Nitrogen in the crop is then divided between marketable yield and crop residues.</p>"},{"location":"#applications","title":"Applications","text":"<p>MONICA has been applied so far in three major research projects:</p> <ul> <li>The LandCaRe 2020 project focused on the development of a knowledge platform on which stakeholders can access information on the expected impact of climate change on agriculture in Germany (BMBF Funding Focus klimazwei).</li> <li>In the CarBioCial project, three regions along a land use gradient in Southern Amazonia (Brazil) are currently analysed to derive recommendations for a carbon-neutral land management under climate change conditions in Brazil (BMBF Funding Focus Sustainable Land Management).</li> <li>Within the EVA2, project crop rotations for energy production are currently grown on different sites across Germany. MONICA is used to evaluate the impact of energy cropping on the environment, especially on groundwater recharge and nitrogen leaching (FNR).</li> </ul>"},{"location":"#technical-details","title":"Technical details","text":"<p>MONICA was programmed in C++. This makes it easier to connect with other programs that work together with MONICA and ensures high performance. Simulations covering long periods of time can therefore be run in seconds.</p> <p>MONICA\u2019s construction is modular. A central control module manages crop management actions (sowing, fertilisation, irrigation, tillage, and harvest). These actions are sorted and assigned to the respective topical modules. The control module is also responsible for providing and outputting results. The topical modules calculate soil temperature, soil water dynamics, soil matter transport, soil organic matter turn-over, and crop growth. An additional central module saves relevant state variables for the respective soil layers.</p>"},{"location":"#history","title":"History","text":""},{"location":"#the-development-of-monica","title":"The development of MONICA","text":"<p>MONICA is a successor of the HERMES model. HERMES is a pure nitrogen model. It had to be modified to also support research questions on carbon dynamics under climate change. The simple algorithm for the calculation of nitrogen mineralisation from soil organic matter was replaced by a more comprehensive one, which was taken from the Danish DAISY model. It calculates the carbon turn-over and derives nitrogen dynamics from it. This approach also considers soil microbial biomass dynamics. Furthermore, the impact of atmospheric CO<sub>2</sub> concentration on the crop\u2019s photosynthesis and transpiration was introduced.</p> <p>Using these algorithms, the increased photosynthesis and the improved water use efficiency of crops grown under elevated CO<sub>2</sub> concentrations can be simulated according to observations made from free air carbon enrichment experiments. Finally, the new model, which was given the name MONICA, was equipped with automatically triggered fertilising and irrigation routines. They enable MONICA to run in long-term scenarios without having to adjust the virtual crop\u2019s management to gradually changing conditions.</p>"},{"location":"#monicas-predecessor-the-hermes-model","title":"MONICA\u2019s predecessor: the HERMES model","text":"<p>The HERMES model (Kersebaum 1989) was the first simulation model for the year-round simulation of N dynamics in agricultural sites developed in Germany. It uses a generic, photosynthesis-driven crop model, built on the archetype SUCROS (Van Keulen et al. 1982). This enables HERMES to consider a broad range of crops. In general, the process model comprises rather simple algorithms and requires easy-to-access input data only.</p> <p>However, HERMES used some input information that was specific for Germany, such as the German soil classification system and Haude\u2019s evapotranspiration factors. For this reason, it was not much used by international colleagues. In Germany, however, HERMES was applied in many case studies, including regional applications in combination with a geo-information system. More recent releases include alternative evapotranspiration algorithms and enable a less restrictive parameterisation of the soil. This version was also applied outside Europe (Kersebaum et al. 2008). The HERMES model is considered the heart of MONICA.</p>"},{"location":"#references","title":"References","text":"<ul> <li> <p>Kersebaum, K.C. (1989): Die Simulation der Stickstoff-Dynamik von Ackerb\u00f6den. Dissertation Universit\u00e4t Hannover.</p> </li> <li> <p>Van Keulen, H., Penning de Vries, F.W.T., Drees, E.M. (1982): A summary model for crop growth. In: Penning de Vries, F.W.T. &amp; Van Laar, H.H. (Hrsg.): Simulation of plant growth and crop production. PUDOC, Wageningen, 87 - 97.</p> </li> <li> <p>Kersebaum, K.C., Wurbs, A., De Jong, R., Campbell, C.A., Yang, J., Zentner, R.P. (2008): Long term simulation of soil-crop interactions in semiarid southwestern Saskatchewan, Canada. European Journal of Agronomy 29, 1-12</p> </li> </ul>"},{"location":"#publication-how-to-cite-monica","title":"Publication &amp; How to Cite MONICA","text":""},{"location":"#official-reference","title":"Official Reference","text":"<p>Nendel, C., Berg, M., Kersebaum, K. C., Mirschel, W., Manderscheid, R., Weigel, H.-J., and Wenkel, K.-O. (2011). The MONICA model: Testing predictability for crop growth, soil moisture and nitrogen dynamics. Ecological Modelling, 222(9), 1614\u20131625. https://doi.org/10.1016/j.ecolmodel.2011.02.018</p>"},{"location":"#how-to-cite-monica","title":"How to Cite MONICA","text":"<p>When using MONICA in publications, please cite the main model description paper above. For example:</p> <p>\u201cSimulations were performed using the MONICA agro-ecosystem model (Nendel et al., 2011).\u201d</p> <p>Full reference example:</p> <p>Nendel, C., Berg, M., Kersebaum, K. C., Mirschel, W., Manderscheid, R., Weigel, H.-J., and Wenkel, K.-O. (2011). The MONICA model: Testing predictability for crop growth, soil moisture and nitrogen dynamics. Ecological Modelling, 222(9), 1614\u20131625. https://doi.org/10.1016/j.ecolmodel.2011.02.018</p>"},{"location":"#model-version-software-archive","title":"Model Version &amp; Software Archive","text":"<p>This reference applies to MONICA version 3.6.32 and later. The model source code and documentation are archived under the following DOI: (DOI added later)</p>"},{"location":"#quick-start","title":"Quick Start","text":""},{"location":"#1-download-and-extract","title":"1. Download and Extract","text":"<ul> <li>Get the latest <code>monica-windows-x86_64.zip</code> from the GitHub releases page.</li> <li>Extract it to a simple location, e.g.: <code>C:\\monica\\</code></li> <li>The folder structure should look like this:</li> </ul> <pre><code>C:\\monica\n\u251c\u2500\u2500 bin\n\u251c\u2500\u2500 monica-parameters\n\u251c\u2500\u2500 projects\n\u2514\u2500\u2500 documentation\\\n</code></pre>"},{"location":"#2-run-the-example-simulation","title":"2. Run the Example Simulation","text":"<ul> <li>Open Command Prompt and navigate to the example project directory:</li> </ul> <pre><code>C:\\monica\\projects\\Hohenfinow2-single-run\n</code></pre> <ul> <li>Run the simulation by typing:</li> </ul> <pre><code>run_monica.cmd\n</code></pre> <p>This automatically calls <code>monica-run.exe</code> from the <code>bin</code> folder and creates an output file named <code>sim-out.csv</code>.</p>"},{"location":"#3-verify-and-use","title":"3. Verify and Use","text":"<ul> <li>If <code>sim-out.csv</code> appears, MONICA is working fine.</li> <li>Users can now edit the <code>sim.json</code>, <code>crop.json</code>, <code>site.json</code>, and <code>climate.csv</code> files to run their own simulations.</li> <li>(Optional) Add <code>C:\\monica\\bin</code> to the PATH and set <code>MONICA_PARAMETERS = C:\\monica\\monica-parameters</code>  to use MONICA system-wide.</li> </ul>"},{"location":"model_science/crop_processes/assimilate_partitioning/","title":"Assimilate partitioning","text":"<p>Assimilates being produced in the photosynthesis module are distributed to the single plant organs. The partitioning coefficients are taken from a matrix which includes the development stages of the crop.</p> <p>Table 1: Matrix of assimilate partitioning for winter wheat</p> Root Leaf Shoot Fruit Permanent structures Sowing to emergence 0.5 0.5 0 0 0 Emergence to double ridge 0.2 0.2 0.6 0 0 Double ridge to begin of bloom 0.13 0.2 0.67 0 0 Bloom 0 0 0.03 0.97 0 Grain filling 0 0 0 1.0 0 Senescence 0 0 0 0 0 <p>The daily partitioning is calculated using linear regression between the elements of the matrix and the relative development:</p> \\[a_i = a_{i,j} + ((a_{i, j+1} - a_{i,j}) \\cdot DD_{rels})\\] <p>and</p> \\[DD_{rels} = \\frac{DD_{acts}}{DD_{crops}}\\] <p>\\(a_i\\) Actual assimilate partitioning coefficient for organ \\(i\\) \\(a_{i,j}\\) Partitioning coefficient at begin of stage \\(j\\) \\(a_{i,j+1}\\) Partitioning coefficient at begin of the subsequent stage \\(j+1\\) \\(DD_{rels}\\) Relative phenological development within the stage \\(DD_{acts}\\) Actual temperature sum in the developmental stage \\([^{\\circ}C \\, d]\\) \\(DD_{crops}\\) Plant-specific temperature sum in the developmental stage \\([^{\\circ}C \\, d]\\)</p> <p>The number of organs, developmental stages, as well as their names can be freely defined by the user.</p> <p>The daily increase of assimilates in the respective organ results from:</p> \\[\\frac{d}{dt}W_i = A_g \\cdot a_i \\cdot dt\\] <p>\\(W_i\\) Biomass of organ \\(i\\) \\([kg \\, TM \\, ha^{-1}]\\) \\(A_g\\) Gross CO<sub>2</sub> assimilation \\([kg \\, CO_2 \\, ha^{-1} \\, d^{-1}]\\) \\(a_i\\) Partitioning coefficient at begin of stage \\(j\\) \\(t\\) Time \\([d]\\)</p> <p>The daily mass decrease due to senescence of the single organs is calculated accordingly.</p>"},{"location":"model_science/crop_processes/drought_stress/","title":"Drought stress","text":"<p>Crop growth is limited by four different stress factors: drought, nitrogen deficiency, oxygen deficiency and heat stress.</p> <p>Drought is indicated when potential transpiration increases beyond the amount stored in the soil. The reduction factor for drought stress is calculated by the relation of actual to potential transpiration:</p> \\[\\zeta_W = \\frac{T_a}{T_p}\\] <p>\\(\\zeta_W\\) Reduction factor drought stress \\(T_a\\) Actual transpiration \\([mm]\\) \\(T_p\\) Potential transpiration \\([mm]\\)</p> <p>Drought stress in the model affects the supply of assimilates produced from photosynthesis if the reduction factor drops below a threshold value which is specific for each crop and its developmental stages.</p> \\[A_{gm} = A_g \\cdot \\zeta_w \\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,  \\zeta_w &lt; \\bar{\\zeta}_w\\] <p>\\(A_{gm}\\) Amount of assimilates \\([kg \\, CO_2 \\, ha^{-1} \\, d^{-1}]\\) \\(A_g\\) Gross CO<sub>2</sub> assimilation \\([kg \\, CO_2 \\, ha^{-1} \\, d^{-1}]\\) \\(\\zeta_w\\) Reduction factor drought stress \\(\\bar{\\zeta}_w\\) Crop- and stage-specific threshold for drought stress</p> <p>Some crops react very sensitively to drought stress during bloom. Within a defined sensitive phase, drought reduces the fertility of the ovules.</p>"},{"location":"model_science/crop_processes/drought_stress/#references","title":"References","text":"<ul> <li> <p>Challinor et al. (2005): Simulation of the impact of high temperature stress on annual crop yields. Agricultural and Forest Meteorology 135, 180 - 189.</p> </li> <li> <p>Mirschel, W. &amp; Wenkel, K.-O., 2007. Modelling soil-crop interactions with AGROSIM model family. In: K.C. Kersebaum, J.-M. Hecker, W. Mirschel and M. Wegehenkel (Editors), Modelling water and nutrient dynamics in soil crop systems. Springer, Stuttgart, pp. 59- 74.</p> </li> <li> <p>Moriondo et al. (2011): Climate change impact assessment: the role of climate extremes in crop yield simulation. Climatic Change 104 (3-4), 679-701.</p> </li> </ul>"},{"location":"model_science/crop_processes/heat_stress/","title":"Heat stress","text":"<p>Heat stress affects the production of ovules during bloom. Heat, in the sense of the model, is defined as exceeding a plant-specific threshold during the daylight period (photo period). For this period, the temperature is assumed as being:</p> \\[T_{photo} = T_{max} - \\frac{T_{max}-T_{min}}{4}\\] <p>\\(T_{photo}\\) Temperature during the photo period \\([^{\\circ}C]\\) \\(T_{max}\\) Daily maximum temperature \\([^{\\circ}C]\\) \\(T_{min}\\) Daily minimum temperature \\([^{\\circ}C]\\)</p> <p>During a defined plant-specific phase of increased sensitivity, extreme temperatures affect the crop according to Challinor et al. (2005):</p> \\[F_H = 1 - \\left( \\frac{T_{photo} - T_{critH}}{T_{limH} - T_{critH}} \\right) \\cdot r_F\\] <p>\\(F_H\\) Heat impact on ovules \\([d^{-1}]\\) \\(T_{photo}\\) Temperature during the photo period \\([^{\\circ}C]\\) \\(T_{critH}\\) Critical temperature for heat stress effect \\([^{\\circ}C]\\) \\(T_{limH}\\) Maximum temperature for heat stress effect \\([^{\\circ}C]\\) \\(r_F\\) Daily flower emergence rate \\([d^{-1}]\\)</p> <p>The daily flower emergence rate during bloom is calculated following an idea of Moriondo et al. (2011):</p> \\[r_F = p_{F,d} - p_{F, d-1}\\] <p>\\(r_F\\) Daily flower emergence rate \\([d^{-1}]\\) \\(p_{F, d}\\) Fraction of today opened flowers \\(p_{F, d-1}\\) Fraction of yesterday opened flowers</p> <p>where</p> \\[p_F =  \\frac{1} { 1 + (\\frac{1}{0.015} - 1) \\cdot e^{-1.4 \\cdot D_{BF}} }\\] <p>\\(p_F\\) Fraction of open flowers \\(D_{BF}\\) Days after begin of bloom \\([d]\\)</p> <p>The reduction factor is derived from the smallest value of \\(F_H\\) during the sensitive phase:</p> \\[\\zeta_H = min(F_{H1},\\, ... \\,,F_{Hn} )\\] <p>\\(\\zeta_H\\) Reduction factor heat stress \\(F_{H1}\\) Heat impact at the first day of the sensitive phase \\([d^{-1}]\\) \\(F_{Hn}\\) Heat impact at the last day of the sensitive phase \\([d^{-1}]\\)</p> <p>Heat stress reduces the assimilate flow to the storage organ:</p> \\[W_s = A_g \\cdot a_s \\cdot \\zeta_H\\] <p>\\(W_s\\) Biomass of the storage organ \\([kg \\, TM \\, ha^{-1}]\\) \\(A_g\\) Gross CO<sub>2</sub> assimilation \\([kg \\, CO_2 \\, ha^{-1} \\, d^{-1}]\\) \\(a_s\\) Assimilate partitioning coefficient for the storage organ \\(\\zeta_H\\) Reduction factor heat stress </p>"},{"location":"model_science/crop_processes/heat_stress/#references","title":"References","text":"<ul> <li> <p>Challinor et al. (2005): Simulation of the impact of high temperature stress on annual crop yields. Agricultural and Forest Meteorology 135, 180 - 189.</p> </li> <li> <p>Mirschel, W. &amp; Wenkel, K.-O., 2007. Modelling soil-crop interactions with AGROSIM model family. In: K.C. Kersebaum, J.-M. Hecker, W. Mirschel and M. Wegehenkel (Editors), Modelling water and nutrient dynamics in soil crop systems. Springer, Stuttgart, pp. 59- 74.</p> </li> <li> <p>Moriondo et al. (2011): Climate change impact assessment: the role of climate extremes in crop yield simulation. Climatic Change 104 (3-4), 679-701.</p> </li> </ul>"},{"location":"model_science/crop_processes/leaf_area_and_ground_coverage/","title":"Leaf area and ground coverage","text":"<p>The daily change in the crop\u2019s leaf area index is calculated in MONICA as follows:</p> \\[\\frac{d}{dt} LAI = \\frac{d}{dt} W_{L+} \\cdot \\left( \\Phi_{L_s} + \\frac{DD_{ads}}{DD_{crops}}  \\cdot (\\Phi_{L_e} - \\Phi_{L_s}) \\cdot dt \\right)  -\\frac{d}{dt}W_{L-} \\cdot \\Phi_{L_0} \\cdot dt\\] <p>\\(LAI\\) Leaf area index \\([m^2 \\, m^{-2}]\\) \\(W_{L+}\\) Leaf biomass increment \\([kg \\, TM \\, m^{-2} \\, d^{-1}]\\) \\(W_{L-}\\) Leaf biomass decrement \\([kg \\, TM \\, m^{-2} \\, d^{-1}]\\) \\(\\Phi_{L_s}\\) Specific leaf area at begin of stage \\([m^{2} \\, kg \\, TM^{-1}]\\) \\(\\Phi_{L_e}\\) Specific leaf area at end of stage \\([m^{2} \\, kg \\, TM^{-1}]\\) \\(\\Phi_{L_0}\\) Initial specific leaf area \\([m^{2} \\, kg \\, TM^{-1}]\\) \\(DD_{acts}\\) Actual temperature sum of developmental stage \\([^{\\circ}C \\, d]\\) \\(DD_{crops}\\) Plant-specific temperature sum in developmental stage \\([^{\\circ}C \\, d]\\) \\(t\\) Time \\([d]\\)</p> <p>Subsequently, the ground coverage is calculated from leaf area index:</p> <p>\\(\\beta = 1 - e^{-0.5 \\cdot LAI}\\)</p> <p>\\(\\beta\\) Degree of ground coverage \\([m^{2} \\, m^{-2}]\\) \\(LAI\\) Leaf area index</p>"},{"location":"model_science/crop_processes/n_concentration/","title":"N concentration","text":"<p>To determine the effect of insufficient N supply to the crop, the concept of critical N concentration is applied.</p> \\[N_{crit} = a \\cdot (1.0 + b \\cdot e^{-0.26 \\cdot W})\\] <p>\\(N_{crit}\\) Critical N concentration in the plant tissue \\([kg \\, N \\, kg DM^{-1}]\\) \\(W\\) Above-ground dry matter biomass \\([t]\\) \\(a, b\\) Crop-specific parameters</p> <p>The concept was developed by Greenwood (1990). The optimum N concentration is obtained by multiplying the critical N concentration with a luxury-N supply factor, which is taken from the EU-Rotate_N model (Rahn et al., 2010).</p> \\[N_{target} = N_{crit} \\cdot k_{lux}\\] <p>\\(N_{target}\\) Optimum N concentration in the plant tissue \\([kg \\, N \\, kg DM^{-1}]\\) \\(N_{crit}\\) Critical N concentration in the plant tissue \\([kg \\, N \\, kg DM^{-1}]\\) \\(k_{lux}\\) Luxury-N supply factor </p> <p>The N concentration in the plant tissue is calculated for every daily time step. The difference between the actual and the newly calculated optimum N concentration is acquired for uptake from the soil. Soil N supply is calculated under consideration of root architecture and transport parameters (N uptake). In case the supply from soil is sufficient, the difference will be replaced in the crop. Otherwise, the N concentration in the plant tissue will drop. Once it falls below the critical N concentration, photosynthesis is reduced.</p>"},{"location":"model_science/crop_processes/n_concentration/#references","title":"References","text":"<ul> <li> <p>Greenwood, D.J. et al. (1990): Weather, nitrogen supply and growth rate of field vegetables. Plant Soil 124 (2), 297-301.</p> </li> <li> <p>Rahn, C.R. et al. (2010): EU-Rotate_N - a European decision support system - to predict environmental and economic consequences of the management of nitrogen fertiliser in crop rotations. European Journal of Horticultural Science 75 (1), 20-32</p> </li> </ul>"},{"location":"model_science/crop_processes/n_uptake/","title":"N uptake","text":"<p>The N uptake of the crop from soil is modelled following an idea of Kersebaum (1989). The crop\u2019s daily N requirement is calculated using:</p> \\[N_{pot} = \\left( N_{target} \\cdot W + N_{max \\, root} \\cdot W_{root} + N_{target} \\cdot \\frac{W_b}{p_N} - N_{crop}^{*} \\right) \\cdot \\Delta t\\] <p>\\(N_{pot}\\) Daily N uptake potential \\([kg \\, N \\, ha^{-1}]\\) \\(N_{target}\\) Maximum N concentration in above-ground plant parts \\([kg \\, N \\,kg \\, TM^{-1}]\\) \\(W\\) Above-ground dry matter biomass \\([kg \\, N \\, ha^{-1}]\\) \\(N_{max \\, root}\\) Maximum N concentration in the root \\([kg \\, N \\,kg \\, TM^{-1}]\\) \\(W_{root}\\) Root dry matter biomass \\([kg \\, N \\, ha^{-1}]\\) \\(W_b\\) Below-ground dry matter biomass (not root) \\([kg \\, N \\, ha^{-1}]\\) \\(p_N\\) N distribution coefficient \\(N_{crop}^{*}\\) Total crop N content in the past time step \\([kg \\, N \\, ha^{-1}]\\) \\(\\Delta t\\) Time step \\([d]\\)</p> <p>Its maximum amount is \\(6 \\, kg \\, N \\, ha^{-1} \\, d^{-1}\\). The daily N uptake is determined by the root length and a threshold which decreases linearly with the plant\u2019s ontogenesis and thus considers the decreasing fraction of active root surface as compared to transport roots.</p> \\[\\Delta N_{lim} = L_{root} \\cdot \\left( N_{up \\, max} - \\frac{DD_{act}}{DD_{crop}} \\right)\\] <p>\\(\\Delta N_{lim}\\) Limit of the daily N uptake \\([kg \\, N \\, m^{-2}]\\) \\(L_{root}\\) Total root length \\([m \\, m^{-2}]\\) \\(N_{up \\, max}\\) Plant-specific maximum N uptake \\([kg \\, N \\, m \\, Wurzel^{-1}]\\) \\(DD_{act}\\) Actual temperature sum \\([^{\\circ}C \\, d]\\) \\(DD_{crop}\\) Plant-specific total temperature sum \\([^{\\circ}C \\, d]\\)</p> <p>It is assumed that N is taken up solely in the form of nitrate. In this form it is convectively transported in the upward stream of transpiration water.</p> \\[N_{konv \\, max} = \\sum_{z=1}^{Q \\cdot R_z} T_z \\cdot c_z \\cdot \\Delta z \\cdot \\Delta t\\] <p>\\(N_{konv \\, max}\\) Maximum convective N uptake \\([kg \\, N \\, m^{-2}]\\) \\(R_z\\) Rooting depth \\([m]\\) \\(q\\) Ratio absolute to simulated rooting depth \\(T_z\\) Transpiration \\([mm]\\) \\(c_z\\) N concentration in the soil solution \\([kg \\, N \\, m^{-3}]\\) \\(\\Delta z\\) Layer depth \\([m]\\) \\(\\Delta t\\) Time step \\([d]\\)</p> <p>In case the convective supply exceeds the crop\u2019s uptake potential, N uptake will be calculated in the single layers as:</p> \\[N_{konv_z} = T_z \\cdot c_z \\cdot \\frac{N_{pot}}{N_{mas}} \\cdot \\Delta z \\cdot \\Delta t\\] <p>\\(N_{konv_z}\\) Daily convective N uptake from the soil layer \\(z\\) \\([kg \\, N \\, m^{-2}]\\) \\(T_z\\) Transpiration from layer \\(z\\) \\([mm]\\) \\(c_z\\) N concentration in the soil solution \\([kg \\, N \\, m^{-3}]\\) \\(N_{pot}\\) Daily N uptake potential \\([kg \\, N \\, ha^{-1}]\\) \\(N_{mas}\\) Limit of the daily N uptake \\([kg \\, N \\, m^{-2}]\\) \\(\\Delta z\\) Layer depth \\([m]\\) \\(\\Delta t\\) Time step \\([d]\\)</p> <p>In case the convective N supply does not satisfy the uptake potential, an additional supply via diffusion will be considered (Baldwin et al., 1973) whose maximum contribution is calculated as follows:</p> \\[N_{diff \\, max} = \\sum_{z=1}^{q \\cdot R_z} N_{diff \\, max_z} = \\sum_{z=1}^{q \\cdot R_z} 2 \\cdot \\pi \\cdot r_w \\cdot \\Lambda_z \\cdot D \\cdot \\frac{c_z - c_{min}} {r_z} \\cdot \\Delta z \\cdot  \\Delta t\\] <p>\\(N_{diff \\, max}\\) Maximum diffusive N uptake \\([kg \\, N \\, m^{-2}]\\) \\(R_z\\) Rooting depth \\([m]\\) \\(q\\) Ratio absolute to simulated rooting depth \\(N_{diff \\, max_z}\\) Maximum diffusive N uptake from soil layer \\(z\\) \\([kg \\, N \\, m^{-2}]\\) \\(r_w\\) Root radius \\([m]\\) \\(\\Lambda_z\\) Root length density in layer \\(z\\) \\([m \\, m^{-3}]\\) \\(D\\) Effective dispersion coefficient \\([m^2 \\, d^{-1}]\\) \\(c_z\\) N concentration in the soil solution \\([kg \\, N \\, m^{-3}]\\) \\(c_{min}\\) Minimum N concentration at the root surface (1.4\u00b710\u20136) \\([kg \\, N \\, m^{-3}]\\) \\(r_z\\) Half distance between roots \\([m]\\) \\(\\Delta z\\) Layer depth \\([m]\\) \\(\\Delta t\\) Time step \\([d]\\)</p> <p>using half the distance between neighbouring roots, for which an equal distribution is assumed:</p> \\[r_z = (\\pi \\cdot \\Lambda_z)^{-0.5}\\] <p>\\(r_z\\) Half distance between roots \\([m]\\) \\(\\Lambda_z\\) Root length density in layer \\(z\\) \\([m \\, m^{-3}]\\)</p> <p>and the effective dispersion coefficient:</p> \\[D= \\frac{1}{\\tau} \\cdot D_0 + D_v \\cdot \\vert \\frac{q}{\\theta}\\vert\\] <p>\\(D\\) Effective dispersion coefficient \\([m^2 \\, d^{-1}]\\) \\(\\tau\\) Tortuosity \\(D_0\\) Diffusion coefficient in solution (2.14\u00b710\u20135) \\([m^2 \\, d^{-1}]\\) \\(d_v\\) Dispersion factor (0.05) \\([m]\\) \\(q\\) Water flux density \\([m^2 \\, d^{-1}]\\) \\(\\theta\\) Volumetric water content \\([m^3 \\, m^{-3}]\\)</p> <p>where</p> \\[\\tau = \\frac {\\theta}{a \\cdot e^{b \\cdot \\theta}}\\] <p>\\(\\tau\\) Tortuosity  \\(\\theta\\) Volumetric water content \\([m^3 \\, m^{-3}]\\) \\(a, b\\) Factors </p> <p>In case the additional diffusive supply exceeds the crop\u2019s uptake potential, it will be distributed over the soil layers, only limited by the uptake potential.</p> \\[ N_{diff_z} = (N_{pot} - N_{konv \\, max}) \\cdot \\frac{N_{diff \\, max_z}}{N_{diff \\, max}}\\] <p>\\(N_{diff_z}\\) Daily diffusive N uptake from the soil layer \\(z\\) \\([kg \\, N \\, m^{-2}]\\) \\(N_{pot}\\) Daily N uptake potential \\([kg \\, N \\, m^{-2}]\\) \\(N_{konv \\, max}\\) Maximum convective N uptake \\([kg \\, N \\, m^{-2}]\\) \\(N_{diff \\, max_z}\\) Maximum diffusive N uptake from soil layer \\(z\\) \\([kg \\, N \\, m^{-2}]\\) \\(N_{diff \\, max}\\) Maximum diffusive N uptake \\([kg \\, N \\, m^{-2}]\\)</p> <p>The daily N uptake is finally calculated from:</p> \\[N_{up_z} = N_{konv_z} + N_{diff_z} \\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\, N_{up_z} \\leq N_z - N_{min\\,av}\\] <p>\\(N_{up_z}\\) Daily N uptake from soil layer \\(z\\) \\([kg \\, N \\, m^{-2}]\\) \\(N_{konv_z}\\) Daily convective N uptake from soil layer \\(z\\) \\([kg \\, N \\, m^{-2}]\\) \\(N_{diff_z}\\) Daily diffusive N uptake from soil layer \\(z\\) \\([kg \\, N \\, m^{-2}]\\) \\(N_z\\) N content of the soil layer \\(z\\) \\([kg \\, N \\, m^{-2}]\\) \\(N_{min\\,av}\\) Minimum N content in the soil layer \\(z\\) \\([kg \\, N \\, m^{-2}]\\)</p> <p>and</p> \\[N_{up} = \\sum_{z=1}^{q \\cdot R_z} N_{up_z}\\] <p>\\(N_{up}\\) Daily N uptake \\([kg \\, N \\, m^{-2}]\\) \\(R_z\\) Rooting depth \\([m]\\) \\(q\\) Ratio of absolute to simulated rooting depth \\(N_{up_z}\\) Daily N uptake from soil layer \\(z\\) \\([kg \\, N \\, m^{-2}]\\)</p>"},{"location":"model_science/crop_processes/n_uptake/#references","title":"References","text":"<ul> <li> <p>Baldwin, J.P. et al. (1973): Uptake of solutes by multiple root systems from soil. III. A model for calculating the solute uptake by a randomly dispersed root system developing in a finite volume of soil. Plant Soil 38, 621 \u2013 635.</p> </li> <li> <p>Groot, J.J.R. (1987): Simulation of nitrogen balance in a system of winter wheat and soil. Simulation Report CABO-TT 13. Centre for agrobiological research and Department of Theoretical Production Ecology, Landwirtschaftliche Universit\u00e4t Wageningen, Niederlande.</p> </li> <li> <p>Kersebaum, K.C. (1989): Die Simulation der Stickstoff-Dynamik von Ackerb\u00f6den. Dissertation, Universit\u00e4t Hannover, p. 143.</p> </li> </ul>"},{"location":"model_science/crop_processes/nitrogen_deficiency/","title":"Nitrogen deficiency","text":"<p>Nitrogen deficiency is indicated as soon as the crop\u2019s tissue N concentration falls below the critical N concentration. The respective reduction factor results from:</p> \\[\\zeta_N = 1-e^{N_m - \\left( 5\\cdot \\frac{N_{act} - N_m} {N_{crit} - N_m}  \\right)}\\] <p>\\(\\zeta_N\\) Reduction factor N stress \\(N_m\\) Minimum N concentration in the plant tissue \\([kg \\, N \\, kg \\, TM^{-1}]\\) \\(N_{act}\\) Actual N concentration in the plant tissue \\([kg \\, N \\, kg \\, TM^{-1}]\\) \\(N_{crit}\\) Critical N concentration in the plant tissue \\([kg \\, N \\, kg \\, TM^{-1}]\\)</p> <p></p> <p>Figure 1: Reduction function for N stress in relation to the actual N concentration of the above-ground biomass. \\(N_{crit}\\) = critical N concentration.</p> <p>In the case of stress due to drought or nitrogen deficiency, acceleration of ontogenesis is assumed for some developmental stages.</p>"},{"location":"model_science/crop_processes/nitrogen_deficiency/#references","title":"References","text":"<ul> <li> <p>Challinor et al. (2005): Simulation of the impact of high temperature stress on annual crop yields. Agricultural and Forest Meteorology 135, 180 - 189.</p> </li> <li> <p>Mirschel, W. &amp; Wenkel, K.-O., 2007. Modelling soil-crop interactions with AGROSIM model family. In: K.C. Kersebaum, J.-M. Hecker, W. Mirschel and M. Wegehenkel (Editors), Modelling water and nutrient dynamics in soil crop systems. Springer, Stuttgart, pp. 59- 74.</p> </li> <li> <p>Moriondo et al. (2011): Climate change impact assessment: the role of climate extremes in crop yield simulation. Climatic Change 104 (3-4), 679-701.</p> </li> </ul>"},{"location":"model_science/crop_processes/ontogenesis/","title":"Ontogenesis","text":"<p>The plant development is simulated using the principle of heat summation. The effective temperature is limited by a minimum temperature, which is referred to as base temperature. Suitable soil moisture is required for the emergence of the seeds, which is at least 30% of the available water. Ponding at the soil surface would hinder seed emergence. If soil moisture is ideal, the topsoil layer\u2019s temperature will be used for heat summation.</p> \\[DD_{0, t} = DD_{0,t-1} + (T_{S10} - T_{B0}) \\cdot \\Delta t\\] <p>\\(DD_{0, t}\\) Actual temperature sum in developmental stage 0 \\([^{\\circ} C \\, d]\\) \\(DD_{0, t-1}\\) Yesterday\u2019s temperature sum in developmental stage 0 \\([^{\\circ} C \\, d]\\) \\(T_{S10}\\) Soil temperature in 0\u201310 cm depth \\([^{\\circ} C]\\) \\(T_{B0}\\) Base temperature developmental stage 0 \\([^{\\circ} C]\\) \\(\\Delta t\\) Time step \\([d]\\)</p> <p>As soon as the crop-specific temperature sum for seed emergence is reached, the following developmental stage is initiated. From this time on the daily mean temperature will be summed up. Stress factors drought and N deficiency accelerate the summation, while vernalisation and day length factors decelerate it:</p> \\[DD_{n,t} =  DD_{n,t-1} + (T_{av} - T_{Bn}) \\cdot b_s \\cdot b_v \\cdot b_D \\cdot \\Delta t\\] <p>\\(DD_{n,t}\\) Actual temperature sum in developmental stage \\(n\\) \\([^{\\circ} C \\, d]\\) \\(DD_{n,t-1}\\) Yesterday\u2019s temperature sum in developmental stage \\(n\\) \\([^{\\circ} C \\, d]\\) \\(T_{av}\\) Daily mean air temperature in 2 m height \\([^{\\circ} C]\\) \\(T_{Bn}\\) Base temperature developmental stage n \\([^{\\circ} C]\\) \\(b_s\\) Acceleration factor environmental stress \\(b_v\\) Vernalisation factor \\(b_D\\) Day length factor \\(\\Delta t\\) Time step \\([d]\\)</p> <p>where</p> \\[b_s = max( 1 + ( 1 - \\zeta_W)^2, 1 + (1-\\zeta_N)^2  )\\] <p>\\(b_s\\) Acceleration factor environmental stress \\(\\zeta_w\\) Stress factor drought \\(\\zeta_N\\) Stress factor N deficiency</p> <p>Satisfaction of the crop\u2019s vernalisation requirement is considered as follows:</p> \\[b_V = \\begin{cases}  \\frac{(d_V - d_{VT})}{(d_{VR} - d_{VT})} &amp; d_{VT} \\geq 1 \\\\ 1 &amp; d_{VT}&lt;1  \\end{cases}\\] <p></p> <p>Figure 1: Effective vernalisation in relation to the daily mean air temperature.</p> <p>\\(b_V\\) Vernalisation factor \\(d_V\\) Current number of vernalisation days \\([d]\\) \\(d_{VT}\\) Vernalisation threshold \\([^{\\circ} C \\, d]\\) \\(d_{VR}\\) Crop-specific vernalisation requirement \\([^{\\circ} C \\, d]\\)</p> <p>where</p> \\[d_V = d_{V-1} + b_{V_{eff}} \\cdot \\Delta t\\] <p>\\(d_V\\) Current number of vernalisation days \\([d]\\) \\(d_{V-1}\\) Number of vernalisation days until yesterday \\([d]\\) \\(b_{V_{eff}}\\) Effective vernalisation \\(\\Delta t\\) Time step \\([d]\\)</p> <p>and</p> \\[d_{VT} = min( d_{VR}, 9 ) - 1\\] <p>\\(d_{VT}\\) Vernalisation threshold \\([^{\\circ} C \\, d]\\) \\(d_{VR}\\) Crop-specific vernalisation requirement \\([^{\\circ} C \\, d]\\)</p> <p>The vernalisation factor is always positive.</p> <p>Day length is considered in relation to a crop-specific base day length and to the crop\u2019s day length requirement:</p> \\[b_D = \\frac{N_{photo} - N_{basis}}{N_{req} - N_{basis}}\\] <p>\\(b_D\\) Day length factor \\(N_{photo}\\) Photoperiodic day length \\([h]\\) \\(N_{basis}\\) Crop-specific base day length \\([h]\\) \\(N_{req}\\) Crop-specific day length requirement \\([h]\\)</p>"},{"location":"model_science/crop_processes/overview/","title":"Crop Processes","text":"<p>The crop growth concept of MONICA is based on the calculation of assimilate production from radiation. In this manner, the process of photosynthesis is simplified. The efficiency of carbohydrate production is dependent on temperature. The virtual crop\u2019s development from seed to harvest maturity is determined using the accumulating temperature. For each developmental stage, the distribution of carbohydrates within the crop is continuously adjusted. In early stages, root and leaf growth are promoted, while shoot and fruit growth will be increasingly supported at later stages. The distributed carbohydrates will be converted into dry matter biomass and\u2014in the case of leaves\u2014also in leaf area. In turn, leaf area, as the main location for photosynthesis, finds its way into the calculation of carbohydrate production.</p> <p>The amount of dry matter assigned to the root is distributed down the soil profile according to an empirical formula. The current rooting depth is depending on soil texture, but also on the crop itself. Further on, root length density limits the root\u2019s ability to take up water and nitrogen.  </p> <p>From leaf area, the degree of soil coverage is estimated, which in turn determines the fraction of transpiration from total evapotranspiration. Actual evapotranspiration is calculated relative to a cut grass crop, using crop-specific coefficients. The resulting water loss is then\u2014a sufficient supply assumed\u2014taken from the respective soil layers according to the root distribution. In case water supply is insufficient and falls below a specific threshold value, crop growth will be reduced. This also applies in the case of nitrogen supply from soil being insufficient for maintaining the N concentration in the crop tissue above a critical level.</p> <p>At harvest, marketable parts of the crop are removed, and the remaining residues are allocated to conceptual organic matter pools in the soil. Nitrogen in the crop is then divided between marketable yield and crop residues.</p>"},{"location":"model_science/crop_processes/oxygen_deficiency/","title":"Oxygen deficiency","text":"<p>Oxygen deficiency in the rooted soil volume is determined by the ratio of the actual and the critical air content in the soil. It is assumed that decreasing oxygen concentration in the remaining air volume leads to maximum deficiency effects after four days.</p> \\[\\zeta_O = 1- \\left( \\frac{t_{anox}} {4} \\right)  \\cdot (1 - \\zeta_{O_{max}})\\] <p>\\(\\zeta_O\\) Reduction factor oxygen stress  \\(t_{anox}\\) Time under oxygen deficiency (max = 4) \\([d]\\) \\(\\zeta_{O_{max}}\\) Maximum oxygen deficit </p> <p>where</p> \\[\\zeta_{O_{max}} = \\left( \\frac{\\varepsilon}{\\varepsilon_{crit}} \\right)    \\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\,\\, \\varepsilon &lt; \\varepsilon_{crit}\\] <p>\\(\\zeta_{O_{max}}\\) Maximum oxygen deficit  \\(\\varepsilon\\) Air volume in the soil \\([m^3 m^{-3}]\\) \\(\\varepsilon_{crit}\\) Plant-specific critical soil oxygen content \\([m^3 m^{-3}]\\)</p> <p>Oxygen stress reduces root water uptake.</p>"},{"location":"model_science/crop_processes/oxygen_deficiency/#references","title":"References","text":"<ul> <li> <p>Challinor et al. (2005): Simulation of the impact of high temperature stress on annual crop yields. Agricultural and Forest Meteorology 135, 180 - 189.</p> </li> <li> <p>Mirschel, W. &amp; Wenkel, K.-O., 2007. Modelling soil-crop interactions with AGROSIM model family. In: K.C. Kersebaum, J.-M. Hecker, W. Mirschel and M. Wegehenkel (Editors), Modelling water and nutrient dynamics in soil crop systems. Springer, Stuttgart, pp. 59- 74.</p> </li> <li> <p>Moriondo et al. (2011): Climate change impact assessment: the role of climate extremes in crop yield simulation. Climatic Change 104 (3-4), 679-701.</p> </li> </ul>"},{"location":"model_science/crop_processes/photosynthesis/","title":"Photosynthesis","text":"<p>Modelling of crop growth follows a generic approach used with the SUCROS model (van Keulen et al., 1982). Daily net dry matter production by photosynthesis and respiration is driven by radiation and temperature. Gross CO<sub>2</sub> assimilation is calculated by estimating the sky cover duration:</p> \\[A_g = O_r \\cdot A_0 + (1-O_r) \\cdot A_c\\] <p>\\(A_g\\) Gross CO<sub>2</sub> assimilation rate \\([kg\\ , CO_2 \\, ha^{-1} \\, h^{-1}]\\) \\(O_r\\) Relative sky cover duration \\([d \\, d^{-1}]\\) \\(A_0\\) CO<sub>2</sub> assimilation under clouded sky \\([kg\\ , CO_2 \\, ha^{-1} \\, h^{-1}]\\) \\(A_c\\) CO<sub>2</sub> assimilation under clear sky \\([kg\\ , CO_2 \\, ha^{-1} \\, h^{-1}]\\)</p> <p>where</p> \\[O_r = \\frac{R_c - (0.5 \\cdot R_s \\cdot 10^9)} {0.8 \\cdot R_c}\\] <p>\\(O_r\\) Relative sky cover duration \\([d \\, d^{-1}]\\) \\(R_s\\) Global radiation \\([MJ \\, m^2 \\, d^{-1}]\\) \\(R_c\\) Irradiation under clear sky \\([J \\, m^2]\\)</p> <p>Gross CO<sub>2</sub> assimilation includes assimilation under clouded and under clear sky conditions:</p> \\[A_c = \\begin{cases}  PHCL &amp; LAI &lt; 5  \\\\ PHCH &amp; LAI \\geq 5 \\end{cases}\\] \\[A_O = \\begin{cases}  PHOL &amp; LAI &lt; 5 \\\\ PHOH &amp; LAI \\geq 5 \\end{cases}\\] <p>\\(A_O\\) CO<sub>2</sub> assimilation under clouded sky \\([kg \\, CO_2 \\, ha^{-1} \\, h^{-1}]\\) \\(A_C\\) CO<sub>2</sub> assimilation under clear sky \\([kg \\, CO_2 \\, ha^{-1} \\, h^{-1}]\\) \\(LAI\\) Leaf area index \\([m^2 \\, m^{-2}]\\)</p> <p>The following auxiliary algorithms were used:</p> \\[PHCL = \\begin{cases} PHC3 \\cdot \\left(  1-e^{\\frac{PHC4}{PHC3}}  \\right) &amp; PHC3 &lt; PHC4 \\\\ PHC4 \\cdot \\left(  1-e^{\\frac{PHC3}{PHC4}}\\right) &amp; PHC3 \\geq PHC4 \\end{cases}\\] \\[PHCH = 0.95 \\cdot (PHCH1 + PHCH2) + 20.5\\] \\[PHOL = \\begin{cases} PHO3 \\cdot \\left(  1-e^{\\frac{PHC4}{PHO3}}  \\right) &amp; PHO3 &lt; PHC4 \\\\ PHC4 \\cdot \\left(  1-e^{\\frac{PHO3}{PHC4}}\\right) &amp; PHO3 \\geq PHC4 \\end{cases}\\] \\[PHOH = 0.9935 \\cdot PHOH1 + 1.1\\] <p>where</p> \\[PHC3 = PHCH \\cdot (1-e^{-0.8 \\cdot LAI})\\] \\[PHC4 = N_{atmo} \\cdot LAI \\cdot A\\] <p>\\(N_{atmo}\\) Atmospheric day length \\([h]\\) \\(LAI\\) Leaf area index \\([m^2 \\, m^{-2}]\\) \\(A\\) CO<sub>2</sub> assimilation rate \\([kg \\, CO_2 \\, ha^{-1} \\, h^{1}]\\)</p> \\[PHO3 = PHOH \\cdot (1-e{-0.8 \\cdot LAI})\\] \\[PHCH1 = h_p \\cdot A \\cdot N_{eff} \\cdot \\frac{X}{1+X}\\] <p>\\(LAI\\) Leaf area index \\([m^2 \\, m^{-2}]\\) \\(h_p\\) Sun\u2019s culmination (vertical projection) \\([^{\\circ}]\\) \\(A\\) CO<sub>2</sub> assimilation rate \\([kg \\, CO_2 \\, ha^{-1} \\, h^{1}]\\) \\(N_{eff}\\) Effective day length \\([h]\\)</p> \\[X = log \\left( \\frac{1+0.45 \\cdot R_c} {N_{eff} \\cdot 3600} \\right)  \\cdot \\frac{\\varepsilon_N}{h_p \\cdot A}\\] <p>\\(R_c\\) Irradiation under clear sky \\([J \\, m^{-2}]\\) \\(\\varepsilon_N\\) Net radiation use efficiency of CO<sub>2</sub> assimilation \\([kg \\, CO_2 \\, ha^{-1} \\, h^{1}]\\) \\(N_{eff}\\) Effective day length \\([h]\\) \\(h_p\\) Sun\u2019s culmination (vertical projection) \\([^{\\circ}]\\) \\(A\\) CO<sub>2</sub> assimilation rate \\([kg \\, CO_2 \\, ha^{-1} \\, h^{1}]\\)</p> \\[PHCH_2 = (5-h_p) \\cdot A \\cdot N_{eff} \\cdot \\frac{Y}{1+Y}\\] <p>\\(h_p\\) Sun\u2019s culmination (vertical projection) \\([^{\\circ}]\\) \\(A\\) CO<sub>2</sub> assimilation rate \\([kg \\, CO_2 \\, ha^{-1} \\, h^{-1}]\\) \\(N_{eff}\\) Effective day length \\([h]\\)</p> \\[Y=log \\left(  \\frac{1+0.55 \\cdot R_c}{N_{eff} \\cdot 3600} \\right) \\cdot \\frac{\\varepsilon_N}{(5-h_p) \\cdot A}\\] <p>\\(A\\) CO<sub>2</sub> assimilation rate \\([kg \\, CO_2 \\, ha^{-1} \\, h^{-1}]\\) \\(\\varepsilon_N\\) Net radiation use efficiency of CO<sub>2</sub> assimilation \\([kg \\, CO_2 \\, J^{-1} \\, ha^{-1} \\, h^{-1}]\\) \\(R_c\\) Irradiation under clear sky \\([J \\, m^{-2}]\\) \\(h_p\\) Sun\u2019s culmination (vertical projection) \\([^{\\circ}]\\)</p> \\[PHOH1 = 5 \\cdot A \\cdot \\varepsilon_N \\cdot \\frac{Z}{1+Z}\\] <p>\\(A\\) CO<sub>2</sub> assimilation rate \\([kg \\, CO_2 \\, ha^{-1} \\, h^{-1}]\\) \\(\\varepsilon_N\\) Net radiation use efficiency of CO<sub>2</sub> assimilation \\([kg \\, CO_2 \\, J^{-1} \\, ha^{-1} \\, h^{-1}]\\)</p> \\[Z = \\frac{R_0}{N_{eff} \\cdot 3600} \\cdot \\frac{\\varepsilon_N}{5\\cdot A}\\] <p>\\(Z\\) \\(N_{eff}\\) Effective day length \\([h]\\) \\(\\varepsilon_N\\) Net radiation use efficiency of CO<sub>2</sub> assimilation \\([kg \\, CO_2 \\, J^{-1} \\, ha^{-1} \\, h^{-1}]\\) \\(A\\) CO<sub>2</sub> assimilation rate \\([kg \\, CO_2 \\, J^{-1} \\, ha^{-1} \\, h^{-1}]\\)</p> \\[h_p = \\sin(90 + \\delta + \\varphi) \\cdot \\left( \\frac{\\pi}{180}\\right)\\] <p>\\(h_p\\) Sun\u2019s culmination (vertical projection) \\([rad]\\) \\(\\delta\\) Solar declination \\([^{\\circ}]\\) \\(\\varphi\\) Latitude \\([^{\\circ}]\\)</p> \\[\\varepsilon_N = (1-\\alpha_c) \\cdot \\varepsilon_L\\] <p>\\(\\varepsilon_N\\) Net radiation use efficiency of CO<sub>2</sub> assimilation \\([kg \\, CO_2 \\, J^{-1} \\, ha^{-1} \\, h^{-1}]\\) \\(\\alpha_c\\) Crop albedo \\(\\varepsilon_L\\) Radiation use efficiency of CO<sub>2</sub> assimilation \\([kg \\, CO_2 \\, J^{-1} \\, ha^{-1} \\, h^{-1}]\\)</p> \\[N_{atmo} = 12 \\cdot \\frac{ \\left( \\pi + 2 \\cdot \\arcsin \\left( \\frac{\\delta_{sin}}{\\delta{cos}} \\right) \\right)}{\\pi}\\] <p>\\(N_{atmo}\\) Atmospheric day length \\([h]\\)</p> \\[N_{eff} = 12 \\cdot \\frac{\\left(\\pi + 2 \\cdot \\arcsin \\left( \\frac{(-\\sin(\\frac{8 \\cdot \\pi}{180}) + \\delta{sin})}{\\delta_{cos}}   \\right)  \\right)}{\\pi}\\] <p>\\(N_{eff}\\) Effective day length \\([h]\\)</p> \\[N_{photo} = 12 \\cdot \\frac{\\left(\\pi + 2 \\cdot \\arcsin \\left( \\frac{(-\\sin(\\frac{-6 \\cdot \\pi}{180}) + \\delta_{sin})} {\\delta_{cos}} \\right)\\right)}{\\pi}\\] <p>\\(N_{photo}\\) Photoperiodic day length \\([h]\\)</p> \\[R_c = 0.5 \\cdot 1300 \\cdot \\bar{R}_{photo} \\cdot e^{\\frac{-0.14}{\\bar{R}_{photo}}}\\] <p>\\(R_c\\)   Irradiation under clear sky \\([J \\, m^{-2}]\\)</p> \\[R_o = 0.2 \\cdot R_c\\] <p>\\(R_o\\) Irradiation under clouded sky \\([J \\, m^{-2}]\\)</p> \\[\\bar{R}_{photo}  = 3600 \\cdot \\left(  \\delta_{sin} \\cdot N_{astro} + \\frac{24}{\\pi} \\cdot \\delta_{cos}  \\cdot \\sqrt{\\left(1-\\left(\\frac{\\delta_{sin}}{\\delta_{cos}}\\right)^2\\right)} \\,\\,\\,\\right)\\] <p>\\(\\bar{R}_{photo}\\) Mean photosynthetically active radiation \\([J \\, m^{-2}]\\)</p> <p>CO<sub>2</sub> has an impact on the crop\u2019s photosynthesis rate and stomata resistance, which in turn influences transpiration (Nendel et al., 2009). Mitchell et al. (1995) presented a set of algorithms for the calculation of the maximum photosynthesis rate, based on ideas of Farquhar and von Caemmerer (1982) and Long (1991):</p> \\[A =  \\frac{( C_i - \\Gamma^{*}) \\cdot V_{c_{max}}}{C_i + K_c \\cdot \\left(  1 + \\frac{O_i}{K_o} \\right)}\\] <p>\\(A\\) CO<sub>2</sub> assimilation rate \\([kg \\, CO_2 \\, ha^{-1} \\, d^{-1}]\\) \\(C_i\\) Inter-cellular CO<sub>2</sub> concentration \\([\\mu mol \\, mol^{-1}]\\) \\(\\Gamma^{*}\\) Compensation point of photosynthesis, related to \\(C_i\\) in absence of dark respiration \\([\\mu mol \\, mol^{-1}]\\) \\(O_i\\) Inter-cellular O<sub>2</sub> concentration \\([\\mu mol \\, mol^{-1}]\\) \\(V_{c_{max}}\\) Maximum saturated Rubisco carboxylation rate \\([\\mu mol \\, m^{-2} \\, s^{-1}]\\) \\(K_c\\) Michaelis-Menten constant for CO<sub>2</sub> \\([\\mu mol \\, mol^{-1}]\\) \\(K_o\\) Michaelis-Menten constant for O<sub>2</sub> \\([\\mu mol \\, mol^{-1}]\\)</p> <p>Temperature dependencies of \\(C_i\\), \\(O_i\\), \\(K_c\\), \\(K_0\\) and \\(V_{c_{max}}\\) and its parameters were described by Long (1991). Accordingly, \\(C_i\\) is calculated from atmospheric CO<sub>2</sub> concentration \\(C_a\\) as:</p> \\[C_i = C_a \\cdot 0.7 \\cdot \\frac{(1.674 - 6.1294 \\cdot 10^{-2} \\cdot T + 1.1688 \\cdot 10^{-3} \\cdot T^2 - 8.8741 \\cdot 10^{-7} \\cdot T^3 )}{0.73547}\\] <p>\\(C_i\\) Inter-cellular CO<sub>2</sub> concentration \\([\\mu mol \\, mol^{-1}]\\) \\(T\\) Daily mean air temperature in 2 m height \\([^{\\circ} C]\\)</p> <p>Respectively, \\(O_i\\) is calculated by:</p> \\[O_i = 210 + \\frac {( 0.047 - 1.3087 \\cdot 10^{-4} \\cdot T + 2.5603 \\cdot 10^{-6} \\cdot T^2 - 2.1441 \\cdot 10^{-8} \\cdot T^3 )}  {2.6934 \\cdot 10^{-2}}\\] <p>\\(O_i\\) Inter-cellular O<sub>2</sub> concentration \\([\\mu mol \\, mol^{-1}]\\) \\(T\\) Daily mean air temperature in 2 m height \\([^{\\circ} C]\\)</p> <p>The seasonal dynamic of the atmospheric CO<sub>2</sub> concentration from 1958 until today is described using:</p> \\[C_a = 222 + e ^{0.0119 \\cdot (t_{dec} - 1580)} + 2.5 \\cdot \\sin \\left( \\frac{t_{dec} - 0.5} {0.1592} \\right)\\] <p>\\(C_a\\) Atmospheric CO<sub>2</sub> concentration \\([\\mu mol \\, mol^{-1}]\\) \\(t_{dec}\\) Date in decimal form </p> <p>The algorithm used for light intensities below saturation which Mitchell et al. (1995) presented, was not applied. Instead, \\(A_{max}\\) is adapted to light interception according to Goudriaan and van Laar (1978). Mitchell et al. (1995) proposed the following algorithm for the transition between photosynthetic quantum use efficiency and light-saturated photosynthesis:</p> \\[\\varepsilon_L = \\frac{0.37 \\cdot (C_i - \\Gamma^{*})} {4.5 \\cdot C_i + 10.5 \\cdot \\Gamma^{*}}\\] <p>\\(\\varepsilon_L\\) Radiation use efficiency of CO<sub>2</sub> assimilation \\([kg \\, CO_2 \\, J^{-1} \\, ha^{-1} \\, h^{-1}]\\) \\(C_i\\) Inter-cellular CO<sub>2</sub> concentration \\([\\mu mol \\, mol^{-1}]\\) \\(\\Gamma^{*}\\) Compensation point of photosynthesis, related to \\(C_i\\) in absence of dark respiration  \\([\\mu mol \\, mol^{-1}]\\)</p> <p>The compensation point of photosynthesis is obtained from:</p> \\[\\Gamma^{*} = \\frac{0.5 \\cdot 0.21 \\cdot V_{c_{max}} \\cdot O_i} {V_{c_{max}} \\cdot K_o}\\] <p>\\(C_i\\) Inter-cellular CO<sub>2</sub> concentration \\([\\mu mol \\, mol^{-1}]\\) \\(\\Gamma^{*}\\) Compensation point of photosynthesis, related to \\(C_i\\) in absence of dark respiration \\([\\mu mol \\, mol^{-1}]\\) \\(V_{c_{max}}\\) Maximum saturated Rubisco carboxylation rate \\([\\mu mol \\, m^{-2} \\, s^{-1}]\\) \\(K_o\\) Michaelis-Menten constant for O<sub>2</sub> \\([\\mu mol \\, mol^{-1}]\\)</p> <p>The maximum saturated Rubisco carboxylation rate \\(V_{c_{max}}\\) is calculated from:</p> \\[V_{c_{max}} = 98 \\cdot \\frac{A_{max}} {34.668} \\cdot k(T)_{v_{cmax}}\\] <p>\\(V_{c_{max}}\\) Maximum saturated Rubisco carboxylation rate \\([\\mu mol \\, m^{-2} \\, s^{-1}]\\) \\(A_{max}\\) Plant-specific maximum CO<sub>2</sub> assimilation rate \\([kg \\, CO_2 \\, ha^{-1} \\, d^{-1}]\\) \\(k(T)_{v_{cmax}}\\) Temperature function for \\(V_{c_{max}}\\)</p> <p></p> <p>Figure 1: Temperature function for \\(V_{c_{max}}\\) (Long, 1991).</p> <p>For crops using the C4 metabolism, no direct impact of the atmospheric CO<sub>2</sub> concentration on photosynthesis is assumed. The crop-specific maximum CO<sub>2</sub> assimilation rate is merely modified by a simple temperature function.</p> <p></p> <p>Figure 2: Temperature function for the CO<sub>2</sub> assimilation rate of C4 crops (Sage &amp; Kubien 2007).</p>"},{"location":"model_science/crop_processes/photosynthesis/#references","title":"References","text":"<ul> <li> <p>Farquhar, G. D. &amp; von Caemmerer, S. (1982). Modelling of photosynthetic response to environmental conditions. In: Encyclopedia of plant physiology. New series. Volume 12B. Physiological plant ecology. II. Water relations and carbon assimilation. (Eds O. L. Lange, P. S. Nobel, C. B. Osmond, &amp; H. Ziegler), pp. 549-587. Berlin: Springer.</p> </li> <li> <p>Goudriaan, J. &amp; van Laar, H. H. (1978). Relations between leaf resistance, CO2 concentration and CO2 assimilation in maize, beans, lalang grass and sunflower. Photosynthetica 12 (3), 241-249.</p> </li> <li> <p>Long, S. P. (1991). Modification of the response of photosynthetic productivity to rising temperature by atmospheric CO2 concentrations - Has its importance been underestimated. Plant Cell and Environment 14 (8), 729-739.</p> </li> <li> <p>Mitchell, R. A. C., Lawlor, D. W., Mitchell, V. J., Gibbard, C. L., White, E. M., &amp; Porter, J. R. (1995). Effects of elevated CO2 concentration and increased temperature on winter-wheat - Test of ARCWHEAT1 simulation model. Plant Cell and Environment 18 (7), 736-748.</p> </li> <li> <p>Nendel, C., Kersebaum, K. C., Mirschel, W., Manderscheid, R., Weigel, H. J., &amp; Wenkel, K.-O. (2009). Testing different CO2 response algorithms against a FACE crop rotation experiment. NJAS - Wageningen Journal of Life Sciences 57 (1), 17-25.</p> </li> <li> <p>Sage, R. F. &amp; Kubien, D. S. (2007). The temperature response of C3 and C4 photosynthesis. Plant Cell and Environment 30 (9), 1086-1106.</p> </li> <li> <p>van Keulen, H., Penning de Vries, F. W. T., &amp; Drees, E. M. (1982). A summary model for crop growth. In: Simulation of plant growth and crop production (Eds F. W. T. Penning de Vries &amp; H. H. van Laar), pp. 87-97. Wageningen: PUDOC.</p> </li> </ul>"},{"location":"model_science/crop_processes/respiration/","title":"Respiration","text":"<p>Maintenance respiration is calculated for the photo period and for darkness using AGROSIM algorithms (Mirschel und Wenkel, 2007):</p> \\[M_{photo} = \\sum (W_i \\cdot m_i) \\cdot 2^{a\\cdot(T_{photo} - b)} \\cdot (2-L_N)\\] \\[M_{dark} = \\sum (W_i \\cdot m_i) \\cdot 2^{a\\cdot(T_{dark} - b)} \\cdot L_N\\] <p>\\(M_{photo}\\) Maintenance respiration during the photo period \\([Pa]\\) \\(M_{dark}\\) Maintenance respiration in darkness \\([Pa]\\) \\(W_i\\) Dry mass of organ \\(i\\) \\([kg \\, m^{-2}]\\) \\(m_i\\) Specific maintenance respiration of organ \\(i\\) \\([kg \\, m^{-2}]\\) \\(T_{photo}\\) Mean temperature during the photo period \\([^{\\circ} C]\\) \\(T_{dark}\\) Mean temperature during the dark period \\([^{\\circ} C]\\) \\(a, b\\) Parameters \\(L_N\\) Normalised day length \\([d]\\)</p> <p>where</p> \\[L_N = 2 - \\left ( \\frac{L_p}{12} \\right )\\] <p>\\(L_N\\) Normalised day length \\([d]\\) \\(L_P\\) Photoactive day length \\([d]\\)</p> <p>and</p> \\[T_{photo} = T_{max} - \\left ( \\frac{T_{max} - T_{min}} {4}  \\right )\\] \\[T_{dark} = T_{min} + \\left ( \\frac{T_{max} - T_{min}} {4}  \\right )\\] <p>\\(T_{photo}\\) Mean temperature during the photo period \\([^{\\circ} C]\\) \\(T_{max}\\) Daily maximum air temperature \\([^{\\circ} C]\\) \\(T_{min}\\) Daily minimum air temperature \\([^{\\circ} C]\\)</p> <p>Growth respiration is calculated accordingly.</p> <p>Maintenance respiration is served with priority using assimilates produced by photosynthesis; growth respiration is second in line. Assimilates are assigned to the crop organs according to a partitioning matrix which is organised by the crop\u2019s developmental stages. The crop's development, in turn, is calculated from the sum of degree days and, if applicable, modified for each stage by day length and vernalisation requirement.</p>"},{"location":"model_science/crop_processes/respiration/#reference","title":"Reference","text":"<ul> <li>Mirschel, W. und K.-O. Wenkel (2007): Modelling soil-crop interactions with AGROSIM model family. In: K.C. Kersebaum, J.-M. Hecker, W. Mirschel und M. Wegehenkel (Hrsg.), Modelling water and nutrient dynamics in soil crop systems. Springer, Stuttgart, 59-74.</li> </ul>"},{"location":"model_science/crop_processes/root_growth/","title":"Root growth","text":"<p>The simulation of root growth follows the concept proposed by Pedersen et al. (2010). Root dry mass is distributed over depth according to Gerwitz &amp; Page (1974), with rooting depth increasing exponentially with the modified thermal time. The crop-specific maximum rooting depth is adjusted using the soil-specific maximum rooting depth, which is calculated from the soil sand content and bulk density:</p> \\[R_{max} = \\frac{R_{B_{max}} + 2 \\cdot R_{p_{max}}}{3}\\] <p>\\(R_{max}\\) Maximum rooting depth \\([m]\\) \\(R_{B_{max}}\\) Crop-specific maximum rooting depth \\([m]\\) \\(R_{p_{max}}\\) Soil-specific maximum rooting depth \\([m]\\)</p> <p>and</p> \\[R_{B_{max}} = f_s \\cdot \\left (   \\frac{ ( 1.1-f_s) } {0.275} \\right ) \\cdot \\left ( \\frac{1.4}{\\rho_B} + \\frac{\\rho^2_B}{40}  \\right)\\] <p>\\(R_{B_{max}}\\) Soil-specific maximum rooting depth \\([m]\\) \\(f_s\\) Soil sand content \\([kg \\, kg^{-1}]\\) \\(\\rho_B\\) Soil bulk density  \\([kg \\, m^{-3}]\\)</p> <p>whereas the influence of sand content is limited for values below 0.55 kg kg-1.</p> <p>The crop-specific root penetration rate into deeper soil layers is reduced at low clay contents.</p> <p></p> <p>Figure 1: Vertical penetration rate of winter wheat roots in relation to soil clay content.</p> <p>The thermal time for root growth is calculated based on a minimum temperature that limits root development:</p> \\[DD_{root} = T_{av} - T_{r\\,min}\\] <p>\\(DD_{root}\\) Thermal time for root growth \\([^{\\circ}C \\, d]\\) \\(T_{av}\\) Mean daily air temperature \\([^{\\circ}C]\\) \\(T_{r\\,min}\\) Minimum temperature for root growth \\([^{\\circ}C]\\)</p> <p>The daily thermal increment is limited to 20\u00b0C.</p> <p>Accordingly, the rooting depth is calculated as:</p> <p>$\\(R_z = R_{ini} + (DD_{root} - DD_{lag} ) \\cdot k_{rz}\\)</p> <p>$\\(R_z\\) Current rooting depth \\([m]\\) \\(R_{ini}\\) Rooting depth at sowing \\([m]\\) \\(DD_{root}\\) Thermal time for root growth \\([^{\\circ}C \\, d]\\) \\(DD_{lag}\\) Delay in root initiation \\([^{\\circ}C \\, d]\\)</p> <p>The root length in the respective soil layer is then calculated from:</p> \\[L_{root} = W_{root} \\cdot l_r\\] <p>\\(L_{root}\\) Total root length \\([m \\, m^{-2}]\\) \\(W_{root}\\) Biomass in the root compartment \\([kg \\, m^{-2}]\\) \\(l_r\\) Crop-specific root length \\([m \\, kg^{-1}]\\)</p> <p>The distribution factor for root density in each soil layer is calculated as:</p> \\[\\lambda_z = \\begin{cases}   \\lambda_0 e^{-a_z\\cdot z} &amp; z &lt; R_z \\\\ \\lambda_0 e^{-a_z \\cdot z} \\cdot \\left ( 1- \\frac{z-R_z}{q \\cdot R_z - R_z }  \\right ) &amp; q \\cdot R_z &lt; z &lt; R_z  \\\\ 0 &amp; z &gt; q \\cdot R_z  \\end{cases}\\] <p>\\(\\lambda_z\\) Distribution factor of root length density at depth \\(z\\) \\([m \\, m^{-3}]\\) \\(\\lambda_0\\) Distribution factor of root length density at depth 0   \\([kg \\, m^{-3}]\\) \\(a_z\\) Shape factor \\(z\\) Depth \\([m]\\) \\(R_z\\) Rooting depth \\([m]\\) \\(q\\) Ratio of absolute to simulated rooting depth</p> <p>Using factors normalized to the range [0;1], the root length density in each soil layer is calculated as:</p> \\[\\Lambda_z = \\frac{\\lambda_z}{\\sum^{z_{max}}_{z=1} \\lambda_z} \\cdot L_{root}\\] <p>\\(\\Lambda_z\\) Root length density at depth \\(z\\) \\([m \\, m^{-3}]\\) \\(\\lambda_z\\) Distribution factor of root length density at depth \\(z\\) \\([m \\, m^{-3}]\\) \\(z_{max}\\) Maximum profile depth \\([m]\\) \\(L_{root}\\) Total root length \\([m \\, m^{-2}]\\)</p> <p>Finally, the root diameter is assumed to decrease from crops with above-ground storage organs (cereals, maize, rapeseed, etc.) and to remain constant for crops with below-ground storage organs (sugar beet, potato, carrot, etc.):</p> <p></p> <p>Figure 2: Root diameter in relation to soil depth for crops with above-ground (\u2011\u2011\u2011) and below-ground (\u2014) storage organs.</p>"},{"location":"model_science/crop_processes/root_growth/#reference","title":"Reference","text":"<ul> <li> <p>Gerwitz, A., Page, E.R. (1974): An empirical mathematical model to describe plant root systems. J. Apl. Ecol. 11, 773-781.</p> </li> <li> <p>Pedersen, A., Zhang, K.F., Thorup-Kristensen, K., Jensen, L.S. (2010): Modelling diverse root density dynamics and deep nitrogen uptake - A simple approach. Plant Soil 326 (1-2), 493-510.</p> </li> </ul>"},{"location":"model_science/crop_processes/transpiration/","title":"Transpiration","text":"<p>Reference evapotranspiration \\(ET0\\) is calculated using the Penman-Monteith method, according to Allen et al. (1998). This method requires the diurnal minimum and maximum temperature, the water vapour pressure deficit, wind velocity, and total global radiation.</p> \\[ET_0 = \\frac{0.408 \\cdot \\Delta \\cdot (R_n - G) + \\gamma \\cdot \\frac{900}{\\gamma + 273} \\cdot u_2 \\cdot (e_s - e_a) } {\\Delta + \\gamma \\cdot (1+\\frac{r_a}{r_s})}\\] <p>\\(\\Delta\\) Slope of the vapour pressure curve \\([kPa\\,K^{-1}]\\) \\(R_n\\) Net radiation at the crop surface \\([MJ\\, m^{-2} \\, d^{-1}]\\) \\(G\\) Soil heat flux density \\([MJ\\, m^{-2} \\, d^{-1}]\\) \\(T\\) Mean daily air temperature at 2 m height \\([^{\\circ} C]\\) \\(u_2\\) Wind speed at 2 m height \\([m \\, s^{-1}]\\) \\(e_s\\) Saturation vapour pressure \\([kPa]\\) \\(e_a\\) Actual vapour pressure \\([kPa]\\) \\(\\gamma\\) Psychrometric constant \\([kPa \\, K^{-1}]\\) \\(r_a\\) Atmospheric resistance \\([s\\, m^{-1}]\\) \\(r_s\\) Surface resistance \\([s\\, m^{-1}]\\)</p> <p>where</p> \\[\\gamma = 6.65 \\cdot 10^{-4} \\cdot P\\] <p>The surface resistance for the reference evapotranspiration assumes a 12 cm cut grass crop and is calculated using:</p> \\[r_s = \\frac {r_1} {1.44}\\] <p>\\(r_1\\) Stomata resistance; 100 s m\u20131 \\([s \\, m^{-1}]\\)</p> <p>The leaf area index \\(LAI\\) and crop height \\(h\\) are considered for the surface resistance of the actual crop:</p> \\[r_s = \\frac{r_1}{LAI \\cdot h_c}\\] <p>\\(r_s\\) Surface resistance \\([s \\, m^{-1}]\\) \\(r_1\\) Stomata resistance \\([s \\, m^{-1}]\\) \\(LAI\\) Leaf area index \\([m^2 \\, m^{-2}]\\) \\(h_c\\) Crop height \\([m]\\)</p> <p>The crop height is calculated using:</p> \\[H_c = \\frac{h_{c\\,max}}{1+ e^{-a \\cdot (DD_{relh}-b)}}\\] <p>\\(h_{c\\,max}\\) Crop-specific maximum height \\([m]\\) \\(a, b\\) Crop-specific parameter \\(DD_{relh}\\) Relative crop development for height</p> <p>where</p> \\[DD_{relh} = \\frac{DD_{acth}} {DD_{croph}}\\] <p>\\(DD_{acth}\\) Actual temperature sum from emergence \\([^{\\circ}C \\, d]\\) \\(DD_{croph}\\) Crop-specific total temperature sum up to maximum height \\([^{\\circ}C \\, d]\\)</p> <p>Specific leaf weights to calculate \\(LAI\\) from the leaf biomass are given for each development stage and adjusted linearly to the relative phenological development.</p> <p>The stomata resistance of the actual crop is calculated according to a suggestion of Yu et al. (2001):</p> \\[r_1  = \\frac{C_s(1+\\frac{e_a}{e_s}) } {a \\cdot A_g}\\] <p>\\(r_1\\) Stomata resistance \\([s^{-1}]\\) \\(C_s\\) CO<sub>2</sub> concentration outside the leaf (= \\(C_a\\))   \\([\\mu mol \\, mol^{-1}]\\) \\(A_g\\) Gross CO<sub>2</sub> assimilation rate \\([kg \\, CO_2 \\, ha^{-1} \\, d^{-1}]\\) \\(e_a\\) Actual air vapour pressure \\([Pa]\\) \\(e_s\\) Saturation air vapour pressure \\([Pa]\\)</p> <p>In a rough simplification, \\(C_s\\) is considered equal to the atmospheric CO<sub>2</sub> concentration \\(C_a\\). Its seasonal dynamic from 1958 up until today is described using:</p> \\[C_a = 222 + e^{ 0.0119 \\cdot (t_{dec} - 1580) } + 2.5 \\cdot \\left(   \\frac{t_{dec} - 0.5} {0.1592} \\right)\\] <p>\\(C_a\\) Atmospheric CO<sub>2</sub> concentration \\([\\mu mol \\, mol^{-1}]\\) \\(t_{dec}\\) Decimal date</p> <p>Additionally, this function carries forward the atmospheric CO<sub>2</sub> concentration until 2100, similar to the assumption made in the IPCC A1B scenario (IPCC, 2007).</p> <p>Crop-specific potential evapotranspiration is calculated using also crop-specific factors (\\(K_c\\)) during the crop\u2019s growth period, and a factor for bare soil between harvest and emergence of the subsequent crop. The \\(K_c\\) factors are coupled to the crop\u2019s developmental stages.</p> \\[ET_p = ET_0 \\cdot K_c - I\\] <p>\\(ET_p\\) Potential evapotranspiration \\([mm]\\) \\(ET_0\\) Reference evapotranspiration \\([mm]\\) \\(K_c\\) ncrop-specific factor \\(I\\) Evaporation from interception storage \\([mm]\\)</p> <p>To what extent transpiration contributes to total evapotranspiration is determined by the ground coverage:</p> \\[T_p = ET_p \\cdot \\beta\\] <p>\\(T_p\\) Potential transpiration \\([mm]\\) \\(ET_p\\) Potential evapotranspiration \\([mm]\\) \\(\\beta\\) Ground coverage</p> <p>Transpiration is calculated layer-wise for water uptake from the respective layer, considering root distribution, efficiency, and possible oxygen deficit.</p> \\[T_z = T_p \\cdot \\frac {\\omega_z \\cdot \\Lambda_z}   {\\sum^{z_{max}}_{i=1} \\omega_i \\cdot \\Lambda_j} \\cdot \\zeta_o\\] <p>\\(T_z\\) Actual transpiration in layer \\(z\\) \\([mm]\\) \\(T_p\\) Potential transpiration \\([mm]\\) \\(\\omega_z\\) Root water uptake efficiency in layer \\(z\\) (Fig. 1) \\(\\Lambda_z\\) Root length density in layer \\(z\\) \\([m \\, m^{-3}]\\) \\(\\zeta_o\\) Stress factor oxygen deficit</p> <p></p> <p>Figure 1: Reduction function for transpiration (\\(\\tau_z\\)) and for root water uptake efficiency (\\(\\omega_z\\)) in dependency of water availability in the respective soil layer.</p> <p>Given sufficient amounts of available water, it is removed from the soil layers according to the layer-wise calculated transpiration, from the soil surface downwards. A potential transpiration deficit is calculated for every layer:</p> \\[\\zeta_{Wpot} = \\left(  \\frac{T_z}{d\\cdot 1000} - (\\theta - \\theta_{PWP} ) \\right) \\cdot \\Delta z \\cdot 1000\\] <p>\\(\\zeta_{Wpot}\\) Potential transpiration deficit in layer \\(z\\) \\([mm]\\) \\(T_z\\) Actual transpiration in layer \\(z\\) \\([mm]\\) \\(\\Delta z\\) Depth of soil layer \\([m]\\) \\(\\theta\\) Water content in soil layer \\([m^3\\, m^{-3}]\\) \\(\\theta_{PWP}\\) Soil water content at permanent wilting point \\([m^3\\, m^{-3}]\\)</p> <p>At decreasing water contents water conductivity in the soil is reduced. The resulting reduction of transpiration in the soil layer is calculated as:</p> \\[T_{red} = T_z \\cdot (1-\\tau_z)\\] <p>\\(T_{red}\\) Reduced transpiration in layer \\(z\\) \\([mm]\\) \\(T_z\\) Actual transpiration in layer \\(z\\) \\([mm]\\) \\(\\tau_z\\) Reduction factor water availability (Fig.)</p> <p>The actual transpiration deficit of the respective layer is calculated from the larger of both values. It will be used to update actual transpiration.</p> \\[\\zeta_{Wact} = max(\\zeta_{Wpot}, T_{red})\\] <p>\\(\\zeta_{Wact}\\) Actual transpiration deficit in layer \\(z\\) \\([mm]\\) \\(\\zeta_{Wpot}\\) Potential transpiration deficit in layer \\(z\\) \\([mm]\\) \\(T_{red}\\) Reduced transpiration in layer \\(z\\) \\([mm]\\)</p> <p>The total actual transpiration of the crop adds up from the actual transpiration of the layers:</p> \\[T_a = \\sum^{z_{max}}_{z=1} T_z\\] <p>\\(T_a\\) Actual transpiration \\([mm]\\) \\(T_z\\) Actual transpiration in layer \\(z\\) \\([mm]\\) \\(z\\) Layer number \\(z_{max}\\) Lowest layer in soil profile</p> <p>Crop growth is limited by water availability. Drought stress is indicated by the relation of actual to potential transpiration (Kersebaum, 1995).</p>"},{"location":"model_science/crop_processes/yield/","title":"Yield","text":"<p>A crop\u2019s marketable yield is currently calculated from the simulated dry matter of the storage organ:</p> \\[E_{FM} = W_s \\cdot HI \\cdot DM\\] <p>\\(E_{FM}\\) Fresh matter yield \\([kg \\, FM \\, m^{-2}]\\) \\(W_s\\) Dry matter storage organ \\([kg \\, DM \\, m^{-2}]\\) \\(HI\\) Harvest index \\(DM\\) Dry matter content \\([kg \\, DM \\, kg \\, FM^{-1}]\\)</p> <p>Raw protein content in grain yield is calculated from N in grain yield. N in grain yield is calculated from the ratio of marketable and non-marketable yield and a plant-specific parameter which determines the N distribution between those two compartments:</p> \\[P_{FM} = \\frac{N_A} {W_s + (p_N \\cdot W_R)} \\cdot \\frac{1}{N_p}\\] <p>\\(P_{FM}\\) Raw protein content in dry matter yield \\([kg \\, Raw \\, protein \\, kg \\, DM^{-1} ]\\) \\(N_A\\) N concentration in above-ground dry matter \\([kg \\, N \\, m^{-2}]\\) \\(W_s\\) Dry matter storage organ \\([kg \\, DM \\, m^{-2}]\\) \\(p_N\\) N distribution coefficient \\(W_R\\) Dry matter above-ground crop residues \\([kg \\, DM \\, m^{-2}]\\) \\(N_p\\) Average N concentration raw protein (= 0.16)  \\([kg \\, N \\, kg \\, Raw \\, protein^{-1}]\\)</p> <p>where</p> \\[p_N = \\frac{N_R}{N_Y}\\] <p>\\(p_N\\) N distribution coefficient \\(N_R\\) Average N concentration in crop residues \\([kg \\, N \\, kg \\, DM^{-1}]\\) \\(N_Y\\) Average N concentration in marketable yield</p>"},{"location":"model_science/soil_processes/evaporation/","title":"Evaporation","text":"<p>Reference evapotranspiration for short-cut grass \\(ET_0\\) is calculated using the Penman-Monteith method (1998).</p> \\[ET_0 = \\frac{0.408 \\cdot \\Delta \\cdot (R_n - G) + \\gamma \\cdot \\frac{900}{\\gamma + 273} \\cdot u_2 \\cdot (e_s - e_a) } {\\Delta + \\gamma \\cdot (1+\\frac{r_a}{r_s})}\\] <p>\\(\\Delta\\) Slope of the vapour pressure curve \\([kPa\\,K^{-1}]\\) \\(R_n\\) Net radiation at the crop surface \\([MJ\\, m^{-2} \\, d^{-1}]\\) \\(G\\) Soil heat flux density \\([MJ\\, m^{-2} \\, d^{-1}]\\) \\(T\\) Mean daily air temperature at 2 m height \\([^{\\circ} C]\\) \\(u_2\\) Wind speed at 2 m height \\([m \\, s^{-1}]\\) \\(e_s\\) Saturation vapour pressure \\([kPa]\\) \\(e_a\\) Actual vapour pressure \\([kPa]\\) \\(\\gamma\\) Psychrometric constant \\([kPa \\, K^{-1}]\\) \\(r_a\\) Atmospheric resistance \\([s\\, m^{-1}]\\) \\(r_s\\) Surface resistance \\([s\\, m^{-1}]\\)</p> <p>Crop-specific potential evapotranspiration is calculated using also crop-specific factors (\\(k_c\\)) during the crop\u2019s growth period and a factor for bare soil between harvest and emergence of the subsequent crop. The \\(k_c\\) factors are coupled to the crop\u2019s developmental stages.</p> \\[ET_p = ET_0 \\cdot k_c - I\\] <p>\\(ET_p\\) Potential evapotranspiration \\([mm]\\) \\(ET_0\\) Reference evapotranspiration \\([mm]\\) \\(k_c\\) Crop-specific factor \\(I\\) Evaporation from interception storage \\([mm]\\)</p> <p>To what extent evaporation contributes to total evapotranspiration is determined by the ground coverage.</p> \\[E_p = ET_p \\cdot (1-\\beta)\\] <p>\\(E_p\\) Potential evaporation \\([mm]\\) \\(ET_p\\) Potential evapotranspiration \\([mm]\\) \\(\\beta\\) Ground coverage</p> <p>Evaporation is limited by water availability and the soil-air vapour pressure gradient. The reduction factor \\(\\varepsilon_1(z)\\), which describes the limitation of evaporation by water availability, is determined by an empirical HERMES function (Figure 1), for which the relative water availability is calculated as:</p> \\[W_{ERel}(z) =  \\begin{cases} 0 &amp; \\theta&lt;0.33 \\cdot \\theta_{PWP}  \\\\   \\frac{\\theta - (0.33 \\cdot \\theta_{PWP})} {\\theta_{FC} - (0.33 \\cdot \\theta_{PWP})} &amp; \\theta \\geq 0.33 \\cdot \\theta_{PWP} \\end{cases}\\] <p>\\(W_{ERel}(z)\\) Relative water availability for evaporation in soil layer \\(z\\) \\(\\theta\\) Water content in soil layer \\(z\\) \\([m^3 \\, m^{-3}]\\) \\(\\theta{PWP}\\) Water content at permanent wilting point in soil layer \\(z\\) \\([m^3 \\, m^{-3}]\\) \\(\\theta{FC}\\) Water content at field capacity in soil layer \\(z\\) \\([m^3 \\, m^{-3}]\\)</p> <p></p> <p>Figure 1: The reduction factor for water availability for evaporation \\(\\varepsilon_2(z)\\) in relation to the relative water availability for evaporation (Kersebaum, 1989).</p> <p>The limitation of evaporation by the soil-air vapour pressure gradient is expressed in two further reduction factors. The first of these \u2013 referred to as the deprivation factor \\(\\varepsilon_2(z)\\) \u2013 considers the depth of the soil layer from which the water volume evaporates and thus, although implicitly, the slope of the vapour pressure gradient in the air-filled soil volume.</p> \\[\\varepsilon_2(z) = (a_1 - a_2) \\cdot \\frac{\\zeta + 1} {log(\\zeta + 1) - \\zeta}\\] <p>\\(\\varepsilon_2(z)\\)  Reduction factor deprivation depth \\(\\zeta\\) Curvature of the deprivation function</p> <p>where</p> \\[a_1 = log \\left( \\frac { \\frac{Z_{E \\,max}}{\\Delta Z} + \\zeta \\cdot Z}  {\\frac{Z_{E \\,max}}{\\Delta Z} + \\zeta \\cdot (z-1) }\\right)\\] <p>\\(\\zeta\\) Curvature of the deprivation function \\(Z_{E \\, max}\\) Maximum impact depth of evaporation \\([m]\\) \\(z\\) Layer number \\(\\Delta z\\) Layer depth \\([m]\\)</p> <p>and</p> \\[a_2 = \\frac{\\zeta} {\\frac{Z_{E \\, max}}{\\Delta z} \\cdot (\\zeta + 1)}\\] <p>\\(\\zeta\\) Curvature of the deprivation function \\(Z_{E \\, max}\\) Maximum impact depth of evaporation \\([m]\\) \\(\\Delta z\\) Layer depth \\([m]\\)</p> <p>The second factor expresses is a simple way that almost no water vapour evaporates upwards from a soil layer if the adjacent layer above contains more water than the other because of a reverse vapour pressure gradient.</p> \\[\\varepsilon_3(z)=\\begin{cases}0.1 &amp; \\theta_z \\leq \\theta_{z-1} \\\\1.0 &amp; \\theta_z &gt; \\theta_{z-1}\\end{cases}\\] <p>\\(\\varepsilon_3(z)\\) Reduction factor vapour pressure gradient in soil layer \\(z\\) \\(\\theta\\) Water content in soil layer \\(z\\) \\([m^3 \\, m^{-3}]\\) \\(\\theta_{z-1}\\) Water content in soil layer \\(z\u20131\\) \\([m^3 \\, m^{-3}]\\)</p> <p>The reduction factors for evaporation simply merge to:</p> \\[\\varepsilon_z = \\varepsilon_1(z) \\cdot \\varepsilon_2(z) \\cdot \\varepsilon_3(z)\\] <p>\\(\\varepsilon_z\\) Reduction factor for evaporation in soil layer \\(z\\) \\(\\varepsilon_1(z)\\) Reduction factor water availability in soil layer \\(z\\) \\(\\varepsilon_2(z)\\) Reduction factor deprivation depth \\(\\varepsilon_3(z)\\) Reduction factor vapour pressure gradient in soil layer \\(z\\)</p> <p>If water is ponding at the soil surface, evaporation is only fed from this pond, assuming a 10% higher evaporation than from moist soil. If snow covers the soil, evaporation is set to zero. Sublimation of snow crystals is not explicitly modelled. However, the snow module considers this process in the snow ageing process.</p> <p>The total actual evaporation adds up from the contribution of the affected layers:</p> \\[E_a = \\sum_{z=1}^{z_{max}} E_p \\cdot \\varepsilon_z\\] <p>\\(E_a\\) Actual evaporation \\([mm]\\) \\(E_p\\) Potential evaporation \\([mm]\\) \\(\\varepsilon_z\\) Reduction factor for evaporation in soil layer \\(z\\) \\(z\\) Layer number \\(z_{Emax}\\) Lowest soil layer affected by evaporation</p>"},{"location":"model_science/soil_processes/matter_transport/","title":"Matter transport","text":"<p>In soil, nutrients are transported with the moving water. So far, MONICA only describes the translocation of dissolved nitrate ions. However, using the convection-dispersion equation, modelling of ammonium, sulphate, and dissolved organic matter transport is also imaginable. The basic version of the convection-dispersion equation is:</p> \\[\\frac{\\partial \\theta c}{\\partial t}  = \\frac{\\partial}{\\partial z} \\cdot \\left ( \\theta \\cdot D \\cdot \\frac{\\partial c}{\\partial z}\\right ) - \\frac{\\partial q c}{\\partial z}\\] <p>\\(\\theta\\) Soil moisture content \\([m^{3} \\, m^{-3}]\\) \\(c\\) Solute concentration \\([kg \\, m^{-3}]\\) \\(D\\) Effective dispersion coefficient \\([m^{2} \\, m^{-1}]\\) \\(z\\) Soil depth \\([m]\\) \\(t\\) Time \\([d]\\)</p> <p>which includes water flow:</p> \\[q = -K (\\Psi_m) \\cdot \\left ( \\frac{\\partial \\Psi_m}{\\partial z} - 1   \\right)\\] <p>\\(q\\) Water flux density \\([m \\, d^{-1}]\\) \\(\\Psi_m\\) Soil matrix potential \\([cm \\, WS]\\) \\(K(\\Psi_m)\\) Hydraulic conductivity \\([m \\, d^{-1}]\\) \\(\\theta\\) Soil moisture content \\([m^3 \\, m^{-3}]\\) \\(z\\) Soil depth \\([m]\\)</p> <p>the effective dispersion coefficient:</p> \\[D = D_0 \\cdot \\frac{1}{\\tau} + \\alpha_v \\cdot \\left |  \\frac{q}{\\theta} \\right |\\] <p>\\(D\\) Effective dispersion coefficient \\([m^2 \\, d^{-1}]\\) \\(D_0\\) Diffusion coefficient in solution (0.000214) \\([m^2 \\, d^{-1}]\\) \\(\\tau\\) Tortuosity \\([m^2 \\, m^{-2}]\\) \\(\\alpha_v\\) Dispersion factor (0.05) \\([m]\\) \\(q\\) Water flux density \\([m \\, d^{-1}]\\) \\(\\theta\\) Volumetric water content \\([m^3 \\, m^{-3}]\\)</p> <p>in which tortuosity is used as its inverse, pore space continuity.</p> \\[\\tau = \\frac{\\theta}{a \\cdot e^{10 \\cdot \\theta}}\\] <p>\\(\\tau\\) Tortuosity \\([m^2 \\, m^{-2}]\\) \\(\\theta\\) Volumetric water content \\([m^3 \\, m^{-3}]\\) \\(a\\) Factor (0.002)</p> <p>The convection-dispersion equation is solved using the explicit finite difference method.</p> <p>For \\(q1/2 &gt; 0\\):</p> \\[\\frac{ \\theta_{i , t+\\Delta t} \\cdot c_{i, t+\\Delta t} - \\theta_{i, t} \\cdot c_{i, t}}   {\\Delta t} =\\] \\[\\left (   \\theta_{i - \\frac{1}{2}, t} \\cdot D_{i-\\frac{1}{2}, t} - \\frac{\\Delta z}{2} \\cdot q_{i-\\frac{1}{2}, t} + \\frac{\\Delta t \\cdot q_{i,t} \\cdot q_{i-\\frac{1}{2}, t}} {2 \\cdot \\theta_{i-\\frac{1}{2}, t}} \\right )   \\cdot \\frac {c_{i-1, t} - c_{i, t}} {(\\Delta z)^2}\\] \\[- \\left ( \\theta_{i+\\frac{1}{2}, t} \\cdot D_{i+\\frac{1}{2}, t} - \\frac{\\Delta z}{2} \\cdot q_{i+\\frac{1}{2}, t} + \\frac{\\Delta t \\cdot q_{i,t} \\cdot q_{i+\\frac{1}{2},t}}  {2 \\cdot \\theta_{i+\\frac{1}{2},t}}   \\right ) \\cdot \\frac{c_{i,t} - c_{i+1,t}}{(\\Delta z)^2}\\] \\[-  \\frac{q_{i+\\frac{1}{2}, t} \\cdot c_{i,t} - q_{i-\\frac{1}{2}, t} \\cdot c_{i-1,t} }{\\Delta z}\\] <p>and for \\(q1/2 &lt; 0\\):</p> \\[\\frac{ \\theta_{i , t+\\Delta t} \\cdot c_{i, t+\\Delta t} - \\theta_{i, t} \\cdot c_{i, t}}   {\\Delta t} =\\] \\[\\left (   \\theta_{i - \\frac{1}{2}, t} \\cdot D_{i-\\frac{1}{2}, t} - \\frac{\\Delta z}{2} \\cdot q_{i-\\frac{1}{2}, t} + \\frac{\\Delta t \\cdot q_{i,t} \\cdot q_{i-\\frac{1}{2}, t}} {2 \\cdot \\theta_{i-\\frac{1}{2}, t}} \\right )   \\cdot \\frac {c_{i-1, t} - c_{i, t}} {(\\Delta z)^2}\\] \\[- \\left ( \\theta_{i+\\frac{1}{2}, t} \\cdot D_{i+\\frac{1}{2}, t} - \\frac{\\Delta z}{2} \\cdot q_{i+\\frac{1}{2}, t} + \\frac{\\Delta t \\cdot q_{i,t} \\cdot q_{i+\\frac{1}{2},t}}  {2 \\cdot \\theta_{i+\\frac{1}{2},t}}   \\right ) \\cdot \\frac{c_{i,t} - c_{i+1,t}}{(\\Delta z)^2}\\] \\[-  \\frac{q_{i+\\frac{1}{2}, t} \\cdot c_{i+1,t} - q_{i-\\frac{1}{2}, t} \\cdot c_{i,t} }{\\Delta z}\\] <p>\\(\\theta\\) Volumetric water content \\([m^3 \\, m^{-3}]\\) \\(c\\) Solute concentration \\([kg \\, m^{-3}]\\) \\(D\\) Effective dispersion coefficient \\([m^2 \\, d^{-1}]\\) \\(q\\) Water flux density \\([m \\, d^{-1}]\\) \\(i\\) Soil layer \\(z\\) Soil depth \\([m]\\) \\(t\\) Time \\([d]\\)</p> <p>In case of high water fluxes, the time step is reduced for numerical stability reasons.</p> <p>\\(t=1.0\\) for q &lt; 5.0 mm d\u20131  \\([d]\\) \\(t=0.5\\) for q &gt; 5.0 mm d\u20131 und q &lt; 10.0 mm d\u20131 \\([d]\\) \\(t=0.25\\) for q &gt; 10.0 mm d\u2013\u20131 und q &lt; 15.0 mm d\u20131 \\([d]\\) \\(t=0.125\\) for q &gt; 15.0 mm d\u20131 \\([d]\\)</p>"},{"location":"model_science/soil_processes/nitrification_and_denitrification/","title":"Nitrification and Denitrification","text":"<p>The turn-over processes of ammonium to nitrate (nitrification) and of nitrate to dinitrogen (denitrification) are described as:</p> \\[N = K_{NO} \\cdot c_{NH^+_4} \\cdot f_N(T) \\cdot f_N(\\theta)\\] <p>\\(N\\) Nitrification rate  \\([kg \\, N \\, m^{-3} \\, d^{-1}]\\) \\(K_{NO}\\) Nitrification rate coefficient at standard conditions \\([d^{-1}]\\) \\(c_{NH_4^+}\\) \\(NH_4^+\\) concentration in soil \\([kg \\, N \\, m^{-3}]\\) \\(f_N(T)\\) Reduction factor temperature (Fig. 2) \\(f_N(\\theta)\\) Reduction factor soil moisture (Fig. 3)    </p> <p></p> <p>Figure 1: \\(f_N(\\theta)\\) \u2013 Reduction factor for nitrification in dependence of the soil water potential (Abrahamsen and Hansen, 2000).</p> <p></p> <p>Figure 2: Reduction factor for nitrification (\\(f_N(T)\\)) and denitrification (\\(f_D(T)\\)) in dependence of soil temperature (Abrahamsen and Hansen, 2000).</p> \\[D_{pot} = K_{DO} \\cdot \\Phi_{CO_2} \\cdot f_D(T)\\] <p>\\(D_{pot}\\) Potential denitrification rate \\([kg \\, N \\, m^{-3} \\, d^{-1}]\\) \\(K_{DO}\\) Anaerobic denitrification rate \\([kg \\, N \\, m^{-3} \\, d^{-1}]\\) \\(\\Phi_{CO_2}\\) Microbial CO<sub>2</sub> release rate \\([kg \\, C \\, d^{-1}]\\) \\(f_D(T)\\) Reduction factor temperature (Fig. 2)</p> <p></p> <p>Figure 3: \\(f_D(\\theta)\\) \u2013 Reduction factor for denitrification in dependence of water-filled pore space in soil (Abrahamsen and Hansen, 2000).</p> \\[D_{act} = min \\begin{cases} D_{pot} f_D(\\theta) \\\\ V_{NO_3} \\cdot C_{NO_3}  \\end{cases}\\] <p>\\(D_{act}\\)   Actual denitrification rate \\([kg \\, N \\, m^{-3} \\, d^{-1}]\\) \\(D_{pot}\\)   Potential denitrification rate \\([kg \\, N \\, m^{-3} \\, d^{-1}]\\) \\(f_D(\\theta)\\) Reduction factor soil moisture (Fig. 3) \\([d^{-1}]\\) \\(V_{NO_3}\\) Transport rate \\(NO_3^-\\) \\([kg \\, N \\, m^{-3}]\\) \\(C_{NO_3}\\) Soil \\(NO_3^-\\) concentration </p>"},{"location":"model_science/soil_processes/nitrification_and_denitrification/#references","title":"References","text":"<ul> <li>Abrahamsen, P., Hansen, S., 2000. Daisy: an open soil-crop-atmosphere system model. Environ. Mod. Software 15, 313-330.</li> </ul>"},{"location":"model_science/soil_processes/organic_matter_turn-over/","title":"Organic matter turn-over","text":"<p>The calculation of organic matter turn-over is based on algorithms used in the DAISY model (Hansen et al., 1991). Soil carbon dynamics are described using three pairs (rapid and slow turn-over) of conceptional pools (soil organic matter, microbial biomass, and freshly added organic matter).</p> <p>Rate coefficients of decomposition are dependent on soil temperature and moisture and describe the environmental conditions of the simulated site. Microbial biomass death and respiration rates are additionally influenced by soil clay content.</p> <p>Efficiency parameters govern CO<sub>2</sub> emissions for the single turn-over processes. N release as \\(NH_4^+\\) is a consequence of C losses in the form of CO<sub>2</sub> from the system, in which constant C-to-N ratios are maintained for the conceptional pools.</p> <p></p> <p>Figure 1: Scheme of the organic matter turn-over module. \\(AOM\\) = added organic matter pool; \\(SMB\\) = soil microbial biomass pool; \\(SOM\\) = soil organic matter pool, each of which is characterised by a rapid and a slow decomposition rate. \\(r_0\\) = turn-over rate at standard conditions; \\(r_{death}\\) = death rate of microbial biomass; \\(r_{maint}\\) = maintenance respiration of microbial biomass; \\(f(clay), \\, f(T), \\, f(\\theta)\\) = decomposition rates for soil organic matter in dependence of soil clay content, temperature, and moisture (Abrahamsen and Hansen, 2000).</p> <p></p> <p>Figure 2: \\(f(clay)\\) \u2013 Decomposition coefficient for soil organic matter in dependence of soil clay content (Abrahamsen and Hansen, 2000).</p> <p></p> <p>Figure 3: \\(f(theta)\\) \u2013 Decomposition coefficient for soil organic matter in dependence of soil water potential (Abrahamsen and Hansen, 2000).</p> <p></p> <p>Figure 4: \\(f(T)\\) \u2013 Decomposition coefficient for soil organic matter in dependence of soil temperature (Abrahamsen and Hansen, 2000).</p> <p>Residues of the virtual plant remaining in the field are assigned a dynamic C-to-N ratio and passed on to the mineralisation process. The residue\u2019s total N content is then calculated from its amount, the total N content of the crop, and a factor which denotes the crop residue\u2019s N concentration in relation to that of the marketable yield. This approach reflects the N nutrition of the crop during the season and was taken from the EU\u2011Rotate_N simulation model (Rahn et al., 2010). While slowly decomposing parts of the plant material are assigned a constant C-to-N ratio, the C-to-N ratio of the rapidly decomposing parts varies in relation to the plant\u2019s total N content as:</p> \\[CN(AOM_f) = \\frac{C_{AOM} \\cdot f(AOM_f)} {N_{AOM} - \\left(  \\frac{C_{AOM} \\cdot f(AOM_s)} {CN(AOM_s)}   \\right)}\\] <p>where \\(CN\\) denotes the C-to-N ratio, \\(C_{AOM}\\) the C concentration, and \\(N_{AOM}\\) the N concentration in the added organic matter (AOM). \\(f\\) is the part of AOM which is assigned rapidly (\\(AOM_f\\)) or slowly (AOMs) decomposing fractions. The decomposition rate coefficients of both pools are constant (Abrahamsen and Hansen, 2000).</p> <p>C-to-N ratios and partitioning coefficients for different crop residues were determined using stepwise chemical digestion (Jensen et al., 2005). Parameters for N release from manure and slurry were taken from the DAISY model (Abrahamsen and Hansen, 2000). Crop residues having a wide C-to-N ratio induce immobilisation of mineral N in soil. In the case of insufficient mineral N being available in soil, all decomposition processes with a negative N balance cease.</p> <p>N volatilisation of manure and slurry is described using an empirical function of the ALFAM model (S\u00f8gaard et al., 2002). Another function to describe the dependency of gaseous N emmissions from soil pH was derived from data published by He et al. (1999). A Michaelis-Menten kinetic was fitted to their data, and the relation between pH and N volatilisation half-life was normalised to pH 7.0.</p> <p>Urea hydrolysis and the respective gaseous N losses after application of urea-based fertilisers are calculated using algorithms of the AMOVOL model (Sadeghi, 1988). It considers the temperature-dependent equilibrium between ammonium ions in solution and gaseous ammonia, as well as effects of soil organic matter content, soil temperature, and soil moisture content on hydrolysis. The atmospheric resistance finally governs the loss of gaseous ammonia from soil.</p>"},{"location":"model_science/soil_processes/organic_matter_turn-over/#references","title":"References","text":"<ul> <li> <p>Abrahamsen, P., Hansen, S., 2000. Daisy: an open soil-crop-atmosphere system model. Environ. Mod. Software 15, 313-330.</p> </li> <li> <p>Hansen, S., Jensen, H.E., Nielsen, N.E., Svendsen, H., 1991. Simulation of nitrogen dynamics and biomass production in winter-wheat using the Danish simulation-model DAISY. Fert. Res. 27 (2-3), 245-259.</p> </li> <li> <p>He, Z.L., Alva, A.K., Calvert, D.V., Banks, D.J., 1999. Ammonia volatilization from different fertilizer sources and effects of temperature and soil pH. Soil Sci. 164 (10), 750-758.</p> </li> <li> <p>Jensen, L.S., Salo, T., Palmason, F., Breland, T.A., Henriksen, T.M., Stenberg, B., Pedersen, A., Lundstr\u00f6m, C., Esala, M., 2005. Influence of biochemical quality on C and N mineralisation from a broad variety of plant materials in soil. Plant Soil 273, 307-326.</p> </li> <li> <p>Rahn, C.R., Zang, K., Lillywhite, R.D., Ramos, C., de Paz, J.M., Doltra, J., Riley, H., Fink, M., Nendel, C., Thorup-Kristensen, K., Pedersen, A., Piro, F., Venezia, A., Firth, C., Schmutz, U., Rayns, F., Strohmeyer, K., 2010. EU-Rotate_N - a European decision support system to predict environmental and economic consequences of the management of nitrogen fertiliser in crop rotations. Eur. J. Hort. Sci. 75 (1), 20-32.</p> </li> <li> <p>S\u00f8gaard, H.T., Sommer, S.G., Hutchings, N.J., Huijsmans, J.F.M., Bussink, D.W., Nicholson, F., 2002. Ammonia volatilization from field-applied animal slurry - the ALFAM model. Atmos. Environ. 36 (20), 3309-3319.</p> </li> </ul>"},{"location":"model_science/soil_processes/overview/","title":"Soil Processes","text":"<p>MONICA describes processes in the soil\u2013plant system and the energy and matter exchange with the hydro- and atmosphere. Using daily weather data, it calculates the soil temperature for single discrete layers in the soil. The movement of water in the soil is modelled using a capacity approach. This approach assumes that water that cannot be stored in a soil layer will be passed on to the adjacent layer below. The layer\u2019s storage capacity and its percolation rate are governed by its texture and soil organic matter content. Evaporation and water uptake by the root influence the water budget. If groundwater is accessible, capillary water can rise into the root zone.</p> <p>Moving soil water carries nitrates. They originate from organic matter turn-over, appearing first as ammonium (ammonification), which is later turned into nitrates (nitrification). If oxygen is deficient, nitrate can be transformed into atmospheric nitrogen (denitrification), a process during which the greenhouse gas N<sub>2</sub>O is produced. The microorganisms facilitating these processes and producing CO<sub>2</sub> from their metabolism are also simulated. When organic fertilisers are applied, gaseous NH<sub>3</sub> is set free. Furthermore, urea fertiliser also hydrolyses in the soil and releases NH<sub>3</sub>.</p>"},{"location":"model_science/soil_processes/snow/","title":"Snow","text":"<p>Snow layers are simulated following the idea of Riley and Bonesmo (2005). Below 1.8\u00b0C air temperature, an increasing fraction of snow is assumed in the falling rain, which adds to a snow layer.</p> \\[n_l = \\begin{cases}  1 &amp; T_a \\geq T_{as}  \\\\  \\frac{T_a - T_{ls}}{T_{as} - T_{ls}} &amp; T_{ls} &lt; T_a &lt; T_{as} \\\\ 0 &amp; T_a \\leq T_{ls}    \\end{cases}\\] <p>\\(n_l\\) Fraction of liquid precipitation \\([mm \\, mm^{-1}]\\) \\(T_a\\) Daily mean air temperature \\([^{\\circ} C]\\) \\(T_{ls}\\) Threshold temperature for liquid water in snow \\([^{\\circ} C]\\) \\(T_{as}\\) Threshold temperature for snow accumulation \\([^{\\circ} C]\\)</p> <p>The amounts of liquid and snow precipitation are derived from:</p> \\[N_l = n_l \\cdot k_l\\] <p>\\(N_l\\) Liquid precipitation \\([mm]\\) \\(n_l\\) Fraction of liquid precipitation \\([mm \\, mm^{-1}]\\) \\(k_l\\) Correction factor liquid precipitation \\([mm]\\)</p> <p>and</p> \\[N_s = (1-n_l) \\cdot k_s\\] <p>\\(N_s\\) Snow precipitation \\([mm]\\) \\(n_l\\) Fraction of liquid precipitation \\([mm \\, mm^{-1}]\\) \\(k_s\\) Correction factor snow precipitation \\([mm]\\)</p> <p>The snow layer density is calculated as follows:</p> \\[\\rho_{sn} = \\rho_{sn\\,min} + \\rho_{sn\\, max} \\cdot \\frac{T_a - T_{ls}}{T_{as} - T_{ls}}\\] <p>\\(\\rho_{sn}\\) Density of fresh snow \\([kg \\, dm^{-3}]\\) \\(\\rho_{sn \\, min}\\) Minimum density of fresh snow \\([kg \\, dm^{-3}]\\) \\(\\rho_{sn \\, max}\\) Maximum density of fresh snow \\([kg \\, dm^{-3}]\\) \\(T_a\\) Daily mean air temperature \\([^{\\circ} C]\\) \\(T_{ls}\\) Threshold temperature for liquid water in snow \\([^{\\circ} C]\\) \\(T_{as}\\) Threshold temperature for snow accumulation    \\([^{\\circ} C]\\)</p> <p>Snow starts thawing above 0.31 \u00b0C and increases its density:</p> \\[W_{sm} = \\begin{cases}  0 &amp; T_a &lt; T_{sm} \\\\ a_{sm} \\cdot ( T_a - T_{sm}) &amp; T_a \\geq T_{sm}      \\end{cases}\\] <p>\\(W_{sm}\\) Water from melting snow \\([mm]\\) \\(a_{sm}\\) Snow ageing (limited to 4.7) \\(T_a\\) Daily mean air temperature \\([^{\\circ} C]\\) \\(T_{sm}\\) Base temperature snow melt \\([^{\\circ} C]\\)</p> <p>where</p> \\[a_{sm} = 1.4 \\cdot \\frac{\\rho_s}{0.1}\\] <p>\\(a_{sm}\\) Snow ageing (limited to 4.7) \\([kg \\, dm^{-3}]\\) \\(\\rho_s\\) Snow density \\([kg \\, dm^{-3}]\\)</p> <p>Liquid water in the snow layer re-freezes below \u20131.7 \u00b0C:</p> \\[W_{sf} = 1.5 \\cdot (T_{sm} - T_a)^{0.36}\\] <p>\\(W_{sf}\\) Re-freezing water in the snow layer \\([mm]\\) \\(T_a\\) Daily mean air temperature \\([^{\\circ} C]\\) \\(T_{sm}\\) Base temperature snow melt \\([^{\\circ} C]\\)</p> <p>The water-holding capacity of snow is calculated within given boundaries as:</p> \\[C_s = \\frac{0.1 \\cdot C_{smax}}{\\rho_s}\\] <p>\\(C_s\\) Water-holding capacity of snow \\([mm]\\) \\(C_{smax}\\)  Maximum water-holding capacity of snow  \\([mm]\\) \\(\\rho_s\\) Snow density \\([kg \\, dm^{-3}]\\)</p> <p>From this, the amount of water held back in the snow layer can be calculated:</p> \\[W_{sr} = C_s \\cdot W_s\\] <p>\\(W_{sr}\\) Liquid water in the snow layer \\([mm]\\) \\(C_s\\) Water-holding capacity of snow \\([mm]\\) \\(W_s\\) Water equivalent in the snow layer \\([mm]\\)</p> <p>where</p> \\[W_s = W_f \\cdot W_l\\] <p>\\(W_s\\) Water equivalent in the snow layer \\([mm]\\) \\(W_f\\) Water equivalent of the frozen water \\([mm]\\) \\(W_l\\) Liquid water in the snow layer \\([mm]\\)</p> \\[W_f(t) = W_f(t-\\Delta t) + N_s - W_{sm} + W_{sf}\\] <p>\\(W_f(t)\\) Water equivalent frozen water at time \\(t\\) \\([mm]\\) \\(W_f(t-\\Delta t)\\) Water equivalent frozen water at preceding time step \\([mm]\\) \\(W_{sm}\\) Water from melting snow \\([mm]\\) \\(W_{sf}\\) Re-freezing water in the snow layer \\([mm]\\)</p> <p>and</p> \\[W_l(t) = W_l(t-\\Delta t) + N_l + W_{sm} - W_{sf}\\] <p>\\(W_l(t)\\) Liquid water in the snow layer at time \\(t\\) \\([mm]\\) \\(W_l(t-\\Delta t)\\) Liquid water in the snow layer at preceding time step \\([mm]\\) \\(W_{sm}\\) Water from melting snow \\([mm]\\) \\(W_{sf}\\) Re-freezing water in the snow layer \\([mm]\\)</p> <p>The amount of liquid water flowing from the snow layer onto the soil surface is calculated for the case \\(W_l\\) &gt; \\(W_{sr}\\) \\(W_l\\) &gt; \\(W_{sr}\\) as</p> \\[W_i = W_l - W_{sr}\\] <p>\\(W_i\\) Liquid water flowing from the snow layer \\([mm]\\) \\(W_l\\) Liquid water in the snow layer \\([mm]\\) \\(W_{sr}\\) Liquid water in the snow layer \\([mm]\\)</p> <p>Finally, snow height can be calculated as:</p> \\[S = \\frac{W_s \\cdot  \\rho_W}{\\rho_s}\\] <p>\\(S\\) Snow height \\([mm]\\) \\(W_s\\) Water equivalent of snow \\([mm]\\) \\(\\rho_W\\) Snow density \\([kg \\, dm^{-3}]\\) \\(\\rho_s\\) Density of water \\([kg \\, dm^{-3}]\\)</p>"},{"location":"model_science/soil_processes/soil_frost/","title":"Soil frost","text":"<p>Soil frost algorithms were taken from Olsen and Haugen (1997), who assumed that the same thermal properties apply across the whole soil profile. The temperatures simulated in the soil temperature module are not considered, because the phase transition between water and ice is not considered. Parameter values were taken from the SOIL model (Jansson, 1991). The frost module requires the soil surface temperature\u2014modified by a possible snow layer\u2014as an input. The ECOMAG model (Motovilov et al., 1999) delivered the approach to describe thawing.</p> <p>For the heat conductivity calculation of frozen soil, a fixed moisture content at field capacity is assumed. According to Hanson et al. (2004), this moisture content is corrected by:</p> \\[\\theta_{FCmf} = \\theta_{FCm} + (1 + \\theta_{FCm} \\cdot (13.05 \\cdot \\theta^{1.06}_{FCm}))\\] <p>\\(\\theta_{FCmf}\\) Fixed moisture content at field capacity (frozen) \\([m^3 \\, m^{-3}]\\) \\(\\theta_{FCm}\\) Fixed moisture content at field capacity \\([m^3 \\, m^{-3}]\\)</p> <p>The contribution of heat supply from the lower soil to latent heat is determined by:</p> \\[q_Q = \\frac{0.3 \\cdot d_F}{Q_I}\\] \\[Q_I = 335 \\cdot \\theta_{FCm}\\] <p>\\(q_Q\\) Fraction of heat flux from lower soil to latent heat  \\(Q_I\\) latent heat \\([MJ]\\) \\(d_F\\) Number of frost days \\([d]\\) \\(\\theta_{FCm}\\) Fixed moisture content at field capacity \\([m^3 \\, m^{-3}]\\)</p> <p>Frost depth is then derived from:</p> \\[z_F = \\sqrt{\\left( \\frac{q_Q}{2}  \\right )^2 + 2 \\cdot \\theta_{FCmf} \\ cdot \\frac{dd_n}{Q_I} - \\frac{q_Q}{2}  }\\] <p>\\(z_F\\) Frost depth \\([m]\\) \\(q_Q\\) Fraction of heat flux from lower soil to latent heat \\(\\theta_{FCmf}\\) Fixed moisture content at field capacity (frozen) \\(\\small [m^3 \\, m^{-3}]\\) \\(Q_I\\) latent heat \\([MJ]\\) \\(dd_n\\) Sum of negative degree days since begin of frost \\([^{\\circ} C \\, d]\\)</p> <p>In the case of soil frost, the daily progression of the thaw front into depth is calculated as:</p> \\[\\Delta z_T = \\begin{cases}  \\sqrt{\\frac{2 \\cdot \\lambda_h \\cdot | T_s | } {79000 \\cdot \\theta_{FC}}} &amp; T_s \\geq 0^{\\circ}C    \\\\ -  \\sqrt{\\frac{2 \\cdot \\lambda_h \\cdot | T_s | } {79000 \\cdot \\theta_{FC}}}  &amp; T_s &lt; 0^{\\circ}C  \\end{cases}\\] <p>\\(\\Delta z_T\\) Depth increment of the thaw front \\([m]\\) \\(\\lambda_h\\) Soil heat conductivity \\([J \\, m^{-1} \\, s^{-1} \\, K^{-1}]\\) \\(T_s\\) Temperature beneath the snow layer \\([^{\\circ} C]\\) \\(\\theta_{FC}\\) Fixed water content at field capacity \\([m^3 \\, m^{-3}]\\)</p> <p>where</p> \\[T_s = \\frac{T_a} {1+\\frac{(10 \\cdot S)}{z_F}}\\] <p>\\(T_s\\) Temperature beneath the snow layer \\([^{\\circ} C]\\) \\(S\\) Snow height \\([m]\\) \\(T_a\\) Daily mean air temperature \\([^{\\circ} C]\\) \\(z_F\\) Frost depth \\([m]\\)</p> <p>For the case of soil frost, it is assumed that no water moves in the frozen layers (\\(\\lambda=0\\)). Water from rainfall or melting snow infiltrates into soil until saturation is reached. The remainder is stored in the surface pond or adds to surface run-off. Once the soil has thawn\u2014i.e. the thaw front has reached the frost front (\\(z_T &gt; z_F\\))\u2014gravitational water can pass through the profile, and water from the surface pond can infiltrate. The variables \\(z_T\\), \\(z_F\\), \\(dd_n\\) and \\(d_F\\) are then re-set to zero.</p>"},{"location":"model_science/soil_processes/soil_frost/#references","title":"References","text":"<ul> <li> <p>Hansson, K., Simunek, J., Mizoguchi, M., Lundin, L.C., van Genuchten, M.T. (2004): Water flow and heat transport in frozen soil: Numerical solution and freeze-thaw applications. Vadose Zone Journal 3, 693-704.</p> </li> <li> <p>Jansson, P.E. (1991): The SOIL model - Users manual. 91-6. Swedish University of Agricultural Sciences, Uppsala.</p> </li> <li> <p>Motovilov, Y. G., Gottschalk, L., Engeland, K., Belokurov, A. (1999): ECOMAG: Regional model of hydrological cycle - Application to the NOPEX region.  1051. Dept. Geophysics, University of Oslo, Oslo, pp. -88.</p> </li> <li> <p>Olsen, P. A., Haugen, L. E. (1997): Jordas termiske egenskaper.  8. Dept. Soil and Water Science, Agricultural University of Norway, \u00c5s, pp. -14.</p> </li> </ul>"},{"location":"model_science/soil_processes/soil_moisture/","title":"Soil moisture","text":"<p>A capacity approach was used to describe soil water dynamics (Wegehenkel, 2000). The capacity parameters are derived from the soil texture and modified by soil organic matter content and bulk density. Water contents at saturation, field capacity, and permanent wilting point for different bulk densities and correction values for different soil organic matter classes (Ad-hoc-AG Boden, 2005) are provided by Wessolek et al. (2009) and stored in the database.</p> <p>If a crop is present, precipitation is partly intercepted and evaporates from the crop surface. Interception \\(I\\) is calculated as:</p> \\[I = (2.5 \\cdot h_c \\cdot \\beta) - S_i\\] <p>\\(I\\) Interception \\([mm]\\) \\(h_c\\) Crop height \\([m]\\) \\(\\beta\\) Canopy closure \\([m^2\\,m^{-2}]\\) \\(S_i\\) Interception storage \\([mm]\\)</p> <p>The remainder falls on the ground and is stored in a surface pond, from which water infiltrates into the soil. As long as the surface pond contains water, it is the only source of evaporation. The percolation of water volumes above field capacity is governed by an empirical, texture-dependent rate coefficient (\\(\\lambda\\)):</p> \\[\\lambda = 1.15 \\cdot f^2_s + 0.1 \\cdot f_c + 0.35 \\cdot f_u\\] <p>\\(\\lambda\\) Empirical percolation rate coefficient \\(f_s\\) Soil sand content \\([kg \\, kg^{-1}]\\) \\(f_c\\) Soil clay content \\([kg \\, kg^{-1}]\\) \\(f_u\\) Soil silt content \\([kg \\, kg^{-1}]\\)</p> <p>If the groundwater level is located within the simulated soil profile, constant groundwater discharge can be adjusted to allow for the rising and falling groundwater level, depending on the soil water balance. The capillary rise from groundwater is considered according to empirical ascent rates (Ad-hoc-AG Boden, 2005). The groundwater level oscillates between given maximum and minimum levels with a period of one year.</p> <p>Reference evapotranspiration \\(ET0\\) is calculated using the Penman-Monteith method, according to Allen et al. (1998). This method requires the diurnal minimum and maximum temperature, the water vapour pressure deficit, wind velocity, and total global radiation.</p> \\[ET_0 = \\frac{0.408 \\cdot \\Delta \\cdot (R_n - G) + \\gamma \\cdot \\frac{900}{T + 273} \\cdot u_2 \\cdot (e_s - e_a)} {\\Delta + \\gamma \\cdot (1 + \\frac{r_a}{r_s} )}\\] <p>\\(\\Delta\\) Slope of the vapour pressure curve \\([kPa \\, K^{-1}]\\) \\(R_n\\) Net radiation at the crop surface \\([MJ \\, m^{-2} \\, d^{-1}]\\) \\(G\\) Soil heat flux density \\([MJ \\, m^{-2} \\, d^{-1}]\\) \\(T\\) Mean daily air temperature at 2 m height \\([^{\\circ}C]\\) \\(u_2\\) Wind speed at 2 m height \\([m\\,s^{-1}]\\) \\(e_s\\) Saturation vapour pressure \\([kPa]\\) \\(e_a\\) Actual vapour pressure \\([kPa]\\) \\(\\gamma\\) Psychrometric constant \\([kPa\\, K^{-1}]\\) \\(r_s\\) Atmospheric resistance \\([s \\, m^{-1}]\\) \\(r_a\\) Surface resistance \\([s \\, m^{-1}]\\)</p> <p>where</p> \\[\\gamma = 6.65 \\cdot 10^{-4} \\cdot P\\] <p>\\(P\\) Atmospheric pressure \\([Pa]\\)</p> <p>The surface resistance for the reference evapotranspiration assumes a 12 cm cut grass crop and is calculated using:</p> \\[r_s = \\frac{r_1} {1.44}\\] <p>\\(r_1\\) Stomata resistance; 100 s m-1 \\([s \\, m^{-1}]\\)</p> <p>The surface resistance for the actual crop is calculated in the crop growth module.</p>"},{"location":"model_science/soil_processes/soil_temperature/","title":"Soil temperature","text":"<p>The model for soil temperature was taken from the 4C simulation model (Lasch et al., 2002). It uses an empirical function for the description of heat conductivity which was presented by Neusypina (1979).</p> \\[\\lambda_h = \\frac{3.0 \\cdot \\rho_B - 1.7}{1.0 + (11.5 - 5.0 \\cdot \\rho_B) \\cdot e^{ -50 \\cdot \\left( \\frac{\\theta}{\\rho_B} \\right) ^{1.5} } } \\cdot 418.4\\] <p>\\(\\lambda_h\\) Soil heat conductivity \\([J \\, m^{-1} \\, s^{-1} \\, K^{-1}]\\) \\(\\rho_B\\) Soil raw density \\([Mg \\, m^{-1}]\\) \\(\\theta\\) Soil moisture content \\([m^3 \\, m^{-3}]\\)</p> <p>Soil heat capacity is calculated according to Abrahamsen &amp; Hansen (2000):</p> \\[c_s = \\theta \\cdot \\rho_w \\cdot c_w + \\varepsilon \\cdot \\rho_a \\cdot c_a + o \\cdot \\rho_h \\cdot c_h + (1-\\theta - \\varepsilon - o) \\cdot \\rho_q \\cdot c_q\\] <p>\\(c_s\\) Specific soil heat capacity \\([J \\, m^{-3} \\, K^{-1}]\\) \\(c_w\\) Specific heat capacity of water \\([J \\, m^{-3} \\, K^{-1}]\\) \\(c_a\\) Specific heat capacity of air \\([J \\, m^{-3} \\, K^{-1}]\\) \\(c_h\\) Specific heat capacity of soil organic matter \\([J \\, m^{-3} \\, K^{-1}]\\) \\(c_q\\) Specific heat capacity of quarz \\([J \\, m^{-3} \\, K^{-1}]\\) \\(\\rho_w\\) Density of water \\([Mg \\, m^{-3}]\\) \\(\\rho_a\\) Density of air \\([Mg \\, m^{-3}]\\) \\(\\rho_h\\) Density of soil organic matter \\([Mg \\, m^{-3}]\\) \\(\\rho_q\\) Density of soil minerals \\([Mg \\, m^{-3}]\\) \\(\\theta\\) Volumetric soil moisture content \\([m^{3} \\, m^{-3}]\\) \\(\\varepsilon\\) Volumetric soil air content \\([m^{3} \\, m^{-3}]\\) \\(o\\) Volumetric soil organic matter content \\([m^{3} \\, m^{-3}]\\)</p> <p>The soil surface temperature is calculated using minimum and maximum air temperature and global radiation according to Williams (1984):</p> \\[T_s(t) = (1-\\alpha(t)) \\cdot (T_{min}(t) + ( T_{max}(t) - T_{min}(t) ) \\cdot \\sqrt{ 0.03 \\cdot R_g(t)}  ) + \\alpha(t) \\cdot T_s(t_\\Delta t)\\] <p>\\(T_s(t)\\) Soil surface temperature at time \\(t\\) \\([^{\\circ}C]\\) \\(T_{min}\\) Minimum air temperature in 2 m height \\([^{\\circ}C]\\) \\(T_{max}\\) Maximum air temperature in 2 m height \\([^{\\circ}C]\\) \\(R_g\\) Global radiation \\([MJ \\, m^{-2}]\\) \\(\\alpha(t)\\) Albedo at time \\(t\\) \\(T_s(t-\\Delta t)\\) Soil surface temperature at previous time step \\([^{\\circ}C]\\)</p> <p>The impact of global radiation \\(R_g\\) on soil surface temperature is limited to values above 8.33 MJ m\u20132 d\u20131.</p>"},{"location":"model_science/soil_processes/soil_temperature/#references","title":"References","text":"<ul> <li>Abrahamsen, P., Hansen, S., 2000. Daisy: an open soil-crop-atmosphere system</li> </ul>"},{"location":"references/publications/","title":"Publications","text":""},{"location":"references/publications/#2019","title":"2019","text":"<ul> <li> <p>Stella, T., I. Mouratiadou, T. Gaiser, M. Berg-Mohnicke, E. Wallor, F. Ewert and C. Nendel (2019): Estimating the contribution of crop residue management to soil organic carbon conservation. Environ. Res. Let., https://doi.org/10.1088/1748-9326/ab395c.  </p> </li> <li> <p>Hampf, A.C., T. Stella, M. Berg, T. Kawohl and C. Nendel (): Future yields of double-cropping systems in the Southern Amazon, Brazil, under climate change and technological development. Agr. Syst., under revision.</p> </li> <li> <p>Tao, F.L., T. Palosuo, R.P. R\u00f6tter, C.G. Hern\u00e1ndez D\u00edaz-Ambrona, M.I. M\u00ednguez, M.A. Semenov, K.C. Kersebaum, D. Cammarano, X. Specka, C. Nendel, A.K. Srivastava, F. Ewert, G. Padovan, R. Ferrise, P. Martre, L. Rodr\u00edguez, M. Ruiz-Ramos, T. Gaiser,  J.G. H\u00f6hn, T. Salo, M. Bindi, A.H. Schulman (): Why do crop models diverge substantially in climate impact projections? Agr. Forest Meteorol., under revision. </p> </li> <li> <p>Constantin, J., H. Raynal, E. Casellas, M. Bindi, E. Coucheney, R. Dechow, L. Doro, H. Eckersten, T. Gaiser, B. Grosz,  E. Haas, H. Hoffmann, K.C. Kersebaum, R. Kiese, S. Klatt, M. Kuhnert, E. Lewan, M. Moriondo, C. Nendel, G. Ram Maharjan, X. Specka, E. Teixeira,  G. Trombi, E. Wang, L. Weiherm\u00fcller, J. Yeluripati, Z. Zhao, F. Ewert, J.E. Bergez (2019): Management and scaling effects on water balance and yield at regional scale for crop models. Agr. Forest Meteorol. 275, 184-195. https://doi.org/10.1016/j.agrformet.2019.05.013. </p> </li> <li> <p>Kimball, B.A., K.J. Boote, J.L. Hatfield, L.R. Ahuja, C. Stockle, S. Archontoulis, C. Baron, B. Basso, P. Bertuzzi, J. Constantin, D. Deryng, B. Dumont, J.L. Durand, F. Ewert, T. Gaiser, S. Gayler, M. Hoffman, Q.J. Jiang, S.H. Kim, J. Lizaso, S. Moulin, C. Nendel, P.S. Parker, T. Palosuo, E. Priesack, Z.M. Qi, A. Srivastava, T. Stella, F.L. Tao, K. Thorp, D. Timlin, T.E. Twine, H. Webber, M. Willaume, K. Williams (2019): Simulation of maize evapotranspiration: an inter-comparison among 29 maize models. Agr. For. Meteorol. 271, 264\u2013284. https://doi.org/10.1016/j.agrformet.2019.02.037. </p> </li> <li> <p>Specka, X., R. Wieland and C. Nendel (2019): Temporal sensitivity analysis of the MONICA model: Application of two global approaches to analyze the dynamics of parameter sensitivity. Agriculture 9 (2), 37. https://doi.org/10.3390/agriculture9020037.  </p> </li> <li> <p>Liu, B., P. Martre, F. Ewert, J.R. Porter, A.J. Challinor, C. M\u00fcller, A.C. Ruane, K. Waha, P.K. Aggarwal, M. Ahmed, J. Balkovi\u010d, B. Basso, C. Biernath, M. Bindi, D. Cammarano, G. De Sanctis, B. Dumont, E. Eyshi Rezaei, E. Fereres, R. Ferrise, M. Garcia-Vila, S. Gayler, Y. Gao, H. Horan, G. Hoogenboom, R.C. Izaurralde, C.D. Jones, B.T. Kassie, K.C. Kersebaum, C. Klein, A.K. Koehler, A. Maiorano, S. Minoli, M. Montesino San Martin, S. Naresh Kumar, C. Nendel, G.J. O\u2019Leary, T. Palosuo, E. Priesack, D. Ripoche, R.P. R\u00f6tter, M.A. Semenov, C. St\u00f6ckle, T. Streck, I. Supit, F. Tao, P.J. Thorburn, M. Van der Velde, D. Wallach, E. Wang, H. Webber, J. Wolf, P. Woli, L. Xiao, Z. Zhang, Z. Zhao, Y. Zhu, and S. Asseng (2019): Global wheat production with 1.5 and 2.0\u00b0C above pre-industrial warming. Glob. Change Biol. 25, 1428\u20131444. https://doi.org/10.1111/gcb.14542. </p> </li> <li> <p>Maharjan, G.M., H. Hoffmann, H. Webber, A. Shrivastava, L. Weiherm\u00fcller, A.V. Solis, E. Coucheney, E. Lewan, G. Trombi, M. Moriando, M. Bindi B. Grosz, R. Dechow, M. Kuhnert, L. Doro, K.C. Kersebaum, T. Stella, X. Specka, C. Nendel, J. Constantin, F. Ewert, T. Gaiser (2019): Effects of input data aggregation on simulating crop yields in temperate and Mediterranean climates. Eur. J. Agron. 103, 32\u201346, https://doi.org/10.1016/j.eja.2018.11.001. </p> </li> <li> <p>Rodr\u00edguez, A., M. Ruiz-Ramos, T. Palosuo, T.R. Carter, S. Fronzek, I.J. Lorite, R. Ferrise, N. Pirttioja, M, Bindi, P. Baranowski, S. Buis, D. Cammarano, Y. Chen, B. Dumont, F. Ewert, T. Gaiser, P. Hlavinka, H. Hoffmann, J.G. H\u00f6hn, F. Jurecka, K.C. Kersebaum, J. Krzyszczak, M. Lana, A. Mechiche-Alami, J.Minet, M. Montesino, C. Nendel, J.R. Porter, F. Ruget, M.A. Semenov, Z. Steinmetz, P. Stratonovitch, I. Supit, F. Tao, M. Trnka, A. de Wit and R.P. R\u00f6tter (2019): Implications of crop model ensemble size and composition for estimates of adaptation effects and agreement of recommendations. Agr. Forest Meteorol. 264, 351\u2013362, https://doi.org/10.1016/j.agrformet.2018.09.018. </p> </li> <li> <p>Asseng, S., P. Martre, A. Maiorano, R.P. R\u00f6tter, G. O\u2019Leary, G. Fitzgerald, C. Girousse, R. Motzo, F. Giunta, M.A. Babar, M.P. Reynolds, A.M.S. Kheir, P.J. Thorburn, K. Waha, A.C. Ruane, P.K. Aggarwal, M. Ahmed, J. Balkovic, B. Basso, C. Biernath, M. Bindi, D. Cammarano, A.J. Challinor, G. De Sanctis, B. Dumont, E. Eyshi Rezaei, E. Fereres, R. Ferrise, M. Garcia-Vila, S. Gayler, Y. Gao, G. Hoogenboom, R.C. Izaurralde, M. Jabloun, C.D. Jones, B.T. Kassie, K.C. Kersebaum, C. Klein, A.K. Koehler, B. Liu, S. Minoli, M. Montesino San Martin, C. M\u00fcller, S. Naresh Kumar, C. Nendel,  J.E. Olesen, T. Palosuo, J.R. Porter, E. Priesack, D. Ripoche,  M.A. Semenov, C. St\u00f6ckle, P. Stratonovitch, T. Streck, I. Supit, F. Tao, M. Van der Velde,  D. Wallach, E. Wang, H. Webber, J. Wolf, P. Woli, L. Xiao, Z. Zhang, Y. Zhu and F. Ewert (2019): Climate change impact and adaptation for wheat protein. Glob. Change Biol. 25, 155\u2013173. https://doi.org/10.1111/gcb.14481. </p> </li> </ul>"},{"location":"references/publications/#2018","title":"2018","text":"<ul> <li> <p>Durand, J.L., K. Delusca, K., K. Boote, J.I. Lizaso, R. Manderscheid, H.J. Weigel, A. Ruane, C. Rosenzweig, J.W. Jones, L. Ahuja, S. Anapalli, C. Baron, B. Basso, P. Bertuzzi, C. Biernath, D. Deryng, F. Ewert, T. Gaiser, S. Gayler, F. Heinlein, K.C. Kersebaum, S.H. Kim, C. M\u00fcller, C. Nendel, A. Olioso, E. Priesack, J. Ramirez Villegas, D. Ripoche-Wachter, R.P. R\u00f6tter, S. Seidel, A. Srivastava, F.L. Tao, D. Timlin, T. Twine, E. Wang, H. Webber and Z. Zhao (2018). How accurately do maize crop models simulate the interactions of atmospheric CO2 concentration levels with limited water supply on water use and yield? Eur. J. Agron. 100, 67\u201375. https://doi.org/10.1016/j.eja.2017.01.002. </p> </li> <li> <p>Wallach, D., P. Martre, B. Liu, S. Asseng, F. Ewert, P.J. Thorburn, M. van Ittersum, P.K. Aggarwal, M. Ahmed, B. Basso, C. Biernath, D. Cammarano, A.J. Challinor, G. De Sanctis, B. Dumont, E. Eyshi Rezaei, E. Fereres, G.J.  Fitzgerald, Y. Gao, M. Garcia-Vila, S. Gayler, C. Girousse, G. Hoogenboom, H. Horan, R.C. Izaurralde, C.D. Jones, B.T. Kassie, K.C. Kersebaum, C. Klein, A.K. Koehler, A. Maiorano, S. Minoli, C. M\u00fcller, S. Naresh Kumar, C. Nendel, G.J. O\u2019Leary, T. Palosuo, E. Priesack, D. Ripoche, R.P. R\u00f6tter, M.A. Semenov, C.  St\u00f6ckle, P. Stratonovitch, T. Streck, I. Supit, F. Tao, J. Wolf and Z. Zhang (2018): Why and when do crop multi-model ensemble predictors work well? Glob. Change Biol. 24 (11), 5072-5083, https://doi.org/10.1111/gcb.14411. </p> </li> <li> <p>Webber, H., F. Ewert, J.E. Olesen, C. M\u00fcller, S. Fronzek, A. Ruane, M. Bourgault, P. Martre, B. Ababaei, M. Bindi, R. Ferrise, R. Finger, N. Fodor, C. Gabald\u00f3n-Leal, T. Gaiser, M. Jabloun, K.C. Kersebaum, J.I. Lizaso, I.J. Lorite, L. Manceau, M. Moriondo, C. Nendel, A. Rodr\u00edguez, M. Ruiz-Ramos, M.A. Semenov, S. Siebert, T. Stella, P. Stratonovitch, G. Trombi, D. Wallach (2018): Diverging importance of drought stress for maize and winter wheat in Europe. Nat. Comm. 9, 4249. https://doi.org/10.1038/s41467-018-06525-2. </p> </li> <li> <p>Basso, B., B. Dumont, B. Maestrini, I. Shcherbak, G.P. Robertson, J.R. Porter, P. Smith, K. Paustian, P.R. Grace, S. Asseng, S. Bassu, C. Biernath, K.J. Boote, D. Cammarano, G. de Sanctis, J.-L. Durand, F. Ewert, S. Gayler, R. Grant, D.W. Hyndman, J. Kent, P. Martre, C. Nendel, E. Priesack, D. Ripoche, A.C. Ruane, J. Sharp, P.J. Thorburn, J.L. Hatfield, J.W. Jones and C. Rosenzweig (2018): Soil organic carbon and nitrogen feedbacks on crop yields under climate change. Agr. Environ. Let. 3, 180026. https://doi.org/10.2134/ael2018.05.0026. </p> </li> <li> <p>Wallor, E., K.C. Kersebaum, D. Ventrella, D. Cammarano, E. Coucheney, R. Ferrise, T. Gaiser, P. Garofalo, L. Giglio, P. Giola, M. Hoffmann, I. Iocola, M. Lana, E. Lewan, G.R. Maharjan, M. Moriondo, L. Mula, C. Nendel, E. Pohankova, P.P. Roggero, M. Trnka, G. Trombi (2018): The response of process-based agro-ecosystem models to within-field variability in site conditions. Field Crop. Res. 228, 1\u201319. https://doi.org/10.1016/j.fcr.2018.08.021. </p> </li> <li> <p>Hampf, A.C., M.M.M. Carauta, E. Latynski, A.A.D. Libera, L.A. Monteiro, P.C. Sentelhas, C. Troost, T. Berger and C. Nendel (2018): The biophysical and socio-economic dimension of yield gaps in the Southern Amazon \u2013 a bio-economic modelling approach. Agr. Syst. 165, 1\u201313. https://doi.org/10.1016/j.agsy.2018.05.009. </p> </li> <li> <p>Battisti, R., P.C. Sentelhas, P.S. Parker, C. Nendel, G. C\u00e2mara, J. Farias, C. Basso (2018): Assessment of crop management strategies to improve soybean resilience to climate change in Southern Brazil. Crop Pasture Sci. 69 (2) 154-162. https://doi.org/10.1071/CP17293. </p> </li> <li> <p>Tao, F.L., R.P. R\u00f6tter, T. Palosuo, C.G.H. D\u00edaz-Ambrona, M.I. Minguez, M.A. Semenov, K.C. Kersebaum, C. Nendel, X. Specka, D. Cammarano, H. Hoffmann, F. Ewert, A. Dambreville, P. Martre, L. Rodr\u00edguez, M. Ruiz Ramos, T. Gaiser, J.G. H\u00f6hn, T. Salo, R. Ferrise, M. Bindi and A. Schulman (2018): Contribution of crop model structure, parameters and climate scenarios to uncertainties in climate change impact assessments. Glob. Change Biol. 24, 1291\u20131307. https://doi.org/10.1111/gcb.14019. </p> </li> <li> <p>Fronzek, S., N. Pirttioja, T.R. Carter, M. Bindi, H. Hoffmann, T. Palosuo, M. Ruiz Ramos, M. Trnka, M. Acutis, S. Asseng, P. Baranowski, B. Basso, P. Bodin, S. Buis, D. Cammarano, P. Deligios, L. Doro, B. Dumont, F. Ewert, R. Ferrise, M.F. Destain, T. Gaiser, P. Hlavinka, K.C. Kersebaum, C. Kollas, J. Krzyszczak, I. Lorite Torres, J. Minet, I. M\u00ednguez Tudela, M. Montesino, M. Moriondo, C. M\u00fcller, C. Nendel, I. \u00d6zt\u00fcrk, A. Perego, A. Rodr\u00edguez, F. Ruget, M. Sanna, M. Semenov, C. Slawinski, P. Stratonovitch, I. Supit, F. Tao, E. Wang, L.H. Wu and R.P. R\u00f6tter (2018): Classifying multi-model wheat yield impact response surfaces showing sensitivity to temperature and precipitation change. Agr. Syst. 159, 209\u2013224. https://doi.org/10.1016/j.agsy.2017.08.004. </p> </li> <li> <p>Ruiz-Ramos, M., R. Ferrise, A. Rodr\u00edguez, I.J. Lorite, M. Bindi, T.R. Carter, S. Fronzek, T. Palosuo, N. Pirttioja, P. Baranowski, S. Buis, D. Cammarano, Y. Chen, B. Dumont, F. Ewert, T. Gaiser, P. Havlinka, H. Hoffmann, J.G. H\u00f6hn, F. Jurecka, K.C. Kersebaum, J. Krzyszczak, M. Lana, A. Mechiche-Alami, J. Minet, M. Montesino, C. Nendel, J.R. Porter, F. Ruget, M.A. Semenov, Z. Steinmetz, P. Stratonovitch, I. Supit, F.L. Tao, M. Trnka, A. de Wit and R.P. R\u00f6tter (2018): Adaptation response surfaces for managing wheat under perturbed climate and CO2 in a Mediterranean environment, Agr. Syst. 159, 260\u2013274. https://doi.org/10.1016/j.agsy.2017.01.009. </p> </li> </ul>"},{"location":"references/publications/#2017","title":"2017","text":"<ul> <li> <p>Grosz, B., R. Dechow, S. Gebbert, H. Hoffmann, G. Zhao, J. Constantin, H. Raynal,  D. Wallach, C. Sosa, E. Lewan, H. Eckersten, X. Specka, K.C. Kersebaum, C. Nendel, M. Kuhnert, J. Yeluripati, R. Kiese, E. Haas, S. Klatt, E. Teixeira, M. Bindi, G. Trombi, M. Moriondo, L. Doro, P.P. Roggero, Z.G. Zhao, E. Wang, E. Vanuytrecht, F.L. Tao, R.P. R\u00f6tter, D. Cammarano, S. Asseng, L. Weiherm\u00fcller, S. Siebert, T. Gaiser and F. Ewert (2017): The implication of input data aggregation on upscaling of soil organic carbon changes. Env. Mod. Softw. 96, 361-377. https://doi.org/10.1016/j.envsoft.2017.06.046. </p> </li> <li> <p>Battisti, R., P.S. Parker, P.C. Sentelhas and C. Nendel (2017): Gauging the uncertainty sources for soybean yield simulations using the MONICA model. Agr. Syst. 155, 9\u201318. https://doi.org/10.1016/j.agsy.2017.04.004. </p> </li> <li> <p>Wang, E., P. Martre, Z. Zhao, F. Ewert, A. Maiorano, R.P. R\u00f6tter, B.A. Kimball, M.J. Ottman, G.W. Wall, J.W. White, M.P. Reynolds, P.D. Alderman, P.K. Aggarwal, J. Anothai, B. Basso, C. Biernath, D. Cammarano, A.J. Challinor, G. de Sanctis, J. Doltra, E. Fereres, M. Garcia-Vila, S. Gayler, G. Hoogenboom, L.A. Hunt, R.C. Izaurralde, M. Jabloun, C.D. Jones, K.C. Kersebaum, A.K. Koehler, C. M\u00fcller,  L.L. Liu, S. Naresh Kumar, C. Nendel, G. O\u2019Leary, J.E. Olesen, T. Palosuo, E. Priesack, E. Eyshi Rezaei, D. Ripoche, A.C. Ruane, M.A. Semenov, I. Shcherbak, C.O. St\u00f6ckle, P. Stratonovitch, T. Streck, I. Supit, F.L. Tao, P. Thorburn, K. Waha, D. Wallach, Z.M. Wang, J. Wolf, Y. Zhu und S. Asseng (2017): The uncertainty of crop yield projections is reduced by improved temperature response functions. Nat. Plants 3, 17102. https://doi.org/10.1038/nplants.2017.102. </p> </li> <li> <p>Yin, X.G. K.C. Kersebaum, C. Kollas, K. Manevski, S. Baby, N. Beaudoin, I. \u00d6zturk, T. Gaiser, L.H. Wu, M. Hoffmann, M. Charfeddine, T. Conradt, J. Constantin, F. Ewert, I. Garcia de Cortazar-Atauri, L. Giglio, P. Hlavinka, H. Hoffmann, M. Launay, G. Louarn, R. Manderscheid, B. Mary, W. Mirschel, C. Nendel, A. Pacholski, T. Palosuo, D. Ripoche-Wachter, R.P. R\u00f6tter, F. Ruget, B. Sharif, M. Trnka, D. Ventrella, H.J. Weigel and J.E. Olesen (2017): Performance of process-based models for simulation of grain N in crop rotations across Europe. Agr. Syst. 154, 63-77.</p> </li> <li> <p>Yin, X.G. K.C. Kersebaum, C. Kollas, S. Baby, N. Beaudoin, K. Manevski, T. Palosuo, C. Nendel, L.H. Wu, M. Hoffmann, H. Hoffmann, B. Sharif, C.M. Armas-Herrera, M. Bindi, M. Charfeddine, T. Conradt, J. Constantin, F. Ewert, R. Ferrise, T. Gaiser, I. Garcia de Cortazar-Atauri, L. Giglio, P. Hlavinka, M. Lana, M. Launay, G. Louarn, R. Manderscheid, B. Mary, W. Mirschel, M. Moriondo, I. \u00d6zt\u00fcrk, A. Pacholski, D. Ripoche-Wachter, R.P. R\u00f6tter, F. Ruget, M. Trnka, D. Ventrella, H.J. Weigel und J.E. Olesen (2017): Multi-model uncertainty analysis in predicting grain N for crop rotations in Europe. Eur. J. Agron. 84, 152\u2013165.</p> </li> <li> <p>Tao, F.L., R.P. R\u00f6tter, T. Palosuo, C.G. Hern\u00e1ndez, M.I. Minguez, M. Semenov, K.C. Kersebaum, C. Nendel, D. Cammarano, H. Hoffmann, F. Ewert, A. Dambreville, P. Martre, L. Rodr\u00edguez, M. Ruiz Ramos, T. Gaiser, J.G. H\u00f6hn, T. Salo, R. Ferrise, M. Bindi and A. Schulman (2017). Designing future barley cultivar ideotypes using multiple crop model ensembles. Eur. J. Agron. 82, 144\u2013162.</p> </li> <li> <p>Fleisher, D.H., B. Condori, R. Quiroz, A. Alva, S. Asseng, C. Barreda, M. Bindi, R. Ferrise, L. Franke, P.M. Govindakrishnan, D. Harahagazwe, G. Hoogenboom, S. Naresh Kumar, P. Merante, C. Nendel, J.E. Olesen, P.S. Parker, D. Raes, R. Raymundo, A. Ruane, C. St\u00f6ckle, I. Supit, E. Vanuytrecht, J. Wolf, P. Woli, and K.J. Boote (2017): Potato model uncertainty across common datasets and varying climate, Glob. Change Biol. 23 (3), 1258\u20131281.</p> </li> <li> <p>Kuhnert, M., J. Yeluripati, P. Smith, H. Hoffmann, M. van Oijen, J. Constantin, C. Sosa, R. Dechow, H. Eckersten, T. Gaiser, B. Grosz, E. Haas, K.C. Kersebaum, R. Kiese, S. Klatt, E. Lewan, C. Nendel, H. Raynal, X. Specka, E. Teixeira, E. Wang, L. Weiherm\u00fcller, G. Zhao, Z. Zhao and F. Ewert (2017): Impact analysis of climate data aggregation at different scales on simulated Net Primary Productivity for croplands. Eur. J. Agron. 88, 41-52.</p> </li> </ul>"},{"location":"references/publications/#2016","title":"2016","text":"<ul> <li> <p>Liu, B., S. Asseng, C. M\u00fcller, F. Ewert, J. Elliott, D.B. Lobell, P. Martre, A.C. Ruane, D. Wallach, J.W. Jones, C. Rosenzweig, P.K. Aggarwal, P.D. Alderman, J. Anothai, B. Basso, C. Biernath, D. Cammarano, A. Challinor, D. Deryng, G. De Sanctis, J. Doltra, E. Fereres, C. Folberth, M. Garcia-Vila, S. Gayler, G. Hoogenboom, L.A. Hunt, R.C. Izaurralde, M. Jabloun, C.D. Jones, K.C. Kersebaum, B.A. Kimball, A.K. Koehler, S. Naresh Kumar, C. Nendel, G. O\u2019Leary, J.E. Olesen, M.J. Ottman, T. Palosuo, P.V.V. Prasad, E. Priesack, T.A.M. Pugh, M. Reynolds, E. Eyshi Rezaei, R.P. R\u00f6tter, E. Schmid, M.A. Semenov, I. Shcherbak, E. Stehfest, C.O. St\u00f6ckle, P. Stratonovitch, T. Streck, I. Supit, F.L. Tao, P. Thorburn, K. Waha, G.W. Wall, E. Wang, J.W. White, J. Wolf, Z. Zhao and Y. Zhu (2016): Similar estimates of temperature impacts on global wheat yield by three independent methods. Nat. Clim. Change 6, 1130\u20131136.</p> </li> <li> <p>Baum, T.G., C. Nendel, S. Jacomet, M. Colobran and R. Ebersbach (2016): \u201cSlash and burn\u201d or \u201cweed and manure\u201d? A modelling approach to explore hypotheses of late Neolithic crop cultivation in pre-alpine wetland sites. Veg. Hist. Archaeobot. 25 (6), 611\u2013627.</p> </li> <li> <p>Cammarano, D., R.P. R\u00f6tter, S. Asseng, F. Ewert, D. Wallach, P. Martre, J.L. Hatfield, J.W. Jones, C. Rosenzweig, A.C. Ruane, K.J. Boote, P. Thorburn, K.C. Kersebaum, P.K. Aggarwal, C. Angulo, B. Basso, P. Bertuzzi, C. Biernath, N. Brisson, A. J. Challinor, J. Doltra, S. Gayler, R. Goldberg, L. Heng, J.E. Hooker, L.A. Hunt, J. Ingwersen, R.C. Izaurralde, C. M\u00fcller, S. Naresh Kumar, C. Nendel, G. O\u2019Leary, J.E. Olesen, T.M. Osborne, T. Palosuo, E. Priesack, D. Ripoche, M.A. Semenov, I. Shcherbak, P. Steduto, C.O. St\u00f6ckle, P. Stratonovitch, T. Streck, I. Supit, F.L. Tao, M. Travasso, K. Waha, J.W. White and J. Wolf (2016): Uncertainty of wheat water use: simulated patterns and sensitivity to temperature and CO2. Field Crop. Res. 198, 80\u201392.</p> </li> <li> <p>Ruane, A.C., N.I. Hudson, S. Asseng, D. Cammarano, F. Ewert, P. Martre, K.J. Boote, P. Thorburn, P.K. Aggarwal, C. Angulo, B. Basso, P. Bertuzzi, C. Biernath, N. Brisson, A. J. Challinor, J. Doltra, S. Gayler, R. Goldberg, R.F. Grant, L. Heng, J.E. Hooker, L.A. Hunt, J. Ingwersen, R.C. Izaurralde, K.C. Kersebaum, S. Naresh Kumar, C. M\u00fcller, C. Nendel, G. O\u2019Leary, J.E. Olesen, T.M. Osborne, T. Palosuo, E. Priesack, D. Ripoche, R.P. R\u00f6tter, M.A. Semenov, I. Shcherbak, P. Steduto, C.O. St\u00f6ckle, P. Stratonovitch, T. Streck, I. Supit, F.L. Tao, M. Travasso, K. Waha, D. Wallach,  J.W. White and J. Wolf (2016): Multi-wheat model ensemble responses to interannual climatic variability, Env. Mod. Softw. 81, 86\u2013101.</p> </li> <li> <p>Hoffmann, H., G. Zhao, S. Asseng, M. Bindi, C. Biernath, J. Constantin, E. Coucheney, R. Dechow, L. Doro, H. Eckersten, T. Gaiser, B. Grosz, F. Heinlein, B. Kassie, K.C. Kersebaum, C. Klein, M. Kuhnert, E. Lewan, M. Moriondo, C. Nendel, E. Priesack, H. Raynal, P.P. Roggero, R.P. R\u00f6tter, S. Siebert,  X. Specka, F.L. Tao, E. Teixeira, G. Trombi, D. Wallach, L. Weiherm\u00fcller, J. Yeluripati and F. Ewert (2016): Impact of spatial soil and climate input data aggregation on regional yield simulations. PLoS ONE 11(4), e0151782. </p> </li> <li> <p>Zhao, G., H. Hoffmann, J. Yeluripati, X. Specka, C. Nendel, C. Sosa, F.L. Tao, J. Constantin, H. Raynal, E. Teixeira, B. Grosz, L. Doro, R. Kiese, H. Eckersten, E. Haas, E. Vanuytrecht, D. Cammarano, M. Moriondo, G. Trombi, M. Kuhnert, M. Bindi, E. Lewan, K.C. Kersebaum, R.P. R\u00f6tter, P.P. Roggero, D. Wallach, S. Asseng, S. Siebert, T. Gaiser and F. Ewert (2016): Evaluation of the accuracy of eight spatial sampling schemes in selecting simulation sites for regional crop yield modelling. Env. Mod. Softw. 80:100-112.</p> </li> <li> <p>van Bussel, L.G.J., F. Ewert, G. Zhao, H. Hoffmann, D. Wallach, J. Constantin, H. Raynal, C. Klein, C. Biernath, F. Heinlein, F.L. Tao, R.P. R\u00f6tter, D. Cammarano, S. Asseng, J. Elliott, M. Glotter, C. Nendel, K.C. Kersebaum, X. Specka, B. Basso, G.A. Baigorria and C.C. Romero (2016): Spatial sampling of weather data for regional crop yield simulations. Agr. Forest Meteorol. 220, 101\u2013115.</p> </li> <li> <p>Salo, T., T. Palosuo, K.C. Kersebaum, C. Nendel, C. Angulo, M. Bindi, F. Ewert, R. Ferrise, P. Hlavinka, M. Moriondo, J. E. Olesen, R. Patil, F. Ruget, J. Tak\u00e1\u010d, M. Trnka and R.P. R\u00f6tter (2016): Comparing the performance of eleven agro-ecosystem models in predicting crop yield response to nitrogen under Finnish weather conditions. J. Agric. Sci. 154 (7), 1218-1240.</p> </li> <li> <p>Specka, X., C. Nendel, U. Hagemann, M. Pohl, M. Hoffmann, D. Barkusky, J. Augustin, M. Sommer, and K. van Oost (2016): Reproducing CO2 exchange rates of a crop rotation at contrasting terrain positions using two different modelling approaches. Soil Till. Res. 156, 219\u2013229. https://doi.org/10.1016/j.still.2015.05.007. </p> </li> <li> <p>Nendel, C. (2016): Simulating temperature impacts on crop production using MONICA. In: M\u00fcller, L., A.K.Sheudshen, F. Eulenstein (Eds.): Novel Methods for Monitoring and Managing Land and Water Resources in Siberia, 503\u2013518. Springer Water 2016, ISBN 978-3-319-24407-5.</p> </li> </ul>"},{"location":"references/publications/#2015","title":"2015","text":"<ul> <li> <p>Makowski, D., S. Asseng, F. Ewert, S. Bassu, J.L. Durand, T. Li, P. Martre, M. Adam, P.K. Aggarwal, C. Angulo, C. Baron, B. Basso, P. Bertuzzi, C. Biernath, H. Boogaard, K.J. Boote, B. Bouman, S. Bregaglio, N. Brisson, S. Buis, D. Cammarano, A.J. Challinor, J.G. R. Confalonieri, Conijn, M. Corbeels, D. Deryng, G. De Sanctis, J. Doltra, T. Fumoto, D. Gaydon, S. Gayler, R. Goldberg, R. Grant, P. Grassini, J.L. Hatfield, T. Hasegawa, L. Heng, S. Hoek, J. Hooker, L.A. Hunt, J. Ingwersen, R.C. Izaurralde, R.E.E. Jongschaap, J.W. Jones, R.A. Kemanian, K.C. Kersebaum, S.-H. Kim, J. Lizaso, M. Marcaida III, C. M\u00fcller, H. Nakagawa, S. Naresh Kumar, C. Nendel, G.J. O\u2019Leary, J.E. Olesen, P. Oriol, T. M. Osborne, T. Palosuo, M.V. Pravia, E. Priesack, D. Ripoche, C. Rosenzweig, A.C. Ruane, F. Ruget, F. Sau, M.A. Semenov, I. Shcherbak, B. Singh, U. Singh, H.K Soo, P. Steduto, C. St\u00f6ckle, P. Stratonovitch, T. Streck, I. Supit, L. Tang, F. Tao, E.I. Teixeira, P. Thorburn, D. Timlin, M. Travasso, R.P. R\u00f6tter, K. Waha, D. Wallach, J.W. White, P. Wilkens, J.R. Williams, J. Wolf , X. Yin, H. Yoshida, Z. Zhang and Y. Zhu (2015): A statistical analysis of three ensembles of crop model responses to climate change factors. Agr. Forest Meteorol. 214/215, 483\u2013493.</p> </li> <li> <p>Pirttioja, N., S. Fronzek, M. Bindi, T.R. Carter, H. Hoffmann, T. Palosuo, M. Ruiz Ramos, M. Trnka, M. Acutis, S. Asseng, P. Baranowski, B. Basso, P. Bodin, S. Buis, D. Cammarano, P. Deligios, L. Doro, B. Dumont, F. Ewert, R. Ferrise, M.F. Destain, T. Gaiser, P. Hlavinka, K.C. Kersebaum, C. Kollas, J. Krzyszczak, I. Lorite Torres, J. Minet, I. M\u00ednguez Tudela, M. Montesino, M. Moriondo, C. M\u00fcller, C. Nendel, I. \u00d6zt\u00fcrk, A. Perego, A. Rodr\u00edguez, F. Ruget, M. Sanna, M. Semenov, C. Slawinski, P. Stratonovitch, I. Supit, F. Tao, E. Wang, L.H. Wu and R.P. R\u00f6tter (2015): Temperature and precipitation effects on wheat yield across a European transect: a crop model ensemble analysis using impact response surfaces. Clim. Res., 65, 87\u2013105.</p> </li> <li> <p>Hoffmann, H., G. Zhao , L.G.J. van Bussel, A. Enders, X. Specka, C. Sosa, J. Yeluripati, F. Tao, J. Constantin, H. Raynal, E. Teixeira, B. Grosz, R. Dechow, L. Doro, Z. Zhao, E. Wang, C. Nendel, K.C. Kersebaum, E. Haas, R. Kiese, S. Klatt, H. Eckersten, E. Vanuytrecht, M. Kuhnert, E. Lewan, M. Bach, R.P. R\u00f6tter, P.P. Roggero, D. Wallach, D. Cammarano, S. Asseng, G. Krauss, S. Siebert, T. Gaiser and F. Ewert (2015): Variability of spatial aggregation effects of climate data on regional yield simulation by crop models for a selected region in Germany. Clim. Res. 65, 53\u201369.</p> </li> <li> <p>Zhao, G., H. Hoffmann, L.G.J van Bussel, A. Enders, X. Specka, C. Sosa, J. Yeluripati, F.L. Tao, J. Constantin, E. Teixeira, B. Grosz, L. Doro, Z. Zhao, C. Nendel, R. Kiese, H. Raynal, H. Eckersten, E. Haas, E. Wang, M. Kuhnert, G. Trombi, M. Bindi, M. Moriondo, E. Lewan, M. Bach, K.C. Kersebaum, R.P. R\u00f6tter, P.P. Roggero, D. Wallach, G. Krauss, S. Siebert, T. Gaiser, F. Ewert (2015): Effect of weather data aggregation on regional crop simulation for different crops, production conditions and response variables. Clim. Res. 65, 141\u2013157.</p> </li> <li> <p>Specka, X., C. Nendel and R. Wieland (2015): Analysing the parameter sensitivity of the agro-ecosystem model MONICA for different crops. Eur. J. Agron. 71, 73\u201387.</p> </li> <li> <p>Kollas, C., K.C. Kersebaum, C. Nendel, K. Manevski, C. M\u00fcller, T. Palosuo, C.M. Armas-Herrera, N. Beaudoin, M. Bindi, M. Charfeddine, T. Conradt, J. Constantin, J. Eitzinger, F. Ewert, R. Ferrise, T. Gaiser, I. Garcia de Cortazar-Atauri, L. Giglio, P. Hlavinka, H. Hoffmann, M.P. Hoffmann, M. Launay, R. Manderscheid, B. Mary, W. Mirschel, M. Moriondo, J. Olesen, I. \u00d6zt\u00fcrk, A. Pacholsky, D. Ripoche-Wachter, P.P. Roggero, S. Roncossek, R.P. R\u00f6tter, F. Ruget, B. Sharif, J. Tak\u00e1\u010d, M. Trnka, D. Ventrella, K. Waha, M. Wegehenkel, H.J. Weigel and L.H. Wu (2015): Crop rotation modelling \u2013 a European model intercomparison. Eur. J. Agron. 70, 98\u00ac\u2013111.</p> </li> <li> <p>Asseng, S., F. Ewert, P. Martre, R.P. R\u00f6tter, D.B. Lobell, D. Cammarano, B.A. Kimball, M.J. Ottman, G.W. Wall, J.W. White, M.P. Reynolds, P.D. Alderman, P.V.V. Prasad, P.K. Aggarwal, J. Anothai, B. Basso, C. Biernath, A. Challinor, G. De Sanctis, J. Doltra, E. Fereres, M. Garcia-Vila, S. Gayler, G. Hoogenboom, T. Hunt, C. Izaurralde, M. Jabloun, C.D. Jones, K.C. Kersebaum, A.-K. Koehler, C. M\u00fcller, S. Naresh Kumar, C. Nendel, G. O\u2019Leary, J.E. Olesen, T. Palosuo, E. Priesack, E. Eyshi Rezaei, A.C. Ruane, M. Semenov, I. Shcherbak, P. Steduto, C. St\u00f6ckle, P. Stratonovitch, T. Streck, I. Supit, F. Tao, P. Thorburn, K. Waha, E. Wang, D. Wallach, J. Wolf, Z. Zhao and Y. Zhu (2015): Rising heat reduces global wheat production. Nature Clim. Change 5 (2), 143\u2013147.</p> </li> <li> <p>Gutzler, C., K. Helming, D. Balla, R. Dannowski, D. Deumlich, M. Glemnitz, A. Knierim, W. Mirschel, C. Nendel, C. Paul, S. Sieber, U. Stachow, A. Starick, R. Wieland, A. Wurbs and P. Zander (2015): Agricultural land use changes \u2013 a scenario-based sustainability impact assessment for Brandenburg, Germany. Ecol. Indic. 48, 505\u2013517.</p> </li> <li> <p>Martre, P., D. Wallach, S. Asseng, F. Ewert, C. Rosenzweig, J.W. Jones, J.L. Hatfield, A.C. Ruane, K.J. Boote, P.J. Thorburn, R.P. R\u00f6tter, D. Cammarano, P.K. Aggarwal, C. Angulo, B. Basso, P. Bertuzzi, C. Biernath, N. Brisson, A.J. Challinor, J. Doltra, S. Gayler, R. Goldberg, R. Grant, L. Heng, J. Hooker, L.A. Hunt, J. Ingwersen, R.C. Izaurralde, K.C. Kersebaum, C. M\u00fcller, S. Naresh Kumar, C. Nendel, G. O\u2019Leary, J.E. Olesen, T.M. Osborne, T. Palosuo, E. Priesack, D. Ripoche, M.A. Semenov, I. Shcherbak, P. Steduto, C.O. St\u00f6ckle, P. Stratonovitch, T. Streck, I. Supit, F. Tao, M. Travasso, K. Waha, J.W. White and J. Wolf (2015): Multimodel ensembles of wheat growth: Many models are better than one. Glob. Change Biol. 21 (2), 911\u2013925.</p> </li> </ul>"},{"location":"references/publications/#2014","title":"2014","text":"<ul> <li> <p>Bassu, S., N. Brisson, J.L. Durand, K.J. Boote, J. Lizaso, J.W. Jones, C. Rosenzweig, A.C. Ruane, M. Adam, C. Baron, B. Basso, C. Biernath, H. Boogard, S. Conijn, M. Corbeels, D. Deryng, G. de Sanctis, S. Gayler, P. Grassini, J.L. Hatfield, S.B. Hoek, C. Izaurralde, R. Jongschaap, A.R. Kemanian, K.C. Kersebaum, S. Naresh Kumar, D. Makowski, C. M\u00fcller, C. Nendel, E. Priesack, M.V. Pravia, S.H. Kim,  F. Sau, I. Shcherbak, F.L. Tao, E. Teixeira, D. Timlin and K. Waha (2014): How do various maize crop models vary in their responses to climate change factors? Glob. Change Biol. 20 (7), 2301\u20132320.</p> </li> <li> <p>M\u00fcnch, T., M. Berg, W. Mirschel, R. Wieland and C. Nendel (2014): Considering cost accountancy items in crop production simulations under climate change. Eur. J. Agron. 52, 57\u201368.</p> </li> <li> <p>Nendel, C., K.C. Kersebaum, W. Mirschel and K.O. Wenkel (2014):  Testing farm management options as a climate change adaptation strategy using the MONICA model. Eur. J. Agron. 52, 47\u201356.</p> </li> </ul>"},{"location":"references/publications/#2013","title":"2013","text":"<ul> <li> <p>Asseng, S., F. Ewert, C. Rosenzweig, J.W. Jones, J.L. Hatfield, A. Ruane, K.J. Boote, P. Thorburn, R.P. R\u00f6tter, D. Cammarano, N. Brisson, B. Basso, P. Martre, P.K. Aggarwal, C. Angulo, P. Bertuzzi, C. Biernath, A. Challinor, J. Doltra, S. Gayler, R. Goldberg, R. Grant, L. Heng, J. Hooker, T. Hunt, J. Ingwersen, C. Izaurralde, K.C. Kersebaum, C. M\u00fcller, S. Naresh Kumar, C. Nendel, G. O\u2019Leary, J.E. Olesen, T.M. Osborne, T. Palosuo, E. Priesack, D. Ripoche, M. Semenov, I. Shcherbak, P. Steduto, C. St\u00f6ckle, P. Stratonovitch, T. Streck, I. Supit, F. Tao, M. Travasso, K. Waha, D. Wallach, J. White, J.R. Williams and J. Wolf (2013): Quantifying uncertainties in simulating wheat yields under climate change. Nature Climate Change 3, 827\u2013832</p> </li> <li> <p>Nendel, C., R. Wieland, W. Mirschel, X. Specka und K.C. Kersebaum (2013): Simulating winter wheat yields using input data of different spatial resolution. Field Crop. Res. 145, 67\u201377.</p> </li> <li> <p>Nendel, C., K.C. Kersebaum, W. Mirschel und K.O. Wenkel (2013):  Testing farm management options as a climate change adaptation strategy using the MONICA model. Eur. J. Agron., http://dx.doi.org/10.1016/j.eja.2012.09.005.</p> </li> <li> <p>M\u00fcnch, T., M. Berg, W. Mirschel, R. Wieland und C. Nendel (2013): Considering cost accountancy items in crop production simulations under climate change. Eur. J. Agron., http://dx.doi.org/10.1016/j.eja.2013.01.005.</p> </li> <li> <p>Wenkel, K.O., M. Berg, W. Mirschel, R. Wieland, C. Nendel and B. K\u00f6stner (2013): LandCaRe DSS \u2013An interactive decision support system for climate change impact assessment and the analysis of potential agricultural land use adaptation strategies. J. Environ. Manage. 127, 168\u2013183.</p> </li> <li> <p>R\u00f6tter, R.P., F. Ewert, T. Palosuo, M. Bindi, K.C. Kersebaum, J.E. Olesen, M. Trnka, M.K. van Ittersum, S. Janssen, M. Rivington, M. Semenov, D. Wallach, J.R. Porter, D. Stewart, J. Verhagen, C. Angulo, T. Gaiser, C. Nendel, P. Martre und A. de Wit (2013): Challenges for agro-ecosystem modelling in climate change risk assessment for major European crops and farming systems. Beitr\u00e4ge zur Impacts World 2013 Konferenz, Potsdam, 27\u201330 Mai 2013.</p> </li> <li> <p>Cammarano, D., R. P. R\u00f6tter, S. Asseng, F. Ewert, C. Rosenzweig, J.W. Jones, J.L. Hatfield, A. Ruane, K.J. Boote, P. Thorburn, N. Brisson, B. Basso, P. Martre, D. Ripoche, P. Bertuzzi, P. Steduto, L. Heng, M.A. Semenov, P. Stratonovitch, C. Stockle, G. O\u2019Leary, P.K. Aggarwal, S. Naresh Kumar, C. Izaurralde, J.W. White, L.A. Hunt, R. Grant, K.C. Kersebaum, T. Palosuo, J. Hooker, T. Osborne, J. Wolf, I. Supit, J.E. Olesen, J. Doltra, C. Nendel, S. Gayler, J. Ingwersen, E. Priesack, T. Streck, F. Tao, C. M\u00fcller, K. Waha, R. Goldberg, C. Angulo, I. Shcherbak, C. Biernath, D. Wallach, M. Travasso und A. Challinor (2012): Quantifying and reporting uncertainties in estimating future crop evapotranspiration: an assessment based on 27 crop models. Beitr\u00e4ge zur Impacts World 2013 Konferenz, Potsdam, 27\u201330 Mai 2013.</p> </li> <li> <p>Nendel, C., R. Wieland, W. Mirschel, X. Specka und K.C. Kersebaum (2013): Die Simulation von Winterweizenertr\u00e4gen in Th\u00fcringen unter Verwendung von meteorologischen Daten unterschiedlicher r\u00e4umlicher Aufl\u00f6sung. In: M. Clasen, K.C. Kersebaum, A. Meyer-Aurich, L. Theuvsen (eds.): Massendatenmanagement in der Agar- und Ern\u00e4hrungswirtschaft. Lecture Notes in Informatics 211, 235\u2212238.</p> </li> </ul>"},{"location":"references/publications/#2012","title":"2012","text":"<ul> <li> <p>R\u00f6tter, R., K.C. Kersebaum, T. Palosuo, P. Hlavinka, T. Klein, C. Nendel, F. Ruget, J. Tak\u00e1\u010d und M. Trnka: Simulation of spring barley yield in different climatic zones of Northern and Central Europe \u2013 A comparison of nine crop models. Field Crops Res. 133, 23 \u2013 36.</p> </li> <li> <p>Cammarano, D., S. Asseng, F. Ewert, C. Rosenzweig, J.W. Jones, J.L. Hatfield, A. Ruane, K.J. Boote, P. Thorburn, R.P. R\u00f6tter, N. Brisson, B. Basso, P. Martre, D. Ripoche, P. Bertuzzi, P. Steduto, L. Heng, M.A. Semenov, P. Stratonovitch, C. Stockle, G. O\u2019Leary, P.K. Aggarwal, S. Naresh Kumar, C. Izaurralde, J.W. White, L.A. Hunt, R. Grant, K.C. Kersebaum, T. Palosuo, J. Hooker, T. Osborne, J. Wolf, I. Supit, J.E. Olesen, J. Doltra, C. Nendel, S. Gayler, J. Ingwersen, E. Priesack, T. Streck, F. Tao, C. M\u00fcller, K. Waha, R. Goldberg, C. Angulo, I. Shcherbak, C. Biernath, D. Wallach, M. Travasso und A. Challinor (2012): Quantification of crop evapotranspiration and water use efficiency using 27 crop models. Beitr\u00e4ge des ASA, CSSA, and SSSA International Annual Meeting, Cincinnati, OH, USA, 21. \u2013 24. Oktober 2012.</p> </li> <li> <p>Martre, P., D. Wallach, S. Asseng, F. Ewert, D. Cammarano, P.K. Aggarwal, C. Angulo, B. Basso, P. Bertuzzi, C. Biernath, K.J. Boote, N. Brisson, J. Doltra, S. Gayler, R. Goldberg, R. Grant, J.L. Hatfield, L. Heng, J. Hooker, L.A. Hunt, J. Ingwersen, C. Izaurralde, J.W. Jones, K.C. Kersebaum, C. M\u00fcller, S. Naresh Kumar, C. Nendel, G. O\u2019Leary, J.E. Olesen, T. Osborne, T. Palosuo, E. Priesack, A. Ruane, D. Ripoche, C. Rosenzweig, R.P. R\u00f6tter, M.A. Semenov, I. Shcherbak, P. Steduto, C. St\u00f6ckle, P. Stratonovitch, T. Streck, I. Supit, P. Thorburn, M. Travasso, F. Tao, K. Waha, J.W. White und J. Wolf (2012): Predicting wheat growth and nitrogen use with an ensemble of crop simulation models. Beitr\u00e4ge des ASA, CSSA, and SSSA International Annual Meeting, Cincinnati, OH, USA, 21. \u2013 24. Oktober 2012.</p> </li> <li> <p>Asseng, S., F. Ewert, C. Rosenzweig, J.W. Jones, J.L. Hatfield, A. Ruane, K.J. Boote, P. Thorburn, R.P. R\u00f6tter, D. Cammarano, N. Brisson, B. Basso, P. Martre, D. Ripoche, P. Steduto, L. Heng, M. Semenov, C. Stockle, G. O\u2019Leary, P.K. Aggarwal, N. Soora, C. Izaurralde, J. White, T. Hunt, R. Grant, C, Kersebaum, T. Palosuo, J. Hooker, T. Osborne, J. Wolf, I. Supit, J.E. Olesen, J. Doltra, C. Nendel, S. Gayler, J. Ingwersen, E. Priesack, T. Streck, F. Tao, K. Waha, C. Mueller, R. Goldberg, C. Angulo, I. Shcherbak, C. Biernath, D. Wallach, M. Travasso und A. Challinor (2012): Uncertainties in assessing the impact of climate change with crop models: The AgMIP Wheat pilot study. Beitr\u00e4ge des ASA, CSSA, and SSSA International Annual Meeting, Cincinnati, OH, USA, 21. \u2013 24. Oktober 2012.</p> </li> <li> <p>Bassu, S., J.L. Durand, J. Lizaso, K.J. Boote, D. Makowski, A.C. Ruane, C. Baron, B. Basso, C. Biernath, H. Boogard, S. Conijn, D. Deryng, G. De Sanctis, S. Gayler, P. Grassini, S.B. Hoek, C. Izaurralde, R. Jongschaap, A. Kemanian, K.C. Kersebaum, C. M\u00fcller, C. Nendel, E. Priesack, F. Sau, I. Shcherbak, F.L. Tao, E. Teixeira, D. Timlin, K. Waha, J. Hatfield und M. Corbeels (2012): Uncertainties in maize crop model responses to climate factors. Beitr\u00e4ge des ASA, CSSA, and SSSA International Annual Meeting, Cincinnati, OH, USA, 21. \u2013 24. Oktober 2012.</p> </li> <li> <p>Nendel, C., R. Wieland, W. Mirschel, X. Specka und K.C. Kersebaum (2012): The simulation of winter wheat yields in Thuringia, Germany, using meteorological data with different spatial resolution. Beitr\u00e4ge des 12. ESA-Kongress Agro2012, Helsinki, Finnland.</p> </li> <li> <p>Bassu, S., J.L. Durand, J. Lizaso, K.J. Boote, D. Makowski, A.C. Ruane, C. Baron, B. Basso, C. Biernath, H. Boogard, S. Conijn, D. Deryng, G. De Sanctis, S. Gayler, P. Grassini, S.B. Hoek, C. Izaurralde, R. Jongschaap, A. Kemanian, K.C. Kersebaum, C. M\u00fcller, C. Nendel, E. Priesack, F. Sau, I. Shcherbak, F.L. Tao, E. Teixeira, D. Timlin, K. Waha, J. Hatfield und M. Corbeels (2012): Uncertainties in maize crop model responses to climate factors. Beitr\u00e4ge des 12. ESA-Kongress Agro2012, Helsinki, Finnland.</p> </li> <li> <p>Asseng, S., F. Ewert, C. Rosenzweig, J.W. Jones, J.L. Hatfield, A. Ruane, K.J. Boote, P. Thorburn, R.P. R\u00f6tter, D. Cammarano, N. Brisson, B. Basso, P. Martre, D. Ripoche, P. Steduto, L. Heng, M. Semenov, C. Stockle, G. O\u2019Leary, P.K. Aggarwal, N. Soora, C. Izaurralde, J. White, T. Hunt, R. Grant, C, Kersebaum, T. Palosuo, J. Hooker, T. Osborne, J. Wolf, I. Supit, J.E. Olesen, J. Doltra, C. Nendel, S. Gayler, J. Ingwersen, E. Priesack, T. Streck, F. Tao, K. Waha, C. Mueller, R. Goldberg, C. Angulo, I. Shcherbak, C. Biernath, D. Wallach, M. Travasso und A. Challinor (2012): The AgMIP Wheat pilot study: A sensitivity analysis with 27 crop models. 6th International Crop Science Congress, Bento Gon\u00e7alves, Brasilien. 6. \u2013 10. August 2012.</p> </li> <li> <p>Chatskihk, D., C. Nendel, U. Hagemann, X. Specka, J. Augustin, M. Sommer und K. van Oost (2012): An approach to assess NEE and C-costs associated with an energy-crop production at different erosion-induced transient states in a typical North-Eastern Germany landscape using process-based agroecosystem modeling. Geophysical Research Abstracts 14, EGU2012-13610.</p> </li> <li> <p>Specka, X., R. Wieland und C. Nendel (2012): Entwicklung einer Umgebung zur Optimierung sensitiver Parameter im Agrar\u00f6kosystemmodell MONICA. In: A. Gnauck (Ed.): Modellierung und Simulation von \u00d6kosystemen \u2013 Workshop K\u00f6lpinsee 2011, Shaker Publishing, Aachen.</p> </li> <li> <p>Mirschel, W., K.O. Wenkel, M. Berg, C. Nendel und R. Wieland (2012): Unsicherheiten bei der modellgest\u00fctzten Klimafolgenabsch\u00e4tzung. In: A. Gnauck (Ed.): Modellierung und Simulation von \u00d6kosystemen \u2013 Workshop K\u00f6lpinsee 2011, Shaker Publishing, Aachen.</p> </li> </ul>"},{"location":"references/publications/#2011","title":"2011","text":"<ul> <li> <p>Nendel, C., M. Berg, K.C. Kersebaum, W. Mirschel, X. Specka, M. Wegehenkel, K.O. Wenkel und R. Wieland (2011): The MONICA model: Testing predictability for crop growth, soil moisture and nitrogen dynamics. Ecol. Model. 222 (9), 1614 \u2013 1625.</p> </li> <li> <p>Nendel, C., K.C. Kersebaum, W. Mirschel und K.O. Wenkel (2011): Strategien f\u00fcr die Landwirtschaft im Klimawandel: eine Modellstudie. Jahrestagung der Deutschen Bodenkundlichen Gesellschaft, Berlin, Germany. Berichte der DBG (online), http://eprints.dbges.de/cgi/latest.</p> </li> <li> <p>Specka, X., C. Nendel und M. Willms (2011): Preparing MONICA \u2013 the Model for Nitrogen and Carbon in Agro-ecosystems \u2013 for the assessment of abiotic effects of energy cropping. European Federation for Information Technology in Agriculture, Food and the Environment (EFITA) Proceedings of the World Congress on Computers in Agriculture. Prag, Tschechien, 616 \u2013 623.</p> </li> </ul>"},{"location":"references/publications/#2010","title":"2010","text":"<ul> <li> <p>Mirschel, W., C. Nendel, K.C. Kersebaum and K.-O. Wenkel (2010): CO2 response algorithms for different crop growth and yield model types used for climate change impact assessment on different spatial scales \u2013 Potentials and limitations. Proceedings of the \u201cMathematic models and information technology in agriculture and biology: Achievements and perspectives\u201d conference, Agro-physical Institute St. Petersburg, Russia, 204 \u2013 210.</p> </li> <li> <p>Specka, X., C. Nendel, M. Willms, and K.C. Kersebaum (2010): Ist Mais gleich Mais? Vergleich der Parametrisierung verschiedener Mais-Sorten am Modell MONICA. Proceedings of the DBG and DGP commissions workshop; 07.-08.09.2010 in M\u00fcncheberg, Germany; Berichte der DBG.</p> </li> <li> <p>K\u00f6stner, B., E. Albert, M. Berg, C. Bernhofer, T. Donix, U. Henk, J. Franke, K.C. Kersebaum, M. Kuhnert, W. Mirschel, C. Nendel, K.-O. Wenkel and R. Wieland (2010): Application of the model-based knowledge system LandCaRe DSS to pilot regions for climate change adaptation in Germany \u2013 Analyses at regional and local scale. Proceedings of the 11th ESA Congress Agro2010, Montpellier, France, 909 \u2013 910.</p> </li> <li> <p>Nendel, C., M. Berg, K.C. Kersebaum W. Mirschel, M. Wegehenkel, R. Wieland and K.O. Wenkel (2010): MONICA \u2013 Modelling effects of climate change on crop production and environment within an interactive knowledge platform. Proceedings of the 11th ESA Congress Agro2010, Montpellier, France, 937 \u2013 938.</p> </li> <li> <p>Nendel, C. (2010): MONICA \u2013 ein prozessorientiertes Boden-Pflanze-Atmosph\u00e4ren-Modell zur gekoppelten Absch\u00e4tzung der \u00f6kologischen Langzeitfolgen von Landnutzungs- und Klima\u00e4nderungen in Agrarlandschaften. Leibniz-Zentrum f\u00fcr Agrarlandschaftsforschung. Annual report 2009, 48 \u2013 53.</p> </li> <li> <p>Mirschel, W., K.C. Kersebaum, C. Nendel, K.-O. Wenkel, R. Manderscheid and H.-J. Weigel (2010): Ber\u00fccksichtigung des CO2-Effekts auf Biomasse und Ertrag in Agrar\u00f6kosystem- und Ertragssch\u00e4tzmodellen.</p> </li> <li> <p>Specka, X., R. Wieland, W. Mirschel und C. Nendel (2010): Eine Methodik zur strukturellen Analyse von \u00d6kosystemmodellen. In: A. Gnauck (Ed.): Modellierung und Simulation von \u00d6kosystemen \u2013 Workshop K\u00f6lpinsee 2009, Shaker Publishing, Aachen, 1 \u2013 18.</p> </li> </ul>"},{"location":"references/publications/#2009","title":"2009","text":"<ul> <li> <p>Nendel, C., K.C. Kersebaum, W. Mirschel, R. Manderscheid, H.-J. Weigel und K. O. Wenkel (2009): Testing different CO2 response algorithms against a FACE crop rotation experiment. NJAS \u2013 Wagen. J. Life Sc. 57 (1), 17 \u2013 25.</p> </li> <li> <p>Kersebaum, K.C., C. Nendel, W. Mirschel, R. Manderscheid, H.-J. Weigel und K. O. Wenkel (2009): Testing different CO2 response algorithms against a FACE crop rotation experiment and application for climate change impact assessment on different sites in Germany. Id\u00f6j\u00e1r\u00e1s 113 (1-2), 79 \u2013 88.</p> </li> <li> <p>Kersebaum, K. C., W. Mirschel, K.-O. Wenkel, R. Manderscheid, H.-J. Weigel und C. Nendel (2009): Modelling climate change impacts on crop growth and management in Germany. In: A. Utset (Ed.): Climate Variability, Modeling Tools and Agricultural Decision Making, Nova Science Publisher Inc., New York, ISBN: 978-1-60692-703-8, 183 \u2013 194.</p> </li> </ul>"},{"location":"references/publications/#2008","title":"2008","text":"<ul> <li> <p>K\u00f6stner, B., M. Berg, C. Bernhofer, J. Franke, H. G\u00f6mann, K.C. Kersebaum, M. Kuhnert, R. Lindau, R. Manderscheid, H.-T. Mengelkamp, W. Mirschel, C. Nendel, E. Nozinski, A. P\u00e4tzold, C. Simmer, R. Stonner, H.-J. Weigel, K.-O. Wenkel and R. Wieland (2008): Land, Climate and Resources (LandCaRe) 2020: foresight and potentials in rural areas under regional climate change. Italian Journal of Agronomy 3 (Supplement), 743 \u2013 744.</p> </li> <li> <p>Kersebaum, K.C., A. S. Nain, C. Nendel, M. Gandorfer and M. Wegehenkel (2008): Simulated effects of climate change on arable crop production and water and nitrogen management in different regions of Germany. Journal of Agrometeorology 10 (Special Issue), 266 \u2013 273.</p> </li> </ul>"},{"location":"user_guide/Installation_and_Setup/docker_setup/","title":"Docker setup","text":""},{"location":"user_guide/Installation_and_Setup/docker_setup/#1-overview","title":"1. Overview","text":"<p>MONICA provides an official Docker image \u2014 <code>zalfrpm/monica-cluster</code> \u2014 built on Debian 9. The container runs MONICA with: - an input proxy - an output proxy - and a configurable number of MONICA worker processes</p> <p>Each container can act as a standalone MONICA \u201ccluster\u201d on a multi-core machine.</p>"},{"location":"user_guide/Installation_and_Setup/docker_setup/#2-pull-the-docker-image","title":"2. Pull the Docker Image","text":"<p>Download the official image from Docker Hub:</p> <pre><code>docker pull zalfrpm/monica-cluster:&lt;tag&gt;\n</code></pre>"},{"location":"user_guide/Installation_and_Setup/local_installation/","title":"1. Windows installation","text":""},{"location":"user_guide/Installation_and_Setup/local_installation/#installing-and-accessing-the-zip-version-of-monica-under-windows","title":"Installing and Accessing the ZIP Version of MONICA under Windows","text":"<p>Starting with version 3.6.x, MONICA is distributed as a ZIP archive instead of a traditional installer. This makes setup simpler and more flexible where users can keep multiple MONICA versions on their computer and easily run a specific one for each project.</p>"},{"location":"user_guide/Installation_and_Setup/local_installation/#1-extracting-monica","title":"1. Extracting MONICA","text":"<ul> <li> <p>Download the latest Windows ZIP package from the MONICA Releases Page, for example: <code>monica-windows-x86_64.zip</code></p> </li> <li> <p>Extract the contents to a convenient location, such as: <code>C:\\monica\\</code></p> </li> <li> <p>After extraction, folder structure should look like this:</p> </li> </ul> <p><pre><code>C:\\monica\n\u251c\u2500\u2500 bin\n\u251c\u2500\u2500 monica-parameters\n\u251c\u2500\u2500 projects\n\u2514\u2500\u2500 documentation\\\n</code></pre> There is no installation process. Simply unzipping the archive is enough to make MONICA ready for use. User may also maintain several versions in parallel (e.g., C:\\monica_3.6.12\\, C:\\monica_3.7.0).</p>"},{"location":"user_guide/Installation_and_Setup/local_installation/#2-running-monica","title":"2. Running MONICA","text":"<p>Because the ZIP version isn\u2019t registered automatically in Windows, user can either:</p> <ul> <li> <p>Run the included example project, or</p> </li> <li> <p>Add MONICA to the user system PATH to use it from anywhere.</p> </li> </ul>"},{"location":"user_guide/Installation_and_Setup/local_installation/#option-1-run-the-example-project-recommended","title":"Option 1: Run the Example Project (Recommended)","text":"<p>MONICA comes with a ready-to-run example project.</p> <p>i.  Open Command Prompt (Win + R \u2192 type cmd \u2192 press Enter).</p> <p>ii. Type the following commands:</p> <pre><code>C:\\monica\\projects\\Hohenfinow2-single-run\n</code></pre> <p>iii. Run the simulation by typing:</p> <pre><code>run_monica.cmd\n</code></pre> <p>The script automatically:</p> <ul> <li>Points to the MONICA executable in the bin folder</li> <li>Sets required environment variables (e.g., MONICA_PARAMETERS)</li> <li>Runs a predefined example simulation</li> </ul> <p>When the run is complete, a file named <code>sim-out.csv</code> will appear in the same folder. Open it in <code>Excel</code> or any text editor to view the results.</p>"},{"location":"user_guide/Installation_and_Setup/local_installation/#option-2-run-monica-manually-advanced","title":"Option 2: Run MONICA Manually (Advanced)","text":"<p>If user prefer to run MONICA from anywhere on the system</p> <p>i.   Add the path to bin folder (e.g. C:\\monica\\bin) to the PATH environment variable</p> <p>ii.  Create a new environment variable named MONICA_PARAMETERS and set its value to: <code>C:\\monica\\monica-parameters</code></p> <p>iii. Open a new Command Prompt and verify the installation: <code>monica-run.exe - -help</code>  (In some versions, the executable is called monica.exe, whichever appears in the bin folder)</p> <p>Note: Some releases include only monica-run.exe (and not monica.exe). This is normal as both serve the same purpose for running simulations.</p>"},{"location":"user_guide/Installation_and_Setup/local_installation/#3updating-an-existing-installation","title":"3.Updating an Existing Installation","text":"<ul> <li> <p>If the user already has an older MONICA installation (for example under%USERPROFILE%\\AppData\\MONICA), user can simply replace the files in the existing bin folder with those from the new ZIP.</p> </li> <li> <p>However, it\u2019s generally recommended to use the ZIP-based workflow exclusively. This avoids version conflicts and allows each project to reference its own MONICA version explicitly.</p> </li> </ul>"},{"location":"user_guide/Installation_and_Setup/local_installation/#4-verifying-the-installation","title":"4. Verifying the Installation","text":"<ul> <li>To confirm that MONICA runs correctly, enter the script in command prompt : </li> </ul> <pre><code>C:\\monica\\projects\\Hohenfinow2-single-run\n</code></pre> <p>Run the simulation by typing:</p> <pre><code>run_monica.cmd\n</code></pre> <p>If the setup is correct, the model will complete a short test simulation and generate an output file named <code>sim-out.csv</code> in the same directory. This confirms that MONICA is successfully installed and functional.</p>"},{"location":"user_guide/Installation_and_Setup/local_installation/#2-linux-installation","title":"2. Linux installation","text":""},{"location":"user_guide/Installation_and_Setup/local_installation/#local-installation-of-monica-on-linux","title":"Local Installation of MONICA on Linux","text":"<p>Currently, MONICA does not provide a precompiled ZIP version for Linux. However, user can easily install and build it locally using the following steps (tested on Debian/Ubuntu systems).</p>"},{"location":"user_guide/Installation_and_Setup/local_installation/#1-prerequisites","title":"1. Prerequisites","text":"<p>Before building MONICA, make sure the following software is installed on the system:</p> <ul> <li>Python 3.6+</li> <li>CMake</li> <li>Git</li> <li>Curl</li> <li>Unzip</li> <li>Tar</li> </ul> <p>install all dependencies on Debian/Ubuntu with:</p> <p><pre><code>sudo apt-get update\nsudo apt-get install build-essential\nsudo apt-get install python3-dev\nsudo apt-get install curl unzip tar\nsudo apt-get install git\nsudo apt-get install cmake\nsudo apt-get install libtool autoconf\n</code></pre> These packages provide the basic tools and libraries required to build MONICA from source.</p>"},{"location":"user_guide/Installation_and_Setup/local_installation/#2-create-a-working-folder-eg-zalf-rpm","title":"2. Create a working folder (e.g ~/zalf-rpm)","text":"<p>Create a directory to store MONICA and its dependencies:</p> <pre><code>mkdir zalf-rpm\ncd zalf-rpm\n</code></pre>"},{"location":"user_guide/Installation_and_Setup/local_installation/#3-clone-monica-and-dependencies","title":"3. Clone MONICA and Dependencies","text":"<p>Clone the MONICA source code along with its submodules and required parameters:</p> <pre><code>git clone --recurse-submodules https://github.com/zalf-rpm/monica.git\ngit clone https://github.com/zalf-rpm/monica-parameters.git\n</code></pre>"},{"location":"user_guide/Installation_and_Setup/local_installation/#4-setup-vcpkg-for-dependent-libraries","title":"4. Setup vcpkg for Dependent Libraries","text":"<p>MONICA uses vcpkg to manage external libraries. Clone the vcpkg repository using the version tag specified in the vcpkg_tag.txt file found in the MONICA repository root. This initializes vcpkg and prepares it to build required libraries</p> <p><pre><code>git clone -b 2024.09.30 https://github.com/Microsoft/vcpkg.git\n</code></pre> build vcpkg by typing:</p> <pre><code>cd vcpkg\n./bootstrap-vcpkg.sh\n</code></pre>"},{"location":"user_guide/Installation_and_Setup/local_installation/#5-install-required-libraries-via-vcpkg","title":"5. Install Required Libraries via vcpkg","text":"<p>Use vcpkg to install the following dependencies: </p> <p><pre><code>./vcpkg install zeromq:x64-linux\n./vcpkg install capnproto:x64-linux\n./vcpkg install libsodium:x64-linux\n./vcpkg install tomlplusplus:x64-linux\n</code></pre> These libraries enable communication, serialization, encryption, and configuration parsing within MONICA.</p>"},{"location":"user_guide/Installation_and_Setup/local_installation/#6-build-monica","title":"6. Build MONICA","text":"<p>After installing all dependencies, build MONICA using its provided build script.</p> <p><pre><code>cd ~/zalf-rpm/monica\nsh create_cmake_release.sh\ncd _cmake_release\nmake\n</code></pre> The script creates a CMake build directory named <code>_cmake_release</code> and compiles MONICA. The resulting executable <code>(monica-run)</code> will be located inside this folder.</p>"},{"location":"user_guide/Installation_and_Setup/local_installation/#7-run-monica","title":"7. Run MONICA","text":"<p>Once the build completes successfully, verify the installation:</p> <pre><code>./monica-run --help\n</code></pre> <p>If the user see a list of available options and commands, MONICA has been built correctly.</p>"},{"location":"user_guide/Installation_and_Setup/local_installation/#8-running-a-test-simulation","title":"8. Running a Test Simulation","text":"<p>To perform a test run, user can use one of the included example simulation files, for instance:</p> <pre><code>./monica-run -o ../../output_csv/out.csv ../installer/Hohenfinow2/sim-min.json\n</code></pre> <p>This command runs a short test simulation and writes results to output_csv/out.csv</p>"},{"location":"user_guide/configuration_files/config_crop_json/","title":"The <code>crop.json</code> configuration file","text":"<p><code>crop.json</code> defines all crop-specific input data for MONICA. The top-level JSON object must contain exactly two keys: <code>cropRotation</code> and <code>CropParameters</code>. </p> <ul> <li><code>cropRotation</code> is a JSON array of objects, each representing a cultivation method (class <code>CultivationMethod</code> in the MONICA C++ code). </li> <li><code>CropParameters</code> contains global crop-related MONICA parameters, which are taken either from the user-parameter database table or a referenced file.</li> </ul>"},{"location":"user_guide/configuration_files/config_crop_json/#cultivation-methods","title":"Cultivation Methods","text":"<p>A cultivation method is defined as a set of worksteps (class hierarchy <code>Workstep</code> in the MONICA code). The order of the worksteps is important. Putting static worksteps (with fixed relative or absolute dates) in the wrong order may prevent them from being executed. </p> <p>Worksteps can represent sowing, harvesting, fertilization, irrigation, or tillage applications. A sowing workstep tells MONICA when and which crop to grow. Within the sowing workstep, the <code>crop</code> parameter must contain a JSON object with all crop parameters MONICA requires. This can be defined inline, included via <code>include-from-db</code> or <code>include-from-file</code>, or referenced using <code>ref</code>. </p> <p>Because crops might be used in more than one workstep or cultivation method, the example below (at the end of this section) defines all crops in a separate JSON object named <code>crops</code>, which maps shortcut names to crop parameter objects. The mapping object is stored under the top-level key <code>crops</code>, which becomes the first parameter to the <code>ref</code> function, with the second being the crop's shortcut name. The names (<code>crops</code>, <code>WR</code>, <code>SM</code>, etc.) are arbitrary.</p> <p>A cultivation method can also have parameters, as described in the following table:</p> Parameter name Unit/Type Default Example Description <code>can-be-skipped</code> <code>true</code> or <code>false</code> <code>false</code> If true, this cultivation method can be skipped if its earliest starting date is before the current date (e.g., when the climate data start later than the first workstep in the cultivation method). If false, MONICA will wait until the date (condition) of the first workstep is reached, which might never happen if that date is in the past. <code>is-cover-crop</code> <code>true</code> or <code>false</code> <code>false</code> If true, the cultivation method describes a catch or cover crop. Similarly to <code>can-be-skipped</code>, it will be skipped if the previous primary crop was harvested later than the latest sowing date (in contrast to the earliest workstep date using <code>can-be-skipped</code>). If false, MONICA might not continue the crop rotation because it waits for the the cover/catch crop sowing workstep, whose latest sowing date is already in the past."},{"location":"user_guide/configuration_files/config_crop_json/#worksteps","title":"Worksteps","text":"<p>The following table lists all worksteps available in MONICA. All worksteps require a <code>date</code> parameter. If <code>date</code> is missing, the workstep is interpreted as dynamic, meaning it depends on one or more conditions that MONICA checks daily. Once the conditions are met, the workstep is executed once per CultivationMethod.</p> <p>Every non-dynamic workstep (e.g., <code>Sowing</code>, <code>Harvest</code>, <code>Tillage</code>, <code>SetValue</code>, etc.) can have a <code>days</code> (default 0[d]) and an <code>after</code> ([event-name]) property. If both are set, the workstep will be executed <code>days</code> after the <code>after</code> event occurs.</p> <p>A workstep date can be relative (e.g., <code>\"0000-12-01\"</code> for every December 1st, or <code>\"0001-12-01\"</code> for the next year's December 1st), which means its year part is a four-digit number between 0 and 100, padded with 0s, or absolute (e.g., <code>\"2017-12-01\"</code> for December 1st, 2017). </p> <ul> <li>In relative crop rotation, worksteps are repeated throughout the available climate data period, wrapping around when the end is reached. </li> <li>In an absolute crop rotation, worksteps are only executed when their dates occur within the simulation period, so care must be taken to ensure they are reachable (e.g., a workstep before the start of the climate date will never execute).</li> </ul> <p>All worksteps share the parameters of the <code>Workstep</code> base class. If <code>date</code> is not given, at least one conditional parameter must be defined. Otherwise, the workstep will never be executed.</p>"},{"location":"user_guide/configuration_files/config_crop_json/#workstep","title":"Workstep","text":"<p>The base workstep itself does nothing but can be used in conjunction with the <code>Workstep</code> event. If no <code>date</code> is given, <code>days</code> and <code>after</code> can be specified, or alternatively <code>at</code>, which is equivalent to <code>after</code> with <code>days</code> set to 0. Then the workstep will be executed the specified number of <code>days</code> after the <code>after</code> event occurs. </p> <p>Note</p> <p>Due to MONICA's internal scheduling, <code>after: 1</code> effectively behaves like <code>after: 0</code>, because dynamic worksteps are checked (and potentially executed) at the start of each day, while events like <code>anthesis</code>, etc. are triggered later in the daily calculation. Therefore, \"before\" and \"after\" distinctions may depend on implementation details.</p> <p>Fires the <code>Workstep</code> event.</p> Parameter name Unit/Type Default Example Description date ISO date <code>\"YYYY-MM-DD\"</code> <code>\"1991-05-21\"</code> or <code>\"0001-05-21\"</code> Absolute or relative date days [d] 0 Days after event after string <code>\"Harvest\"</code> Event/workstep name at string <code>\"Harvest\"</code> Event/workstep name"},{"location":"user_guide/configuration_files/config_crop_json/#sowing","title":"Sowing","text":"<p>Defines the sowing date via the <code>date</code> parameter, and specifies the crop to be planted via the <code>crop</code> parameter.</p> <p>Fires the <code>Sowing</code> event.</p> Parameter name Unit/Type Default Example Description <code>crop</code> JSON object JSON object specifying the crop to plant <code>PlantDensity</code> [plants m-2] <code>10</code> for maize Plant density"},{"location":"user_guide/configuration_files/config_crop_json/#crop-json-object","title":"crop JSON object","text":"<p>The <code>crop</code> key references a complex JSON structure describing the crop to be planted. It might look like:</p> <pre><code>{\n  \"is-winter-crop\": false,\n  \"is-perennial-crop\": true,\n  \"cropParams\": {\n    \"species\": [\"include-from-file\", \"crops/clover-grass-ley.json\"],\n    \"cultivar\": [\"include-from-file\", \"crops/clover-grass-ley/.json\"]\n  },\n  \"residueParams\": [\"include-from-file\", \"crop-residues/clover-grass-ley.json\"]\n}\n</code></pre> <p>If the crop is a perennial, <code>is-perennial-crop</code> should be set to true, even though the cultivar parameters may already contain the key <code>Perennial</code>, which can define at the cultivar level that a crop is by default a perennial crop. </p> <p>If <code>is-perennial-crop</code> is given, it overrides <code>Perennial</code>. </p> <p>If <code>is-perennial-crop</code> is set to true but no <code>perennialCropParams</code> key is specified, then the perennialCropParams will be the same as cropParams. </p> <p>Both <code>cropParams</code> and <code>residueParams</code> are compulsory keys. </p> <p>If <code>is-winter-crop</code> is not specified, MONICA determines it automatically. A crop is treated as a winter crop if its sowing day of year (DOY) is after its harvest DOY. <code>is-winter-crop</code> is currently used to determine when the N-Min method (if activated) is applied. If true, the N-Min method is applied on the defined DOY (e.g., DOY = 89). For summer crops, the N-Min method is applied at sowing.</p> Key name Unit/Type Default Optional? Description <code>cropParams</code> JSON object Contains the MONICA species and cultivar parameters <code>residueParams</code> JSON object The MONICA residue parameters <code>perennialCropParams</code> JSON object = <code>cropParams</code> if <code>is-perennial-crop</code> = true x The <code>cropParams</code> used for the years after the planting year <code>is-winter-crop</code> true or false If DOY(seed-date) &gt; DOY(harvest-date) -&gt; true, else false x Defines whether the crop is a winter crop. If not provided, MONICA derives it automatically from sowing and harvest DOYs. <code>is-perennial-crop</code> true or false false x Defines whether the crop is perennial. Overrides the cultivar's <code>Perennial</code> parameter if given. <code>cuttingDates</code> JSON array of ISO dates [] x Defines a list of cutting dates for the crop. Serves as a shortcut for the same number of Cutting worksteps."},{"location":"user_guide/configuration_files/config_crop_json/#cropparamsperennialcropparams-json-object","title":"<code>cropParams</code>/<code>perennialCropParams</code> JSON object","text":"Key name Unit/Type Description <code>species</code> JSON object The MONICA species parameters <code>cultivar</code> JSON object The MONICA cultivar-specific parameters"},{"location":"user_guide/configuration_files/config_crop_json/#automatic-sowing","title":"Automatic Sowing","text":"<p>An automatic sowing workstep whose algorithm starts checking conditions from <code>earliest-date</code> onward. If no conditions are met before <code>latest-date</code>, sowing will still occur on that date.</p> <p>Conditions</p> <ul> <li><code>min-temp</code> and <code>days-in-temp-window</code>:</li> <li>Spring crops: sowing is possible if the daily minimum air temperature (<code>tmin</code>) &gt;= <code>min-temp</code> and the average temperature (<code>tavg</code>) over the time window <code>days-in-temp-window</code> &gt;= <code>min-temp</code>.</li> <li>Winter crops: sowing is possible if the running average air temperature (<code>tavg</code>) within <code>days-in-temp-window</code> &lt;= <code>min-temp</code>.</li> <li><code>min-%-asw</code> and <code>max-%-asw</code>: bounds (in % of available soil water) within which the 0-10 cm soil moisture (<code>[\"Mois\", 1]</code>) must lie for possible sowing.</li> <li><code>max-3d-precip</code>: maximum 3-day precipitation sum [mm] (including the current day) for possible sowing</li> <li><code>max-curr-day-precip</code>: maximum daily precipitation sum [mm] allowed on the current day for possible sowing</li> <li><code>temp-sum-above-base-temp</code> and <code>base-temp</code>: defines the temperature sum above <code>base-temp</code> required for sowing</li> </ul> <p>Fires the <code>AutomaticSowing</code> event.</p> Parameter name Unit/Type Default Example Description <code>crop</code> JSON object The crop to be sown <code>earliest-date</code> ISO date Earliest date when sowing may take place <code>latest-date</code> ISO date Latest date by which sowing will occur regardless of conditions <code>min-temp</code> [\u00b0C] Minimum temperature required <code>days-in-temp-window</code> [d] Number of consecutive days the minimum temperature must be met <code>min-%-asw</code> [%] Minimum percentage of available soil water <code>max-%-asw</code> [%] Maximum percentage of available soil water <code>max-3d-precip</code> [mm] Maximum precipitation sum over the last 3 days <code>max-curr-day-precip</code> [mm] Maximum precipitation allowed on the current day <code>temp-sum-above-base-temp</code> [K] Required temperature sum above base temperature <code>base-temp</code> [\u00b0C] Base temperature used to calculate temperature sums"},{"location":"user_guide/configuration_files/config_crop_json/#harvest","title":"Harvest","text":"<p>Defines the harvesting time of the previously sown crop and specifies whether to export biomass (add only roots and residues to AOMs).</p> <p>Fires <code>Harvest</code> event.</p> Parameter name Unit/Type Default Example Description <code>exported</code> true or false true If exported = false, the whole crop is incorporated into the soil. If true, only roots and residues remain. If no particular export rules for the organs are defined (see below), then the cultivar parameters <code>OrganIdsForPrimaryYield</code> and <code>OrganIdsForSecondaryYield</code> are used. If organ-specific parameters (e.g., <code>leaf</code>, <code>fruit</code>, etc.) are provided, the <code>export</code> parameter is ignored and the more specific ones are used. <code>leaf</code> and/or <code>fruit</code> and/or <code>shoot</code> and/or <code>struct</code> and/or <code>sugar</code> JSON object <code>{\"export\": [85, \"%\"], \"incorporate\": true}</code> Tells MONICA to export a certain percentage (if missing, defaults to 100%) of the organ used as parameter (e.g., <code>leaf</code>) and <code>incorporate</code> the residues into the soil (~~or leave the them as layer on the ground~~ -&gt; right now always true and not changeable!) (if missing, defaults to true). Missing organs are treated as residues and incorporated by default (as if specified <code>{\"export\": 0, \"incorporate\": true}</code>)."},{"location":"user_guide/configuration_files/config_crop_json/#automaticharvest","title":"AutomaticHarvest","text":"<p>An automatic harvesting workstep that is triggered once conditions are met after crop maturity, or on <code>latest-date</code> if conditions remain unmet.</p> <p>Conditions</p> <ul> <li><code>min-%-asw</code> and <code>max-%-asw</code>: soil moisture bounds (in % of available soil water) wherein the soil moisture (0-10cm) <code>[\"Mois\", 1]</code> has to lie for possible harvesting</li> <li><code>max-3d-precip</code>: maximum 3-day precipitation sum [mm] (including current day) for possible harvesting</li> <li><code>max-curr-day-precip</code>: maximum precipitation sum [mm] on the current day for possible harvesting</li> </ul> <p>Fires <code>AutomaticHarvest</code> event.</p> Parameter name Unit/Type Default Example Description <code>latest-date</code> ISO date Latest possible harvest date <code>min-%-asw</code> [%] Percentage of minimum available soil water for harvesting <code>max-%-asw</code> [%] Percentage of maximum available soil water for harvesting <code>max-3d-precip</code> [mm] Maximum 3-day precipitation sum <code>max-curr-day-precip</code> [mm] Maximum current day precipitation"},{"location":"user_guide/configuration_files/config_crop_json/#cutting","title":"Cutting","text":"<p>Performs a cutting operation on the crop. </p> <p>The parameters <code>organs</code>, <code>export</code>, and <code>cut-max-assimilation-rate</code> help to parameterize the cutting operation. </p> <ul> <li><code>organs</code> specifies which crop organs are cut or left on the plot</li> <li><code>exports</code> specifies how much of each cut organ part to export (the rest will be left on the plot and added to the organic matter pools). </li> </ul> <p>If <code>organs</code> are not defined, MONICA uses the cultivar parameters <code>OrganIdsForCutting</code> (<code>yieldPercentage</code> and <code>organId</code>). To specify which organ to cut or how much to export, the same organ names can be used as in the specification of the outputs section (<code>\"Root\"</code>, <code>\"Leaf\"</code>, <code>\"Shoot\"</code>, <code>\"Fruit\"</code>, <code>\"Struct\"</code>, <code>\"Sugar\"</code>). To further specify how much of an organ to cut, a second parameter to the organ can be a unit, which specifies the biomass (kg ha-1), the LAI (m2 m-2) or percentage (%) (default). A third parameter to the JSON array for the value in the organs array can be left or cut (default), specifying either how much to cut or how much to leave on the plot.</p> <p>Fires <code>Cutting</code> event.</p> Parameter name Unit/Type Default Example Description <code>organs</code> JSON object <code>{\"Leaf\": 85, \"Fruit\": [100, \"%\"]}</code> or <code>{\"Leaf\": [1.5, \"m2 m-2\", \"left\"], \"Fruit\": [50, \"%\", \"cut\"]}</code> Mapping of organs to percentage to cut <code>export</code> JSON object or (true/false) true <code>{\"Leaf\": 100, \"Fruit\": 0}</code> Mapping of organs to percentage to export after cut or just true or false if everything or nothing should be exported <code>cut-max-assimilation-rate</code> [%] 100 Percentage reduction in the maximum assimilation rate"},{"location":"user_guide/configuration_files/config_crop_json/#mineralfertilization","title":"MineralFertilization","text":"<p>Applies a given amount nitrogen (kg N) fertilizer, whose composition is described by <code>partition</code>. The <code>partition</code> object can also be included from an external JSON file.</p> <p>Fires <code>MineralFertilization</code> event.</p> Parameter name Unit/Type Default Example Description <code>partition</code> JSON object <code>{\"Carbamid\": 0, \"NH4\": 0.5, \"NO3\": 0.5}</code> JSON object describing the composition of the nitrogen fertilizer <code>amount</code> [kg N] Amount of nitrogen fertilizer to be applied to the soil"},{"location":"user_guide/configuration_files/config_crop_json/#ndemandfertilization","title":"NDemandFertilization","text":"<p>Applies a calculated amount of nitrogen fertilizer based on the crop's N demand. The composition of the fertilizer is described by <code>partition</code>, which can also be included from an external JSON file. The fertilizer occurs either at the specified <code>date</code> or, if no date is given, when the specified development stage <code>stage</code> is reached. The soil nitrogen status is measured down to the given <code>depth</code>.</p> <p>Fires <code>NDemandFertilization</code> event.</p> Parameter name Unit/Type Default Example Description <code>partition</code> JSON object <code>{\"id\": \"AN\",   \"name\": \"ammonium nitrate\", \"Carbamid\": 0, \"NH4\": 0.5, \"NO3\": 0.5}</code> JSON object describing the composition of the nitrogen fertilizer <code>N-demand</code> [kg N] The crop's nitrogen demand. The model applies the difference between the demand and the actually available N. <code>depth</code> [m] Depth down to which soil nitrogen is measured <code>stage</code> Development stage [1-6/7] 1 (sowing) or 6 (maturity of maize) MONICA development stage number at which fertilization occurs (if no date is specified)"},{"location":"user_guide/configuration_files/config_crop_json/#organicfertilization","title":"OrganicFertilization","text":"<p>Applies an organic fertilizer of the specified amount (kg), described by the <code>parameters</code> JSON object. The material is incorporated into the soil if <code>incorporation</code> is set to true.</p> <p>Fires <code>OrganicFertilization</code> event.</p> Parameter name Unit/Type Default Example Description <code>parameters</code> JSON object <code>{\"id\": \"CAM\", \"name\": \"cattle manure\", \"AOM_DryMatterContent\": [0.196, \"kg DM kg FM-1\"], \"AOM_FastDecCoeffStandard\": [0.002, \"d-1\"], \"AOM_NH4Content\": [0.007, \"kg N kg DM-1\"], \"AOM_NO3Content\": [0, \"kg N kg DM-1\"], \"AOM_SlowDecCoeffStandard\": [0.0002, \"d-1\"], \"CN_Ratio_AOM_Fast\": 6.5, \"CN_Ratio_AOM_Slow\": 100, \"NConcentration\": 0, \"PartAOM_Slow_to_SMB_Fast\": [1, \"kg kg-1\"], \"PartAOM_Slow_to_SMB_Slow\": [0, \"kg kg-1\"], \"PartAOM_to_AOM_Fast\": [0.18, \"kg kg-1\"], \"PartAOM_to_AOM_Slow\": [0.72, \"kg kg-1\"]}</code> JSON object describing the composition and properties of the organic fertilizer <code>amount</code> [kg] [30000, \"kg\"] Amount of organic fertilizer applied <code>incorporation</code> true or false Whether the fertilizer is incorporated into the soil (true) or left on the surface (false)"},{"location":"user_guide/configuration_files/config_crop_json/#tillage","title":"Tillage","text":"<p>Performs tillage down to a specified depth (m).</p> <p>Fires <code>Tillage</code> event.</p> Parameter name Unit/Type Default Example Description <code>depth</code> [m] Tillage depth"},{"location":"user_guide/configuration_files/config_crop_json/#irrigation","title":"Irrigation","text":"<p>Applies an amount of irrigation water with optionally specified nitrate and sulfate concentrations.</p> <p>Fires <code>Irrigation</code> event.</p> Parameter name Unit/Type Default Example Description <code>parameters</code> JSON object <code>{\"nitrateConcentration\": [mg dm-3], \"sulfateConcentration\": [mg dm-3]}</code> JSON object describing the nitrate and sulfate concentrations of the irrigation water <code>amount</code> [mm] Amount of irrigation water to be applied"},{"location":"user_guide/configuration_files/config_crop_json/#setvalue","title":"SetValue","text":"<p>Sets the given settable output expression to a new value at the specified date. The value can be:</p> <ul> <li>A single scalar (e.g., <code>5.0</code>),</li> <li>A JSON array if settable output expression is also a JSON array (e.g., output expression is <code>[\"Mois, [1,3]]</code>, then value could be <code>[20, 30, 20]</code>), or</li> <li>An arithmetic expression where OP can be <code>+</code>, <code>-</code>, <code>*</code>, <code>/</code> and either side a value or an output expression. </li> </ul> <p>Note</p> <p>Only a limited set of variables are currently available.</p> <p>Fires <code>SetValue</code> event.</p> Parameter name Unit/Type Default Example Description <code>var</code> Settable output expression <code>[\"NO2\", 1]</code> Variable or array element to set <code>value</code> Value or JSON array <code>[\"=\", output-name or value, OP, output-name or value]</code> <code>[\"=\", [\"NO2\", 1], \"*\", 0.5]</code> Expression or number like the ones to be used to define outputs <p>Some examples for the SetValue workstep:</p> <p>Set every September 22 the NO<sub>2</sub> value in layer 0 (first layer) to the value which will be calculated by layer 1 * 0.5:</p> <pre><code>{ \"date\": \"0000-09-22\", \"type\": \"SetValue\", \"var\": [\"NO2\", 1], \"value\": [\"=\", [\"NO2\", 1], \"*\", 0.5] }\n</code></pre> <p>Double the NO<sub>3</sub> values in layers 1-10 every September 23:</p> <pre><code>{ \"date\": \"0000-09-23\", \"type\": \"SetValue\", \"var\": [\"NO3\", [1, 10]], \"value\": [\"=\", [\"NO3\", [1, 10]], \"*\", 2] }\n</code></pre> <p>Set the NH<sub>4</sub> value in layer 1 to its current value every September 24 (no effect):</p> <pre><code>{ \"date\": \"0000-09-24\", \"type\": \"SetValue\", \"var\": [\"NH4\", 1], \"value\": [\"NH4\", 1] }\n</code></pre> <p>Set the carbamide (Carb) value in all layers to 0.01 every September 25:</p> <pre><code>{ \"date\": \"0000-09-25\", \"type\": \"SetValue\", \"var\": [\"Carb\", [1,20]], \"value\": 0.01 }\n</code></pre>"},{"location":"user_guide/configuration_files/config_crop_json/#example-cropjson-file","title":"Example crop.json file","text":"<p>Below is an example <code>crop.json</code> file defining a complete crop rotation over multiple years.</p> <p>It demonstrates:</p> <ul> <li>How to define crops and residues under the <code>\"crops\"</code> key.</li> <li>How to reference them in the <code>\"cropRotation\"</code> using the <code>[\"ref\", \"crops\", \"&lt;crop code&gt;\"]</code> syntax.</li> <li>How to schedule various worksteps such as sowing, fertilization, irrigation, tillage, and harvest.</li> <li>How to include parameter files from external sources (via <code>include-from-file</code>).</li> </ul> <p>This example illustrates a crop rotation that includes winter rye, silage maize, potato, winter wheat, winter barley, spring barley, and winter rape.</p> <pre><code>{\n  \"crops\": {\n    \"WR\": {\n      \"cropParams\": {\n        \"species\": [\"include-from-file\", \"../monica-parameters/crops/rye.json\"],\n        \"cultivar\": [\"include-from-file\", \"../monica-parameters/crops/rye/winter rye.json\"]\n      },\n      \"residueParams\": [\"include-from-file\", \"../monica-parameters/crop-residues/rye.json\"]\n    },\n    \"SM\": {\n      \"cropParams\": {\n        \"species\": [\"include-from-file\", \"../monica-parameters/crops/maize.json\"],\n        \"cultivar\": [\"include-from-file\", \"../monica-parameters/crops/maize/silage maize.json\"]\n      },\n      \"residueParams\": [\"include-from-file\", \"../monica-parameters/crop-residues/maize.json\"]\n    },\n    \"MEP\": {\n      \"cropParams\": {\n        \"species\": [\"include-from-file\", \"../monica-parameters/crops/potato.json\"],\n        \"cultivar\": [\"include-from-file\", \"../monica-parameters/crops/potato/moderately early potato.json\"]\n      },\n      \"residueParams\": [\"include-from-file\", \"../monica-parameters/crop-residues/potato.json\"]\n    },\n    \"WW\": {\n      \"cropParams\": {\n        \"species\": [\"include-from-file\", \"../monica-parameters/crops/wheat.json\"],\n        \"cultivar\": [\"include-from-file\", \"../monica-parameters/crops/wheat/winter wheat.json\"]\n      },\n      \"residueParams\": [\"include-from-file\", \"../monica-parameters/crop-residues/wheat.json\"]\n    },\n    \"WG\": {\n      \"cropParams\": {\n        \"species\": [\"include-from-file\", \"../monica-parameters/crops/barley.json\"],\n        \"cultivar\": [\"include-from-file\", \"../monica-parameters/crops/barley/winter barley.json\"]\n      },\n      \"residueParams\": [\"include-from-file\", \"../monica-parameters/crop-residues/barley.json\"]\n    },\n    \"SG\": {\n      \"cropParams\": {\n        \"species\": [\"include-from-file\", \"../monica-parameters/crops/barley.json\"],\n        \"cultivar\": [\"include-from-file\", \"../monica-parameters/crops/barley/spring barley.json\"]\n      },\n      \"residueParams\": [\"include-from-file\", \"../monica-parameters/crop-residues/barley.json\"]\n    },\n    \"SC\": {\n      \"cropParams\": {\n        \"species\": [\"include-from-file\", \"../monica-parameters/crops/rape.json\"],\n        \"cultivar\": [\"include-from-file\", \"../monica-parameters/crops/rape/winter rape.json\"]\n      },\n      \"residueParams\": [\"include-from-file\", \"../monica-parameters/crop-residues/rape.json\"]\n    }\n  },\n\n  \"cropRotation\": [\n    {\n      \"worksteps\": [\n        { \"date\": \"1991-09-23\", \"type\": \"Sowing\", \"crop\": [\"ref\", \"crops\", \"WR\"] },\n        {\n          \"date\": \"1992-05-05\",\n          \"type\": \"Irrigation\",\n          \"amount\": [1.0, \"mm\"],\n          \"parameters\": {\n            \"nitrateConcentration\": [0.0, \"mg dm-3\"],\n            \"sulfateConcentration\": [334, \"mg dm-3\"]\n          }\n        },\n        {\n          \"date\": \"1992-04-03\",\n          \"type\": \"MineralFertilization\",\n          \"amount\": [40.0, \"kg N\"],\n          \"partition\": [\"include-from-file\", \"../monica-parameters/mineral-fertilisers/AN.json\"]\n        },\n        {\n          \"date\": \"1992-05-07\",\n          \"type\": \"MineralFertilization\",\n          \"amount\": [40.0, \"kg N\"],\n          \"partition\": [\"include-from-file\", \"../monica-parameters/mineral-fertilisers/AN.json\"]\n        },\n        { \"date\": \"1992-07-27\", \"type\": \"Harvest\", \"crop\": [\"ref\", \"crops\", \"WR\"] }\n      ]\n    },\n    {\n      \"worksteps\": [\n        {\n          \"date\": \"1993-04-23\",\n          \"type\": \"MineralFertilization\",\n          \"amount\": [125, \"kg N\"],\n          \"partition\": [\"include-from-file\", \"../monica-parameters/mineral-fertilisers/AN.json\"]\n        },\n        { \"date\": \"1993-04-27\", \"type\": \"Tillage\", \"depth\": [0.15, \"m\"] },\n        { \"date\": \"1993-05-04\", \"type\": \"Sowing\", \"crop\": [\"ref\", \"crops\", \"SM\"] },\n        {\n          \"date\": \"1993-05-10\",\n          \"type\": \"MineralFertilization\",\n          \"amount\": [60, \"kg N\"],\n          \"partition\": [\"include-from-file\", \"../monica-parameters/mineral-fertilisers/AN.json\"]\n        },\n        { \"date\": \"1993-09-23\", \"type\": \"Harvest\", \"crop\": [\"ref\", \"crops\", \"SM\"] },\n        {\n          \"date\": \"1993-12-16\",\n          \"type\": \"OrganicFertilization\",\n          \"amount\": [30000, \"kg N\"],\n          \"parameters\": [\"include-from-file\", \"../monica-parameters/organic-fertilisers/CADLM.json\"],\n          \"incorporation\": true\n        },\n        { \"date\": \"1993-12-22\", \"type\": \"Tillage\", \"depth\": [0.1, \"m\"] }\n      ]\n    },\n    {\n      \"worksteps\": [\n        { \"date\": \"1994-04-25\", \"type\": \"Sowing\", \"crop\": [\"ref\", \"crops\", \"MEP\"] },\n        {\n          \"date\": \"1994-05-04\",\n          \"type\": \"MineralFertilization\",\n          \"amount\": [90, \"kg N\"],\n          \"partition\": [\"include-from-file\", \"../monica-parameters/mineral-fertilisers/AN.json\"]\n        },\n        { \"date\": \"1994-09-06\", \"type\": \"Harvest\", \"crop\": [\"ref\", \"crops\", \"MEP\"] },\n        { \"date\": \"1994-09-29\", \"type\": \"Tillage\", \"depth\": [0.15, \"m\"] }\n      ]\n    },\n    {\n      \"worksteps\": [\n        { \"date\": \"1994-10-11\", \"type\": \"Sowing\", \"crop\": [\"ref\", \"crops\", \"WW\"] },\n        {\n          \"date\": \"1995-03-24\",\n          \"type\": \"MineralFertilization\",\n          \"amount\": [60, \"kg N\"],\n          \"partition\": [\"include-from-file\", \"../monica-parameters/mineral-fertilisers/AN.json\"]\n        },\n        {\n          \"date\": \"1995-04-27\",\n          \"type\": \"MineralFertilization\",\n          \"amount\": [40, \"kg N\"],\n          \"partition\": [\"include-from-file\", \"../monica-parameters/mineral-fertilisers/AN.json\"]\n        },\n        {\n          \"date\": \"1995-05-12\",\n          \"type\": \"MineralFertilization\",\n          \"amount\": [60, \"kg N\"],\n          \"partition\": [\"include-from-file\", \"../monica-parameters/mineral-fertilisers/AN.json\"]\n        },\n        { \"date\": \"1995-08-02\", \"type\": \"Harvest\", \"crop\": [\"ref\", \"crops\", \"WW\"] },\n        { \"date\": \"1995-08-03\", \"type\": \"Tillage\", \"depth\": [0.15, \"m\"] }\n      ]\n    },\n    {\n      \"worksteps\": [\n        { \"date\": \"1995-09-07\", \"type\": \"Sowing\", \"crop\": [\"ref\", \"crops\", \"WG\"] },\n        {\n          \"date\": \"1996-03-21\",\n          \"type\": \"MineralFertilization\",\n          \"amount\": [60, \"kg N\"],\n          \"partition\": [\"include-from-file\", \"../monica-parameters/mineral-fertilisers/AN.json\"]\n        },\n        { \"date\": \"1996-04-13\", \"type\": \"Harvest\", \"crop\": [\"ref\", \"crops\", \"WG\"] },\n        { \"date\": \"1996-04-14\", \"type\": \"Tillage\", \"depth\": [0.10, \"m\"] }\n      ]\n    },\n    {\n      \"worksteps\": [\n        { \"date\": \"1996-04-17\", \"type\": \"Sowing\", \"crop\": [\"ref\", \"crops\", \"SG\"] },\n        { \"date\": \"1996-09-10\", \"type\": \"Harvest\", \"crop\": [\"ref\", \"crops\", \"SG\"] },\n        { \"date\": \"1996-09-17\", \"type\": \"Tillage\", \"depth\": [0.10, \"m\"] }\n      ]\n    },\n    {\n      \"worksteps\": [\n        { \"date\": \"1997-04-04\", \"type\": \"Sowing\", \"crop\": [\"ref\", \"crops\", \"SC\"] },\n        {\n          \"date\": \"1997-04-10\",\n          \"type\": \"MineralFertilization\",\n          \"amount\": [80, \"kg N\"],\n          \"partition\": [\"include-from-file\", \"../monica-parameters/mineral-fertilisers/AN.json\"]\n        },\n        { \"date\": \"1997-07-08\", \"type\": \"Harvest\", \"crop\": [\"ref\", \"crops\", \"SC\"] },\n        { \"date\": \"1997-07-09\", \"type\": \"Tillage\", \"depth\": [0.10, \"m\"] }\n      ]\n    }\n  ],\n\n  \"CropParameters\": {\n    \"DEFAULT\": [\"include-from-file\", \"../monica-parameters/user-parameters/hermes-crop.json\"]\n  }\n}\n</code></pre>"},{"location":"user_guide/configuration_files/config_overview/","title":"MONICA Configuration Files","text":""},{"location":"user_guide/configuration_files/config_overview/#general-overview","title":"General overview","text":"<p>MONICA uses a set of configuration files to either parameterize the model or set up all input data necessary to run the model. </p> <p>The following four files are necessary to run the model:</p> <ul> <li>climate.csv</li> <li>sim.json</li> <li>site.json</li> <li>crop.json</li> </ul> <p>The three <code>.json</code> files contain the necessary input information to run the MONICA model. These files contain all information for a model run. Optionally, these files can reference other <code>.json</code> files with actual parameters of the MONICA model (crop, general soil, or general environmental parameters). All necessary data can also be obtained from a SQLite database instead of the <code>.json</code> files. Either way (file or database), at runtime every one of the three <code>.json</code> files (<code>sim.json</code>, <code>site.json</code>, <code>crop.json</code>) will hold all information for a MONICA run. Because of that, it is also possible to manually include all parameters in these three files instead of referencing other parameter files or database data. This makes particular sense if these files are being generated by an external tool for bulk processing.</p> <p>All <code>.json</code> configuration files reflect, to some degree, the data structures internally used in MONICA. In case of missing configuration values, MONICA uses built-in default values. These can usually be taken from the corresponding <code>.h</code> (C++ header file) in the MONICA source code. Real parameters for the MONICA model should all have default values. In contrast, missing input data (e.g., a soil profile in <code>site.json</code>) cannot be compensated for, and MONICA will not run.</p>"},{"location":"user_guide/configuration_files/config_overview/#example-parameter-definition","title":"Example: Parameter definition","text":"<p>In the following JSON code snippet taken from the <code>sim.json</code> example file, two settings are declared: <code>UseAutomaticIrrigation</code> which is set to <code>false</code>, and <code>AutoIrrigationParams</code>, which is set to a JSON object (key/value map). This object/map contains three parameters: <code>irrigationParameters</code>, another JSON object; <code>amount</code>, a JSON array (list of values) <code>[17, \"mm\"]</code>; and <code>threshold</code>, a floating-point (<code>double</code>) value <code>0.35</code>. For <code>amount</code>, MONICA allows a JSON array with two or three elements instead of a simple value like <code>17</code>. The second element (in this case <code>\"mm\"</code>) will be treated as the unit describing the value (<code>17</code>). An optional third value can be added as a description of the value.</p> <p>Note</p> <p>Even though the JSON array syntax can be used to add units of measure and an optional description, this information is  currently ignored by MONICA. It is meant purely as a description of the value. For the correct units of measure and dimensions, please refer to the MONICA documentation or the example files.</p> <pre><code>\"UseAutomaticIrrigation\": false,\n\"AutoIrrigationParams\": {\n  \"irrigationParameters\": {\n    \"nitrateConcentration\": [0, \"mg dm-3\"],\n    \"sulfateConcentration\": [0, \"mg dm-3\"]\n  },\n  \"amount\": [17, \"mm\"],\n  \"threshold\": 0.35\n},\n</code></pre> <p>All necessary data can be included in the configuration files either as (potentially deeply nested) JSON objects or by using a reference and include mechanism to fetch data from a SQLite database or files in the filesystem. Where applicable (e.g., <code>crop.json</code>), JSON objects can be referenced in multiple places.</p>"},{"location":"user_guide/configuration_files/config_overview/#default-values","title":"Default values","text":"<p>Most of the JSON object data that may be included from a database or from a file support an optional key named <code>DEFAULT</code>, which enables the user to load/include data but overwrite some of them manually. In the example below, an <code>EnvironmentParameters</code> JSON object is being defined. It will be initialized completely from a file, but the keys <code>LeachingDepth</code> and <code>WindSpeedHeight</code> will be overwritten. This way, a user can keep rarely changing data in a file and always include them via <code>DEFAULT</code>, while from project to project only a few values need to be changed or updated.</p> <p>Example:</p> <pre><code>\"EnvironmentParameters\": {\n  \"DEFAULT\": [\"include-from-file\", \"../monica-parameters/user-parameters/hermes-environment.json\"],\n  \"LeachingDepth\": 2.0,\n  \"WindSpeedHeight\": 2.5\n}\n</code></pre>"},{"location":"user_guide/configuration_files/config_overview/#functions-in-json","title":"Functions in JSON","text":"<p>Currently, there exists a single mechanism to add some dynamics to the otherwise static configuration files. In the value position of a key/value pair, a JSON array can appear that starts with a string/text value. In that case, upon reading and interpreting the configuration file, MONICA will check internally if there is a function with a name corresponding to the string value. If so, it interprets the whole JSON array as a function call. The first argument represents the function being called, and the rest of the array's elements represent the arguments to this function (similar to function calls in Lisp-style programming languages). The result of this \"function call\" will again be a JSON value (e.g., a JSON object) and will replace the JSON array. If for some reason (e.g., wrong spelling, typo, etc.) no internal function is found, the JSON array remains unchanged; this being the reason for the Lisp-style syntax, to retain a valid JSON document.</p>"},{"location":"user_guide/configuration_files/config_overview/#include-data-from-a-file","title":"Include data from a file","text":"<p>To include data from a file, the example from above would look like the one below. The name of the function is <code>include-from-file</code>, with its only parameter being the path to the file to include. The entire contents of the named file should be valid JSON and will be included. The included JSON data may again contain other functions.</p> <pre><code>\"cropParams\": {\n  \"species\": [\"include-from-file\", \"../monica-parameters/crops/rye.json\"],\n  \"cultivar\": [\"include-from-file\", \"../monica-parameters/crops/rye/winter rye.json\"]\n},\n\"residueParams\": [\"include-from-file\", \"../monica-parameters/crop-residues/rye.json\"]\n</code></pre> <p>In order to keep paths to the files to be included reasonably short and readable, relative paths will be prepended by the contents of the contents of the key <code>include-file-base-path</code>. This key is defined in <code>sim.json</code> and is allowed in <code>crop.json</code> and <code>site.json</code>. In the latter case, a \"local\" definition of <code>include-file-base-path</code> will replace the one in <code>sim.json</code>. By default, <code>include-file-base-path</code> in <code>sim.json</code> is defined as <code>\"${MONICA_PARAMETERS}/\"</code>. This means it will take the value of the environment variable <code>MONICA_PARAMETERS</code>, which after a MONICA installation will point to the directory where all the MONICA parameters were installed (usually something like <code>C:\\\\users\\\\USER_NAME\\\\MONICA\\monica-parameters</code>).</p> <p>Keep in mind that if <code>include-from-file</code> has a relative path as its first parameter, <code>include-file-base-path</code> will be prepended and must resolve to a valid filesystem path. If <code>include-from-file</code>'s first parameter is an absolute path (e.g., starting with <code>C:\\\\</code> on Microsoft Windows or <code>/</code> under Linux), nothing else will be done to the path.</p>"},{"location":"user_guide/configuration_files/config_overview/#reference-data-within-a-file","title":"Reference data within a file","text":"<p>Crops that are defined in <code>crop.json</code> can be referenced multiple times using the <code>ref</code> function. In the example below, taken from the <code>worksteps</code> section of a crop, the Sowing workstep, among other worksteps, uses the key/value pair <code>crop: winter rye</code>. The <code>ref</code> function takes two parameters: the first being a name (<code>\"crops\"</code>) which is a key in the top-level JSON object of the file that also contains another JSON object where the key = <code>WR</code> returns the JSON object to replace the function call. Thus, in the example <code>crop.json</code>, under the key <code>crops</code>, arbitrary crop name shortcuts are mapped to crop parameter objects. The objects themselves can be included by using the <code>include-from-db</code> or <code>include-from-file</code> functions.</p> <pre><code>{ \"date\": \"1991-09-23\", \"type\": \"Sowing\", \"crop\": [\"ref\", \"crops\", \"WR\"] },\n</code></pre>"},{"location":"user_guide/configuration_files/config_overview/#other-functions","title":"Other functions","text":"Function Name Parameter 1 (Example) Parameter 2 (Example) Description <code>\"humus-class-&gt;corg\"</code> humus class (1) - Converts the humus class to Corg value <code>\"bulk-density-class-&gt;raw-density\"</code> effective bulk density class (1-5) clay content (0.0-1.0) Converts the effective bulk density, given the clay content, to raw density <code>\"KA5-texture-class-&gt;clay\"</code> KA5 texture class (fSms) - Returns the average clay content given the KA5 texture class <code>\"KA5-texture-class-&gt;sand\"</code> KA5 texture class (Lt3) - Returns the average sand content given the KA5 texture class <code>\"sand-and-clay-&gt;lambda\"</code> sand content (0.0-1.0) clay content (0.0-1.0) Calculates the lambda value given sand and clay content <p>As shown in the following example taken from <code>site.json</code>, the function calls can be nested:</p> <pre><code>\"SoilRawDensity\": [\"bulk-density-class-&gt;raw-density\", 2, [\"KA5-texture-class-&gt;clay\", \"Sl2\"]],\n\"Lambda\": [\"sand-and-clay-&gt;lambda\", [\"KA5-texture-class-&gt;sand\", \"Sl2\"], [\"KA5-texture-class-&gt;clay\", \"Sl2\"]]\n</code></pre>"},{"location":"user_guide/configuration_files/config_overview/#json-data-format","title":"JSON data format","text":"<p>Currently, MONICA uses JSON as the format for its files. Please ensure that you adhere to the rules and formatting conventions of JSON! To check and/or reformat existing code, tools like this online JSON Viewer or this JSON Formatter can be used.</p> <p>Warning</p> <p>JSON has no syntax for comments, it is a pure data format. To make the configuration files more self-descriptive while keeping them valid JSON files, comments are encoded as keys beginning with two underscores <code>__</code> and an empty string <code>\"\"</code> as their value. This method can also be used to comment out structures that should currently not be used, simply by making a key invalid (e.g., adding an underscore character in front, <code>_</code>, or renaming it to a name unknown to MONICA).</p>"},{"location":"user_guide/configuration_files/config_sim_json/","title":"The <code>sim.json</code> configuration file","text":"<p>The <code>sim.json</code> file contains simulation-specific information such as the start and end date (MONICA will select the appropriate climate data from <code>climate.csv</code>) and whether certain global toggles, such as nitrogen response or the use of secondary yields, are turned on or off.</p> <p><code>NumberOfLayers</code> and <code>LayerThickness</code> should not be changed at this time.</p>"},{"location":"user_guide/configuration_files/config_sim_json/#reading-climate-data-climatecsv-options","title":"Reading climate data (<code>climate.csv-options</code>)","text":"<p>Climate data are stored in <code>.csv</code> files. The <code>climate.csv-options</code> object in <code>sim.json</code> configures how they are read.  The time range for a MONICA run is defined by the keys <code>start-date</code> and <code>end-date</code> inside the <code>climate.csv-options</code> JSON object. If these keys are not present, the time range is taken directly from <code>climate.csv</code>.</p> <p>The key <code>no-of-climate-file-header-lines</code> defines how many lines will be skipped at the beginning of the file, as there may be no header (0), only column names (1), or multiple header lines (e.g., including units). The <code>csv-separator</code> key defines which character separates columns and values. In a Comma Separated Values (CSV) file, this is usually a <code>,</code>, but it could also be a tab <code>\\t</code>, space, or another character.</p> <p>MONICA accepts Available Climate Data (ACD) names for the climate input. These names are case-sensitive.</p> ACD element Description Example Unit <code>day</code> Day of year 5 <code>month</code> Month of year 11 <code>year</code> Year 2017 <code>iso-date</code> ISO date format 2017-11-05 <code>de-date</code> German date format 05.11.2017 <code>tmin</code> Minimum daily temperature -2 \u00b0C <code>tavg</code> Average daily temperature 15.3 \u00b0C <code>tmax</code> Maximum daily temperature 34.7 \u00b0C <code>precip</code> Daily precipitation 2.3 mm <code>globrad</code> Global radiation 27.431 MJ m-2 <code>sunhours</code> Hours of sunshine (better use <code>globrad</code>) 8.5 h <code>wind</code> Wind speed 6.7 m s-1 <code>relhumid</code> Relative humidity 90.0 % <code>skip</code> Skip an existing element <p>Unknown column headers are skipped automatically. The <code>skip</code> ACD can be used explicitly to ignore known elements, for example, if there are multiple columns for the same type of climate variable. </p> <p>To use any climate dataset without modifying the original file, column names can be mapped to the corresponding ACD names using the <code>header-to-acd-names</code> object. Its key/value pairs define these mappings.</p> <p>Additionally, the value in this mapping can be a JSON array containing two elements \u2013 an arithmetic operation (<code>+</code>, <code>-</code>, <code>*</code>, <code>/</code>) and a number. In that case, the operation is applied to the values in that column. In the example below, if the <code>.csv</code> file contains a column <code>global_radiation</code> in <code>J cm-2</code>, it can be mapped to <code>globrad</code> (MONICA's internal ACD name) and multiplied (<code>*</code>) by 100.0 to convert to MJ m-2.</p> <pre><code>\"climate.csv-options\": {\n  \"__given the start and end date, monica will run just this time range, else the full time range given by supplied climate data\": \"\",\n  \"start-date\": \"1991-01-01\",\n  \"end-date\": \"1997-12-31\",\n\n  \"no-of-climate-file-header-lines\": 1,\n  \"csv-separator\": \",\",\n  \"header-to-acd-names\": {\n    \"DE-date\": \"de-date\",\n    \"global_radiation\": \"globrad\",\n    \"global_radiation\": [\"*\", 100.0]\n}\n</code></pre>"},{"location":"user_guide/configuration_files/config_sim_json/#outputting-results-from-monica","title":"Outputting results from MONICA","text":"<p>All results from a MONICA run can be written to a CSV file. Which results are written, and how they are aggregated, is configured in <code>sim.json</code> under the key <code>output</code>.</p> <p>The following table describes several available options which can be set:</p> Key Description Example/Default Value <code>path-to-output</code> Path to directory for output files <code>./</code> (current directory) <code>write-file?</code> Whether to write an output file to \"path-to-output\" <code>true</code> or <code>false</code> <code>include-header-row</code> Include header row in the output <code>true</code> or <code>false</code> <code>include-units-row</code> Include a row with units <code>true</code> or <code>false</code> <code>include aggregation-rows</code> Include two rows showing a) the expression which requested an output and b) what MONICA interpreted (for debugging purposes) <code>true</code> or <code>false</code> <code>csv-separator</code> Separator character <code>,</code> <code>events</code> A list of pairs, which describe the events on which MONICA is requested to output a list of results"},{"location":"user_guide/configuration_files/config_sim_json/#defining-events","title":"Defining events","text":"<p>The <code>events</code> key defines the list of MONICA results to be written to the output. Each event is specified as a pair, consisting of an event definition followed by the corresponding list of outputs. </p> <p>Events are defined inside a JSON array and can take one of the following forms: </p> <ul> <li>A simple string such as <code>\"daily\"</code>, </li> <li>A JSON array, or </li> <li>A full JSON object that explicitly describes the conditions under which outputs should be generated. </li> </ul> <p>Strings and JSON arrays serve as shortcuts for more complex JSON objects that describe the triggering conditions for generating output.</p> <p>The event structure allows specification of:</p> <ol> <li>When to start and end outputting results (<code>start</code> and <code>end</code> keys)</li> <li>Time ranges to aggregate results (<code>from</code> and <code>to</code> keys)</li> <li>Points at which time or condition to write results (non-aggregated)</li> <li>Periods while conditions are true (for conditional aggregation)</li> </ol> <p>ISO dates can include placeholders (<code>x</code>). Every possible value for the year, month, or day of the placeholder is used. For example, <code>xxxx-xx-15</code> means every 15th day of each month.</p>"},{"location":"user_guide/configuration_files/config_sim_json/#available-events","title":"Available events","text":"<p>In addition to date patterns, each workstep generates an event with the same name (e.g., <code>Sowing</code>, <code>Harvest</code>, <code>AutomaticSowing</code>, <code>SetValue</code>, etc.).</p> <p>Common events include:</p> <ul> <li>run-started</li> <li>Stage-1, Stage-2, ... </li> <li>emergence</li> <li>anthesis</li> <li>cereal-stem-elongation</li> <li>maturity</li> <li>Sowing, AutomaticSowing, Cutting, etc.</li> </ul> <p>The following table shows examples of some event expressions, their shortcut forms, and their expanded equivalents:</p> Shortcut Expanded form Meaning <code>{\"start\": \"xxxx-05-01\", \"end\": \"xxxx-07-31\", \"at\": \"xxxx-xx-15\"}</code> Output results on the 15th of each month from May to July \u2013 daily results will be written <code>{\"from\": \"Sowing\", \"to\": \"anthesis\", \"while\": [\"ETa/ETc\", \"&lt;\", 0.4]}</code> Output aggregated results from the <code>Sowing</code> event until (and including) the <code>anthesis</code> event, but only while actual to potential evapotranspiration is below 0.4 <code>\"xxxx-03-31\"</code> <code>{\"at\": \"xxxx-03-31\"}</code> Write results every March 31st <code>\"daily\"</code> <code>{\"at\": \"xxxx-xx-xx\"}</code> Write daily results <code>\"monthly\"</code> <code>{\"from\": \"xxxx-xx-01\", \"to\": \"xxxx-xx-31\"}</code> Write monthly aggregated results <code>\"yearly\"</code> <code>{\"from\": \"xxxx-01-01\", \"to\": \"xxxx-12-31\"}</code> Write yearly aggregated results <code>\"run\"</code> <code>{\"from\": &lt;start-date&gt;, \"to\": &lt;end-date&gt;}</code> Write results aggregated over the entire simulation run <code>\"crop\"</code> <code>{\"from\": \"Sowing\", \"to\": \"Harvest\"}</code> Write results aggregated over the cropping period <code>[\"while\", \"Stage\", \"=\", 5]</code> <code>{\"while\": [\"Stage\", \"=\", 5]}</code> Write results aggregated only while <code>Stage</code> equals 5 <code>[\"at\", \"Stage\", \"=\", 2]</code> <code>{\"at\": [\"Stage\", \"=\", 2]}</code> Write results daily when <code>Stage</code> equals 2 <code>[[\"Mois\", 1], \"&lt;\", 0.5]</code> <code>{\"at\": [\"Mois\", 1], \"&lt;\", 0.5]}</code> Write results daily when the soil moisture in the first layer is below 0.5 <code>\"Sowing\"</code> <code>{\"at\": \"Sowing\"}</code> Write results at sowing time <p>As shown in the table above, simple comparison expressions can be used in events. The available operators are <code>&lt;</code>, <code>&lt;=</code>, <code>=</code>, <code>&gt;=</code>, <code>&gt;</code>. Output expressions such as <code>\"Stage\"</code> or <code>[\"Mois\", 1]</code>, as well as numeric values (e.g., 1), can be used on both sides of these operators.</p>"},{"location":"user_guide/configuration_files/config_sim_json/#list-of-outputs","title":"List of outputs","text":"<p>After defining events (i.e., when to output), you must specify what to output.  Some examples of outputs already appeared in the previous table, such as <code>[\"at\", \"Stage\", \"=\", 2]</code> or <code>[[\"Mois\", 1], \"&lt;\", 0.5]</code>. <code>\"Stage\"</code> outputs the current development stage of the plant, while <code>[\"Mois\", 1]</code> outputs the soil moisture in the first 10 cm soil layer. </p> <p>MONICA supports three categories of outputs:</p> <ol> <li>Scalar values (e.g., <code>\"Stage\"</code>)</li> <li>Array values for soil layers (e.g., <code>\"Mois\"</code>, which consists of 20 values representing soil moisture in all layers)</li> <li>Array values for crop organs (e.g., <code>[\"OrgBiom\", \"Root\"]</code>)</li> </ol> <p>MONICA currently uses 20 soil layers of 10 cm each (total depth 2 m). When outputs refer to layers, they can specify:</p> <ul> <li>a single layer (e.g., <code>15</code> for the 15th layer, corresponding to 1.5 m depth),</li> <li>a range of layers (e.g., <code>[1, 5]</code> for layers 1 to 5, corresponding to 0 to 0.5 m depth),</li> <li>or a crop organ (e.g., <code>\"Root\"</code>, <code>\"Leaf\"</code>, <code>\"Shoot\"</code>, <code>\"Fruit\"</code>, <code>\"Struct\"</code>, <code>\"Sugar\"</code>).</li> </ul> <p>Additionally, the user must tell MONICA whether ranges of values (in arrays) should be output as multiple scalars or aggregated into a single value. If aggregation is applied, the aggregation method must also be specified. </p> <p>The available aggregation operations are: <code>AVG</code>, <code>MEDIAN</code>, <code>SUM</code>, <code>MIN</code>, <code>MAX</code>, <code>FIRST</code>, <code>LAST</code>, <code>NONE</code>. </p> <p>Aggregation can occur on a daily basis to aggregate soil layers into a single scalar value (the default operation for layer aggregation is <code>NONE</code>) or over a time range, e.g. to aggregate monthly values, where the default operation in this case is <code>AVG</code>.</p> Aggregation reason Default operation Meaning Aggregate soil layers into scalar value <code>NONE</code> If no aggregation operation is specified, the selected range of layer values will be output as individual values. Aggregate time range <code>AVG</code> If an event defines an aggregation time range and no aggregation operation is specified (value 2 or 3 in the JSON array), the temporarily collected daily values will be averaged. <p>To understand aggregation operations, imagine that all values to be aggregated (e.g., <code>Runoff</code>) are stored temporarily in a list during the <code>from</code>/<code>to</code> period . After the <code>to</code> time range ends, the specified aggregation operation is applied to this list. For example, <code>AVG</code> will calculate the mean of all values, while <code>FIRST</code> will return the first value in the list \u2013 the value from the start (<code>from</code> day) of the aggregation period.</p> <p>The user specifies an output either by simply defining the output name (e.g., <code>\"Stage\"</code>, <code>\"Crop\"</code>, or <code>\"Date\"</code>) or by using a JSON array, where the first element of the array is the aforementioned output name. It is also possible to append a display name to the output name, separated by the character <code>|</code>. This display name will be used in the output instead of the result name. For example, <code>\"DOY|MatDOY\"</code> will output <code>MatDOY</code> instead of <code>DOY</code>, which may be more descriptive. </p> <p>The second element in the array can specify one of the following:</p> <ul> <li>the selected soil layer, </li> <li>a range of layers, </li> <li>a crop organ (for array values), or </li> <li>an aggregation operation (for scalar values). </li> </ul> <p>If omitted, the aggregation operation defaults to <code>NONE</code>. </p> <p>For array outputs, a third element can define the aggregation operation. The second element can be:</p> <ul> <li>a single number (e.g., the soil layer number), </li> <li>a string describing the crop organ, or </li> <li>an array that describes a layer range (for soil layers only). </li> </ul> <p>In the latter case, the first value of the array is the starting layer, the second the ending layer (inclusive), and an optional third value specifies the aggregation operation. If the range includes an aggregation operation, MONICA will apply it and store a single aggregated value each time output is requested. Otherwise, individual layer values will be listed in the output, each labeled with the result name and the corresponding layer number (e.g., <code>Mois_1</code>, <code>Mois_2</code>, etc.). </p> <p>The following examples show the possible variations:</p> Output definition Meaning <code>\"Date\"</code> Output the ISO date (e.g., <code>2017-01-17</code>) <code>[\"Year\", \"LAST\"]</code> Output the year at the <code>to</code> time \u2013 the year at the end of the aggregation period <code>[\"PercolationRate\\|WDrain\", 15, \"SUM\"]</code> Output the sum of percolation rates in soil layer 15 (1.5 m) during the aggregation period, and rename it in the output as <code>WDrain</code> (<code>SUM</code> requires an event to specify the aggregation time range.) <code>[\"Mois\", [1, 20]]</code> Output the daily soil moisture of all 20 soil layers. The outputs will be labeled \"Mois_1\", \"Mois_2\", etc. <code>[\"OrgBiom\", \"Leaf\"]</code> Output the daily organic biomass of leaves <code>[\"SOC\", [1, 3, \"AVG\"]]</code> Output the daily soil organic carbon as a single value averaged across the first three soil layers <code>[\"Precip\", \"SUM\"]</code> Output the sum of precipitation values within a given aggregation time range <p>In the generated output file, the order of the results follows the sequence defined in the <code>events</code> list and can be relied upon. </p> <p>The example below shows an output section that produces an equivalent file to the <code>rmout</code> file from MONICA version 1. It also includes a commented out (<code>__events</code>) example of outputs used in the EU MACSUR Heat Stress study.</p> <pre><code>\"output\": {\n  \"write-file?\": false,\n  \"file-name\": \"out.csv\",\n\n  \"csv-options\": {\n    \"include-header-row\": true,\n    \"include-units-row\": true,\n    \"include-aggregation-rows\": true,\n    \"csv-separator\": \",\"\n  },\n\n  \"__events\": [\n    \"crop\", [\n      [\"Year\", \"LAST\"],\n      [\"DOY|SowDOY\", \"FIRST\"],\n      [\"LAI|MaxLAI\", \"MAX\"],\n      [\"PercolationRate|WDrain\", 15, \"SUM\"],\n      [\"Act_ET|CumET\", \"SUM\"],\n      [\"Act_Ev|Evap\", \"SUM\"],\n      [\"Mois|SoilAvW\", [1, 15, \"SUM\"], \"LAST\"],\n      [\"Runoff\", \"SUM\"],\n      [\"ET0|Eto\", \"SUM\"],\n      [\"Tmax|TMAXAve\", \"AVG\"],\n\n      [\"Yield\", \"LAST\"],\n      [\"AbBiom|Biom-ma\", \"LAST\"],\n      [\"AbBiomN|CroN-ma\", \"LAST\"],\n      [\"GrainN\", \"LAST\"]\n    ],\n\n    [\"while\", \"Stage\", \"=\", 5], [\n      [\"DOY|AntDOY\", \"FIRST\"],\n      [\"AbBiom|Biom-an\", \"First\"],\n      [\"AbBiomN|CroN-an\", \"FIRST\"]\n    ],\n\n    [\"while\", \"Stage\", \"=\", 7], [\n      [\"Yield\", \"FIRST\"],\n      [\"DOY|MatDOY\", \"FIRST\"],\n      [\"AbBiom|Biom-ma\", \"First\"],\n      [\"AbBiomN|CroN-ma\", \"FIRST\"],\n      [\"GrainN\", \"FIRST\"]\n    ],\n\n    [\"while\", \"Stage\", \"=\", 2], [\n      [\"DOY|EmergDOY\", \"FIRST\"]\n    ]\n  ],\n\n  \"events\" : [\n    \"daily\", [\n      \"Date\", \"Crop\", \"TraDef\", \"Tra\", \"NDef\", \"HeatRed\", \"FrostRed\", \"OxRed\",\n      \"Stage\", \"TempSum\", \"VernF\", \"DaylF\",\n      \"IncRoot\", \"IncLeaf\", \"IncShoot\", \"IncFruit\",\n      \"RelDev\", \"LT50\", \"AbBiom\",\n      [\"OrgBiom\", \"Root\"], [\"OrgBiom\", \"Leaf\"], [\"OrgBiom\", \"Shoot\"],\n      [\"OrgBiom\", \"Fruit\"], [\"OrgBiom\", \"Struct\"], [\"OrgBiom\", \"Sugar\"],\n      \"Yield\", \"SumYield\", \"GroPhot\", \"NetPhot\", \"MaintR\", \"GrowthR\",   \"StomRes\",\n      \"Height\", \"LAI\", \"RootDep\", \"EffRootDep\", \"TotBiomN\", \"AbBiomN\", \"SumNUp\",\n      \"ActNup\", \"PotNup\", \"NFixed\", \"Target\", \"CritN\", \"AbBiomNc\", \"YieldNc\",\n      \"Protein\",\n      \"NPP\", [\"NPP\", \"Root\"], [\"NPP\", \"Leaf\"], [\"NPP\", \"Shoot\"],\n      [\"NPP\", \"Fruit\"], [\"NPP\", \"Struct\"], [\"NPP\", \"Sugar\"],\n      \"GPP\",\n      \"Ra\",\n      [\"Ra\", \"Root\"], [\"Ra\", \"Leaf\"], [\"Ra\", \"Shoot\"], [\"Ra\", \"Fruit\"],\n      [\"Ra\", \"Struct\"], [\"Ra\", \"Sugar\"],\n      [\"Mois\", [1, 20]], \"Precip\", \"Irrig\", \"Infilt\", \"Surface\", \"RunOff\", \"SnowD\", \"FrostD\",\n      \"ThawD\", [\"PASW\", [1, 20]], \"SurfTemp\", [\"STemp\", [1, 5]],\n      \"Act_Ev\", \"Act_ET\", \"ET0\", \"Kc\", \"AtmCO2\", \"Groundw\", \"Recharge\", \"NLeach\",\n      [\"NO3\", [1, 20]], [\"Carb\", 0], [\"NH4\", [1, 20]], [\"NO2\", [1, 4]],\n      [\"SOC\", [1, 6]], [\"SOC-X-Y\", [1, 3, \"SUM\"]], [\"SOC-X-Y\", [1, 20, \"SUM\"]],\n      [\"AOMf\", 1], [\"AOMs\", 1], [\"SMBf\", 1], [\"SMBs\", 1], [\"SOMf\", 1],\n      [\"SOMs\", 1], [\"CBal\", 1], [\"Nmin\", [1, 3]], \"NetNmin\", \"Denit\", \"N2O\", \"SoilpH\",\n      \"NEP\", \"NEE\", \"Rh\", \"Tmin\", \"Tavg\", \"Tmax\", \"Wind\", \"Globrad\", \"Relhumid\", \"Sunhours\",\n      \"NFert\"\n    ]\n  ]\n}\n</code></pre> <p>Below you will find a simplified example of a complete <code>sim.json</code> file focused on output configuration.</p> <pre><code>{\n  \"climate.csv-options\": {\n        \"__given the start and end date, monica will run just this time range, else the full time range given by supplied climate data\": \"\",\n        \"start-date\": \"1991-01-01\",\n        \"end-date\": \"1997-12-31\",\n\n        \"no-of-climate-file-header-lines\": 1,\n        \"csv-separator\": \",\",\n        \"header-to-acd-names\": {\n            \"DE-date\": \"de-date\"\n        }\n    },\n\n  \"output\": {\n      \"write-file?\": false,\n        \"file-name\": \"out.csv\",\n\n        \"__how to write and what to include in monica CSV output\": \"\",\n        \"csv-options\": {\n            \"include-header-row\": true,\n            \"include-units-row\": true,\n            \"include-aggregation-rows\": true,\n            \"csv-separator\": \",\"\n        },\n\n        \"__what data to include in the monica output according to the events defined by the keys\": \"\",\n        \"events\" : [\n            \"monthly\", [\n                \"Year\", \"Month\",\n                [\"SOC\", [1, 1, \"AVG\"]], [\"SOC\", [1, 3, \"AVG\"]],\n                [\"WaterContent\", [1, 9, \"AVG\"]], \"Recharge\", \"NLeach\",\n                [\"SnowD\", \"MAX\"], [\"SnowD\", \"SUM\"], [\"FrostD\", \"SUM\"],\n                [\"RunOff\", \"SUM\"], [\"NH3\", \"SUM\"], [\"Precip\", \"SUM\"], \"Act_ET\"\n            ],\n\n            \"yearly\", [\n                \"Year\",\n                [\"N\", [1, 3]],\n                [\"RunOff\", \"SUM\"],\n                [\"NLeach\", \"SUM\"],\n                [\"Recharge\", \"SUM\"]\n            ],\n\n            \"run\", [[\"Precip\", \"SUM\"]],\n\n            \"harvesting\", [\"Crop\", [\"OrgBiom\", \"Fruit\"], \"Yield\"],\n        ]\n    },\n\n  \"NumberOfLayers\": 20,\n  \"LayerThickness\": [0.1, \"m\"],\n\n  \"UseSecondaryYields\": true,\n  \"NitrogenResponseOn\": true,\n  \"WaterDeficitResponseOn\": true,\n  \"EmergenceMoistureControlOn\": true,\n  \"EmergenceFloodingControlOn\": true,\n  \"FrostKillOn\": true,\n\n  \"UseAutomaticIrrigation\": false,\n  \"AutoIrrigationParams\": {\n    \"irrigationParameters\": {\n      \"nitrateConcentration\": [0, \"mg dm-3\"],\n      \"sulfateConcentration\": [0, \"mg dm-3\"]\n    },\n    \"amount\": [17, \"mm\"],\n    \"threshold\": 0.35\n  },\n\n  \"UseNMinMineralFertilisingMethod\": false,\n  \"NMinUserParams\": { \"min\": 0, \"max\": 0, \"delayInDays\": 0 },\n  \"NMinFertiliserPartition\": {\n    \"id\": \"my AN\",\n    \"name\": \"my very own ammonium nitrate variant\",\n    \"Carbamid\": 0,\n    \"NH4\": 0,\n    \"NO3\": 0\n  }\n}\n</code></pre>"},{"location":"user_guide/configuration_files/config_sim_json/#allowed-output-variables","title":"Allowed output variables","text":"<p>The most up-to-date list of available and allowed output names can be found directly in the MONICA source code, in the file <code>build-output.cpp</code>. There, you will find entries such as:</p> <pre><code>build({id++, \"Date\", \"\", \"output current date\"},\n...\nbuild({id++, \"TraDef\", \"0;1\", \"TranspirationDeficit\"},\n</code></pre> <p>In this example, <code>Date</code> and <code>TraDef</code> are allowed output names. Additionally, the code lists the expected units of measure (if defined) and provides a description for each output variable.</p> Output name (L)ayers/(O)rgans Setttable? Unit Description <code>Count</code> Output constant value 1 (can be used for counting records or events) <code>CM-count</code> Order number of the current cultivation method <code>Date</code> Current date <code>days-since-start</code> Number of days since simulation start <code>DOY</code> Current day of year <code>Month</code> Current month number (1-12) <code>Year</code> Current year <code>Crop</code> Crop name <code>TraDef</code> 0;1 Transpiration deficit index (<code>1</code>= no stress, <code>0</code> = maximum stress) <code>Tra</code> mm Actual transpiration <code>NDef</code> 0;1 Nitrogen deficit index, indicates N availability (<code>1</code> = no stress, <code>0</code> = no N available) <code>HeatRed</code> 0;1 Heat stress reductor <code>FrostRed</code> 0;1 Frost stress reductor <code>OxRed</code> 0;1 Oxygen deficit reductor <code>Stage</code> Phenological development stage <code>TempSum</code> \u00b0Cd Accumulated temperature sum <code>VernF</code> 0;1 Vernalisation factor <code>DaylF</code> 0;1 Daylength factor <code>IncRoot</code> kg ha-1 Growth increment of root <code>IncLeaf</code> kg ha-1 Growth increment of leaf <code>IncShoot</code> kg ha-1 Growth increment of shoot <code>IncFruit</code> kg ha-1 Growth increment of fruit <code>RelDev</code> 0;1 Relative total development <code>LT50</code> \u00b0C Crop's lethal temperature at which 50% of plants die <code>AbBiom</code> kg ha-1 Aboveground biomass <code>OrgBiom</code> O kgDM ha-1 Biomass of individual crop organs (e.g, Root, Leaf, Shoot, Fruit) <code>Yield</code> kgDM ha-1 Primary harvested yield <code>sumExportedCutBiomass</code> kgDM ha-1 Total exported biomass across all cuts for the current crop <code>exportedCutBiomass</code> kgDM ha-1 Exported biomass from the current crop at the current cut <code>sumResidueCutBiomass</code> kgDM ha-1 Total residue biomass across all cuts for the current crop <code>residueCutBiomass</code> kgDM ha-1 Residue biomass from the current crop at the current cut <code>GroPho</code> kgCH2O ha-1 Gross photosynthesis rate per hectare <code>NetPhot</code> kgCH2O ha-1 Net photosynthesis per hectare <code>MaintR</code> kgCH2O ha-1 Maintenance respiration rate per hectare (from AGROSIM) <code>GrowthR</code> kgCH2O ha-1 Growth respiration rate per hectare (from AGROSIM) <code>StomRes</code> s m-1 Stomata resistance <code>Height</code> m Crop height <code>LAI</code> m2 m-2 Leaf Area Index <code>RootDep</code> layer# Rooting depth <code>EffRootDep</code> m Depth of the maximum active and effective root <code>TotBiomN</code> kgN ha-1 Total nitrogen content in biomass <code>AbBiomN</code> kgN ha-1 Aboveground nitrogen content in biomass <code>SumNUp</code> kgN ha-1 Cumulative actual nitrogen uptake by the crop <code>ActNup</code> kgN ha-1 Actual nitrogen uptake <code>PotNup</code> kgN ha-1 Potential nitrogen uptake <code>NFixed</code> kgN ha-1 Nitrogen input by the crop via atmospheric fixation <code>Target</code> kgN ha-1 Target nitrogen concentration <code>CritN</code> kgN ha-1 Critical nitrogen concentration <code>AbBiomNc</code> kgN ha-1 (kg ha-1)-1 Nitrogen concentration in aboveground biomass <code>Nstress</code> - Nitrogen stress index, indicates N availability (<code>1</code> = no stress, <code>0</code> = no N available) <code>YieldNc</code> kgN ha-1 Nitrogen concentration in primary yield <code>Protein</code> kg kg-1 Raw protein concentration <code>NPP</code> kgC ha-1 Net Primary Production (NPP) <code>NPP-Organs</code> O kgC ha-1 Organ-specific Net Primary Production (NPP) <code>GPP</code> kgC ha-1 Gross Primary Production (GPP) <code>Ra</code> kgC ha-1 Autotrophic respiration <code>Ra-Organs</code> O kgC ha-1 Organ-specific autotrophic respiration <code>Mois</code> L x m3 m-3 Soil moisture content per layer <code>Irrig</code> mm Irrigation amount applied <code>Infilt</code> mm Amount of water that infiltrates into top soil layer <code>Surface</code> mm Surface water storage <code>RunOff</code> mm Surface water runoff for the current day <code>SnowD</code> mm Snow depth <code>FrostD</code> m Frost front depth in soil <code>ThawD</code> m Thaw front depth in soil <code>PASW</code> L m3 m-3 Plant available soil water per layer <code>SurfTemp</code> \u00b0C Soil surface temperature <code>STemp</code> L \u00b0C Soil temperature by layer <code>Act_Ev</code> mm Actual evaporation <code>Pot_ET</code> mm Potential evapotranspiration = ET0 * Kc = the plants water use <code>Act_ET</code> mm Actual evapotranspiration = actual transpiration + actual evaporation + evaporation from interception + evaporation from surface <code>ET0</code> mm Reference evapotranspiration <code>Kc</code> Plant coefficient to calculate with ET0 the plants water use (ET0 * Kc) <code>AtmCO2</code> ppm Atmospheric CO<sub>2</sub> concentration in the atmosphere <code>Groundw</code> m Groundwater table depth <code>Recharge</code> mm Groundwater recharge <code>NLeach</code> kgN ha-1 Nitrogen leaching below the root zone <code>NO3</code> L x kgN m-3 Soil nitrate (NO<sub>3</sub>) per layer <code>Carb</code> L x kgN m-3 Soil carbamide per layer <code>NH4</code> L x kgN m-3 Soil ammonium (NH<sub>4</sub>) per layer <code>NO2</code> L x kgN m-3 Soil nitrite (NO<sub>2</sub>) per layer <code>SOC</code> L kgC kg-1 Soil organic carbon content per layer <code>SOC-X-Y</code> L gC m-2 Soil organic carbon stock between soil layers X and Y. (SOC * bulk density * layer thickness * 1000) <code>AOMf</code> L kgC m-3 Sum of added organic matter (AOM) fast pool carbon content <code>AOMs</code> L kgC m-3 Sum of added organic matter (AOM) slow pool carbon content <code>SMBf</code> L kgC m-3 Soil microbial biomass (SMB) fast pool carbon content <code>SMBs</code> L kgC m-3 Soil microbial biomass (SMB) slow pool carbon content <code>SOMf</code> L kgC m-3 Soil organic matter (SOM) fast pool carbon content <code>SOMs</code> L kgC m-3 Soil organic matter (SOM) slow pool carbon content <code>CBal</code> L kgC m-3 Carbon balance per layer <code>Nmin</code> L kgN ha-1 Net nitrogen mineralisation rate per layer <code>NetNmin</code> kgN ha-1 Net nitrogen mineralisation rate for the layers defined in the parameter <code>MaxMineralizationDepth</code> (see <code>general/soil-organic.json</code>) <code>Denit</code> kgN ha-1 Amount of N resulting from denitrification <code>actnitrate</code> kgN m-3 N production rate resulting from nitrification (N<sub>2</sub>O STICS module) <code>N2O</code> kgN ha-1 Total N<sub>2</sub>O produced (MONICA's original approach) <code>N2Onit</code> kgN ha-1 N<sub>2</sub>O produced through nitrification (N<sub>2</sub>O STICS module) <code>N2Odenit</code> kgN ha-1 N<sub>2</sub>O produced through denitrification (N<sub>2</sub>O STICS module) <code>SoilpH</code> Soil pH <code>NEP</code> kgC ha-1 Net Ecosystem Production (NEP) <code>NEE</code> kgC ha- Net Ecosystem Exchange (NEE) <code>Rh</code> kgC ha- Daily decomposer respiration <code>Tmin</code> \u00b0C Minimum daily air temperature <code>Tavg</code> \u00b0C Mean daily air temperature <code>Tmax</code> \u00b0C Maximum daily air temperature <code>Precip</code> mm Precipitation <code>Wind</code> m s-1 Wind speed <code>Globrad</code> MJ m-2 Global radiation <code>Relhumid</code> % Relative humidity <code>Sunhours</code> h Sunshine duration <code>BedGrad</code> 0;1 Fractional soil coverage <code>N</code> L kgN m-3 Mineral nitrogen content in soil <code>Co</code> L kgC m-3 Soil organic carbon concentration per soil layer <code>NH3</code> kgN ha-1 Ammonia (NH<sub>3</sub>) volatilisation <code>NFert</code> kgN ha-1 Daily nitrogen fertiliser input <code>WaterContent</code> L fraction nFC Fraction of usable field capacity: PASW/(FC-PWP) <code>CapillaryRise</code> L mm Capillary rise <code>PercolationRate</code> L mm Percolation rate <code>SMB-CO2-ER</code> L Soil microbial biomass (SMB) CO<sub>2</sub> evolution rate <code>Evapotranspiration</code> mm Remaining evapotranspiration after evaporation of intercepted water <code>Evaporation</code> mm Evaporation from intercepted water <code>ETa/ETc</code> Ratio of actual to potential evapotranspiration <code>Act_ET/Pot_ET</code> (actual evapotranspiration/potential evapotranspiration) <code>Transpiration</code> mm Actual transpiration <code>GrainN</code> kg ha-1 Nitrogen content of harvested grains <code>Fc</code> L m3 m-3 Field capacity <code>Pwp</code> L m3 m-3 Permanent wilting point <code>Nresid</code> kgN ha-1 Nitrogen content in crop residues <code>Sand</code> L kg kg-1 Soil sand content <code>Clay</code> L kg kg-1 Soil clay content <code>Silt</code> L kg kg-1 Soil silt content <code>Stone</code> L kg kg-1 Soil stone content <code>pH</code> L kg kg-1 Soil pH per layer <code>rootDensity</code> L Root density in soil layer <code>rootingZone</code> Current rooting zone, the soil layer into which roots are growing"},{"location":"user_guide/configuration_files/config_sim_json/#automatic-irrigation-trigger","title":"Automatic irrigation trigger","text":"<p>Automatic irrigation can be enabled or disabled using the <code>UseAutomaticIrrigation</code> key (set to <code>true</code> or <code>false</code>). If the key <code>amount</code> is defined, a fixed amount of irrigation water will be applied. Alternatively, if <code>set_to_%nFC</code> is specified, the soil moisture of the affected layers (up to the depth defined by <code>calc_nFC_until_depth_m</code>) will be set to the given percentage of available soil water. The trigger becomes active only when a crop is currently growing and MONICA's internal current temperature sum is between <code>HeatSumIrrigationStart</code> and <code>HeatSumIrrigationEnd</code>. Both parameters are defined in the cultivar JSON file of the active crop.</p> Key Default value Unit Description <code>\"UseAutomaticIrrigation\"</code> <code>true</code> or <code>false</code> Enables or disables automatic irrigation <code>\"nitrateConcentration\"</code> 0 mg dm-3 Nitrate concentration in irrigation water <code>\"sulfateConcentration\"</code> 0 mg dm-3 Sulfate concentration in irrigation water (currently ignored by MONICA) <code>\"amount\"</code> mm Amount of irrigation water to apply when plant available water drops below the trigger threshold <code>\"set_to_%nFC\"</code> % nFC Sets soil moisture of the involved layers to the specified percentage of plant available water (nFC) <code>\"threshold\"</code> fraction nFC Fraction of net field capacity (plant available water = field capacity - permanent wilting point to) that must be reached before irrigation is triggered \u26a0\ufe0f Deprecated, use <code>trigger_if_nFC_below_%</code> instead. <code>\"trigger_if_nFC_below_%\"</code> % nFC Triggers irrigation if the percentage of net field capacity (plant available water = field capacity - permanent wilting point to) drops below this value <code>\"calc_nFC_until_depth_m\"</code> 0.3 m The soil depth used by MONICA to check whether the irrigation trigger condition is met"},{"location":"user_guide/configuration_files/config_sim_json/#example-1","title":"Example 1:","text":"<p>Apply 17 mm irrigation each time the plant available water in the first 30 cm of the soil profile drops below 50%.</p> <pre><code>\"UseAutomaticIrrigation\": false,\n\"AutoIrrigationParams\": {\n  \"amount\": [17, \"mm\"],\n  \"trigger_if_nFC_below_%\": [50, \"%\"],\n  \"calc_nFC_until_depth_m\": [0.3, \"m\"]\n}\n</code></pre>"},{"location":"user_guide/configuration_files/config_sim_json/#example-2","title":"Example 2:","text":"<p>Set soil moisture in the first 50 cm of the soil profile to field capacity = 100% nFC, if the plant available water drops below 50%. This time add 10 mg dm-3 of nitrate with the irrigation water.</p> <pre><code>\"UseAutomaticIrrigation\": false,\n\"AutoIrrigationParams\": {\n  \"irrigationParameters\": {\n    \"nitrateConcentration\": [10, \"mg dm-3\"],\n  },\n  \"trigger_if_nFC_below_%\": [50, \"%\"],\n  \"set_to_%nFC\": [100, \"%\"],\n  \"calc_nFC_until_depth_m\": [0.5, \"m\"]\n}\n</code></pre>"},{"location":"user_guide/configuration_files/config_site_json/","title":"The <code>site.json</code> configuration file","text":"<p><code>site.json</code> holds all input data and parameters that can be considered site-specific. Besides the key <code>SiteParameters</code> in the top-level JSON object, there might be a few JSON objects that set global or general soil and environment-specific parameters. These can either be included from the SQLite database (table user_parameter), from the filesystem, or defined directly in <code>site.json</code>. To facilitate easy overwriting of the standard parameters, they are included via the <code>DEFAULT</code> parameter pseudo-key.</p>"},{"location":"user_guide/configuration_files/config_site_json/#the-soil-profile","title":"The soil profile","text":"<p>The key <code>SoilProfileParameters</code> contains a JSON array of JSON objects that describe the layers of the soil profile. MONICA internally uses 20 layers, each with a 10 cm thickness. <code>SoilProfileParameters</code> must contain at least one layer with a minimal set of soil properties (<code>KA5TextureClass</code>, <code>SoilOrganicCarbon</code>/<code>SoilOrganicMatter</code>, and <code>SoilRawDensity</code>/<code>SoilBulkDensity</code>). Additionally, each layer needs a <code>Thickness</code> key describing the height of the soil layer. The specified soil profile will be internally normalized to 20 layers of 10 cm each. If the total thickness of the layers does not add up to 2 m (MONICA's used profile depth), the last layer will be extended up to 2 m. Likewise, layers extending beyond 2 m will be cut at that depth.</p> <p>Not all properties are required, but the more soil properties are specified, the more accurate the calculations will be. If only the <code>KA5TextureClass</code> is given, average values for <code>Sand</code> and <code>Clay</code> content will be used, and <code>FieldCapacity</code>, <code>PermanentWiltingPoint</code>, <code>PoreVolume</code>, and <code>Lambda</code> will be calculated based on them.</p> <p>Only one of <code>SoilRawDensity</code> and <code>SoilBulkDensity</code>, as well as one of <code>SoilOrganicCarbon</code> and <code>SoilOrganicMatter</code>, must be provided. If both values are being supplied, they should match.</p> <p>The following table shows the names of the soil properties that can be set for an individual layer.</p> Name of config file variable Unit Description Thickness m Thickness of the soil layer Sand kg kg-1 (fraction [0-1]) Soil sand content, a fraction between 0 and 1 Clay kg kg-1 (fraction [0-1]) Soil clay content, a fraction between 0 and 1 pH Soil pH value Sceleton fraction [0-1] Soil stone content, a fraction between 0 and 1 Lambda Soil water conductivity coefficient FieldCapacity m3 m-3 (fraction [0-1]) Field capacity PoreVolume m3 m-3 (fraction [0-1]) Saturation PermanentWiltingPoint m3 m-3 (fraction [0-1]) Permanent wilting point KA5TextureClass KA5 soil texture class SoilAmmonium kg NH4-N m-3 Initial soil ammonium content SoilNitrate kg NO3-N m-3 Initial soil nitrate content CN Soil C/N ratio SoilRawDensity kg m-3 Soil raw density SoilBulkDensity kg m-3 Soil bulk density SoilOrganicCarbon % [0-100] ([kg C kg-1] * 100) Soil organic carbon, a percentage between 0 and 100 SoilOrganicMatter kg OM kg-1 (fraction [0-1]) Soil organic matter SoilMoisturePercentFC % [0-100] Initial soil moisture in percent of field capacity <p>Further site-specific variables:</p> Name of config file variable Unit Description Latitude [decimal degrees] Site's latitude Slope [height m * length m-1]   [0-1] Site's slope HeightNN [m] Site's height above sea level NDeposition N deposition via atmosphere"},{"location":"user_guide/configuration_files/config_site_json/#environment-parameters-for-the-whole-simulation","title":"Environment parameters for the whole simulation","text":"<p>The following environment parameters for the entire simulation can be adjusted by referencing either the appropriate JSON file or selectively overwriting parameters read from the default file. </p>"},{"location":"user_guide/configuration_files/config_site_json/#atmospheric-co2-o3-handling-logic","title":"Atmospheric CO<sub>2</sub> (O<sub>3</sub>) handling logic","text":"<p>Currently, the following procedure is applied:</p> <ol> <li>Check if co2 or o3 field is present in the daily climate data. If so, use the supplied values.</li> <li>If the parameter <code>AtmosphericCO2s</code> (<code>AtmosphericO3s</code>) is set to a JSON object mapping of \"year\" to \"CO2 value\", use these yearly values.</li> <li>If the parameter <code>AtmosphericCO2</code> (<code>AtmosphericO3</code>) is set to 0 or a negative value, let MONICA calculate the CO<sub>2</sub> concentration depending on the year.</li> <li>If none of the above apply, use the value of <code>AtmosphericCO2</code> (<code>AtmosphericO3</code>) for the entire simulation.</li> </ol>"},{"location":"user_guide/configuration_files/config_site_json/#environment-parameter-table","title":"Environment parameter table","text":"Name of parameter Unit Default value Description Albedo 0.23 Surface reflectivity coefficient AtmosphericCO2 ppm 0.0 Atmospheric CO<sub>2</sub> concentration AtmosphericCO2s ppm unset Example value: <code>{\"1991\": 360, \"1992\": 370, \"1993\": 380}</code> AtmosphericO3, ppm 0.0 Atmospheric O<sub>3</sub> concentration AtmosphericO3s ppm unset WindSpeedHeight m 2.0 Height above ground surface at which wind speed is measured LeachingDepth m 0.0 Depth below ground surface at which water and nitrate outflow is determined MaxGroundwaterDepth m 18.0 Maximum annual groundwater depth below the ground surface MinGroundwaterDepth m 20.0 Minimum annual groundwater depth below the ground surface MinGroundwaterDepthMonth 3.0 Month in which the minimum average groundwater depth below ground surface is observed"},{"location":"user_guide/configuration_files/config_site_json/#example-sitejson-file","title":"Example site.json file","text":"<p>The following example shows a typical <code>site.json</code> configuration defining key site parameters such as latitude, slope, and soil profile properties. It also demonstrates how to include external parameter files for soil, environment, and transport processes using the <code>include-from-file</code> directive.</p> <pre><code>{\n  \"SiteParameters\": {\n    \"Latitude\": 52.80939865112305,\n    \"Slope\": 0.1,\n    \"HeightNN\": [0 , \"m\"],\n    \"NDeposition\": 30,\n    \"SoilProfileParameters\": [\n      {\n        \"Thickness\": 0.3,\n        \"SoilOrganicCarbon\": [0.8, \"%\"],\n        \"KA5TextureClass\": \"Sl2\",\n        \"SoilRawDensity\": [\"ld_eff2trd\", 2, [\"KA5TextureClass2clay\", \"Sl2\"]],\n        \"Lambda\": [\"sandAndClay2lambda\", [\"KA5TextureClass2sand\", \"Sl2\"], [\"KA5TextureClass2clay\", \"Sl2\"]]\n      },\n      {\n        \"Thickness\": 0.1,\n        \"SoilOrganicCarbon\": [0.15, \"%\"],\n        \"KA5TextureClass\": \"Sl2\",\n        \"SoilRawDensity\": [\"ld_eff2trd\", 2, [\"KA5TextureClass2clay\", \"Sl2\"]]\n      },\n      {\n        \"Thickness\": 1.6,\n        \"SoilOrganicCarbon\": [0.05, \"%\"],\n        \"KA5TextureClass\": \"Sl2\",\n        \"SoilRawDensity\": [\"ld_eff2trd\", 2, [\"KA5TextureClass2clay\", \"Sl2\"]]\n      }\n    ]\n  },\n  \"SoilTemperatureParameters\": [\"include-from-file\", \"../monica-parameters/user-parameters/hermes-soil-temperature.json\"],\n  \"EnvironmentParameters\": {\n    \"DEFAULT\": [\"include-from-file\", \"../monica-parameters/user-parameters/hermes-environment.json\"],\n    \"LeachingDepth\": 2.0,\n    \"WindSpeedHeight\": 2.5\n  },\n  \"SoilOrganicParameters\": [\"include-from-file\", \"../monica-parameters/user-parameters/hermes-soil-organic.json\"],\n  \"SoilTransportParameters\": [\"include-from-file\", \"../monica-parameters/user-parameters/hermes-soil-transport.json\"],\n  \"SoilMoistureParameters\": [\"include-from-file\", \"../monica-parameters/user-parameters/hermes-soil-moisture.json\"]\n}\n</code></pre>"}]}